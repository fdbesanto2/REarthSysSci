<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Maps in R</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/clipboard-1.7.1/clipboard.min.js"></script>
<link href="site_libs/primer-tooltips-1.4.0/build.css" rel="stylesheet" />
<link href="site_libs/klippy-0.0.0.9500/css/klippy.min.css" rel="stylesheet" />
<script src="site_libs/klippy-0.0.0.9500/js/klippy.min.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; } /* Alert */
code span.an { color: #008000; } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { color: #0000ff; } /* ControlFlow */
code span.ch { color: #008080; } /* Char */
code span.cn { } /* Constant */
code span.co { color: #008000; } /* Comment */
code span.cv { color: #008000; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #0000ff; } /* Keyword */
code span.op { } /* Operator */
code span.ot { color: #ff4000; } /* Other */
code span.pp { color: #ff4000; } /* Preprocessor */
code span.sc { color: #008080; } /* SpecialChar */
code span.ss { color: #008080; } /* SpecialString */
code span.st { color: #008080; } /* String */
code span.va { } /* Variable */
code span.vs { color: #008080; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="html-md-01.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">R for Earth-System Science</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="overview.html">Overview</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Topics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Lecture topics</li>
    <li>
      <a href="intro.html">Introduction: R, RStudio, and other infrastructure</a>
    </li>
    <li>
      <a href="usingR.html">Using R</a>
    </li>
    <li>
      <a href="ESSdata.html">Earth-system science data</a>
    </li>
    <li>
      <a href="netCDF.html">netCDF in R</a>
    </li>
    <li>
      <a href="raster_intro.html">raster and netCDF in R</a>
    </li>
    <li>
      <a href="hdf5_intro.html">HDF in R</a>
    </li>
    <li>
      <a href="geospatial.html">Geospatial analyses</a>
    </li>
    <li>
      <a href="RMaps.html">Maps in R</a>
    </li>
    <li>
      <a href="rasterVis01.html">Visualization:  raster and rasterVis</a>
    </li>
    <li class="dropdown-header">Visualization of high-dimensional data</li>
    <li class="dropdown-header">Multivariate analyses</li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tasks
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="geog495_ex01.html">Install R and RStudio</a>
    </li>
    <li>
      <a href="packages-and-data.html">Install packages and data</a>
    </li>
    <li>
      <a href="GitHub.html">Git and GitHub</a>
    </li>
    <li>
      <a href="Ex_UsingR.html">Using R exercise</a>
    </li>
    <li>
      <a href="markdown.html">Markdown and RMarkdown</a>
    </li>
    <li>
      <a href="install_netCDF.html">Install netCDF</a>
    </li>
    <li>
      <a href="install_Panoply.html">Install Panoply</a>
    </li>
    <li>
      <a href="transfer.html">File transfer</a>
    </li>
    <li>
      <a href="project.html">GitHub project repository and web page</a>
    </li>
    <li>
      <a href="ltms-and-anomalies.html">Long-term means and anomalies</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Resources
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="readings.html">Readings</a>
    </li>
    <li>
      <a href="websites.html">Old course web pages</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="about.html">About</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Maps in R</h1>

</div>

<div id="TOC">
<ul>
<li><a href="#introduction"><span class="toc-section-number">1</span> Introduction</a></li>
<li><a href="#set-up-outlines-and-polygons-for-global-robinson-projection-maps"><span class="toc-section-number">2</span> Set up outlines and polygons for global (Robinson projection) maps</a><ul>
<li><a href="#read-natural-earth-shapefiles"><span class="toc-section-number">2.1</span> Read Natural Earth shapefiles</a></li>
<li><a href="#project-the-shapefiles"><span class="toc-section-number">2.2</span> Project the shapefiles</a></li>
<li><a href="#write-out-the-projected-shapefiles"><span class="toc-section-number">2.3</span> Write out the projected shapefiles</a></li>
<li><a href="#clip-out-a-polygon-for-the-caspian"><span class="toc-section-number">2.4</span> Clip out a polygon for the Caspian</a></li>
</ul></li>
<li><a href="#set-up-tree-cover-data"><span class="toc-section-number">3</span> Set up tree-cover data</a><ul>
<li><a href="#read-the-tree-cover-data"><span class="toc-section-number">3.1</span> Read the tree-cover data</a></li>
<li><a href="#project-the-treecover-points-and-polygons"><span class="toc-section-number">3.2</span> Project the treecover points and polygons</a></li>
</ul></li>
<li><a href="#map-the-gcdv3-charcoal-records"><span class="toc-section-number">4</span> Map the GCDv3 charcoal records</a><ul>
<li><a href="#read-the-projected-shape-files"><span class="toc-section-number">4.1</span> Read the projected shape files</a></li>
<li><a href="#read-the-gcdv3-data"><span class="toc-section-number">4.2</span> Read the GCDv3 data</a></li>
<li><a href="#plot-the-maps"><span class="toc-section-number">4.3</span> Plot the maps</a></li>
</ul></li>
<li><a href="#a-second-example"><span class="toc-section-number">5</span> A second example</a><ul>
<li><a href="#read-the-natural-earth-shapefiles"><span class="toc-section-number">5.1</span> Read the Natural Earth shapefiles</a></li>
<li><a href="#project-the-shape-files"><span class="toc-section-number">5.2</span> Project the shape files</a></li>
<li><a href="#write-out-the-projected-and-trimmed-shape-files"><span class="toc-section-number">5.3</span> Write out the projected and trimmed shape files</a></li>
</ul></li>
<li><a href="#map-of-north-american-shaded-relief"><span class="toc-section-number">6</span> Map of North American shaded relief</a><ul>
<li><a href="#read-the-read-the-projected-and-trimmed-shapefiles"><span class="toc-section-number">6.1</span> Read the read the projected and trimmed shapefiles</a></li>
<li><a href="#read-a-shaded-relief-file"><span class="toc-section-number">6.2</span> Read a shaded relief file</a></li>
<li><a href="#make-the-map"><span class="toc-section-number">6.3</span> Make the map</a></li>
</ul></li>
</ul>
</div>

<script>
  addClassKlippyTo("pre.r, pre.markdown");
  addKlippy('right', 'top', 'auto', '1', 'Copy code', 'Copied!');
</script>
<div id="introduction" class="section level1">
<h1><span class="header-section-number">1</span> Introduction</h1>
<p>R has the ability through the <code>maps</code> package and the base graphics to generate maps, but such “out-of-the-box” maps, like other base graphics-generated illustrations, these may not be suitable for immediate publication. Other options exit, for example, using packages like <code>ggmaps,</code> <code>mapview,</code> or <code>mapmate.</code> However, the ability of the <code>sp</code> and <code>rgdal</code> packages to handle the diverse kinds of spatial data, including shapefiles, provides a facility for creating publishable maps. The examples here use a set of shapefiles downloaded from the <em>Natural Earth</em> web page <a href="http://www.naturalearthdata.com">[http://www.naturalearthdata.com]</a>.</p>
<p>This first example recreates Figure 1 from Marlon, J.R., et al., 2016, Reconstructions of biomass burning from sediment-charcoal records to improve data–model comparisons. <em>Biogeosciences</em> 13:3225-3244. <a href="http://www.biogeosciences.net/13/3225/2016/">[http://www.biogeosciences.net/13/3225/2016/]</a>. There are two general steps in the production of this map, the first involves 1) projecting the <em>Natural Earth</em> shapefiles into the Robinson projection (which are reusable for other applications), and the second the projection of the data and assembly into the finished map.</p>
</div>
<div id="set-up-outlines-and-polygons-for-global-robinson-projection-maps" class="section level1">
<h1><span class="header-section-number">2</span> Set up outlines and polygons for global (Robinson projection) maps</h1>
<div id="read-natural-earth-shapefiles" class="section level2">
<h2><span class="header-section-number">2.1</span> Read Natural Earth shapefiles</h2>
<p>The first step is to read a set of shapefiles downloaded from the Natural Earth web page <a href="http://www.naturalearthdata.com">[http://www.naturalearthdata.com]</a>, and project these into the Robinson projection. Two CRAN packages, <code>rnaturalearth</code> and <code>rnaturalearthdata</code> can be used to manage and download the data within R, but the <em>Natural Earth</em> web pages are worth looking at.</p>
<p>Begin by loading the appropriate packages:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(sp)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">library</span>(rgdal)</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">library</span>(rgeos)</a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw">library</span>(raster)</a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw">library</span>(rasterVis)</a>
<a class="sourceLine" id="cb1-6" title="6"><span class="kw">library</span>(classInt)</a>
<a class="sourceLine" id="cb1-7" title="7"><span class="kw">library</span>(RColorBrewer)</a></code></pre></div>
<p>Now read the shape files, including those for global coastlines, adminstrative units (borders), large lakes, and a graticule. Set the filenames:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="co"># Natural Earth shape files -- global (Robinson) projections</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="co"># get shapefiles from http://www.naturalearthdata.com</span></a>
<a class="sourceLine" id="cb2-3" title="3">shape_path &lt;-<span class="st"> &quot;/Users/bartlein/Projects/ESSD/data/RMaps/source/&quot;</span></a>
<a class="sourceLine" id="cb2-4" title="4">coast_shapefile &lt;-<span class="st"> </span><span class="kw">paste</span>(shape_path, <span class="st">&quot;ne_50m_coastline/ne_50m_coastline.shp&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb2-5" title="5">ocean_shapefile &lt;-<span class="st"> </span><span class="kw">paste</span>(shape_path, <span class="st">&quot;ne_50m_ocean/ne_50m_ocean.shp&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb2-6" title="6">admin0_shapefile &lt;-<span class="st"> </span><span class="kw">paste</span>(shape_path, <span class="st">&quot;ne_50m_admin_0_countries/ne_50m_admin_0_countries.shp&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb2-7" title="7">admin1_shapefile &lt;-<span class="st"> </span><span class="kw">paste</span>(shape_path, <span class="st">&quot;ne_50m_admin_1_states_provinces_lakes/ne_50m_admin_1_states_provinces_lakes.shp&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb2-8" title="8">lakes_shapefile &lt;-<span class="st"> </span><span class="kw">paste</span>(shape_path, <span class="st">&quot;ne_50m_lakes/ne_50m_lakes.shp&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb2-9" title="9">bb_shapefile &lt;-<span class="st"> </span><span class="kw">paste</span>(shape_path, <span class="st">&quot;ne_50m_graticules_all/ne_50m_wgs84_bounding_box.shp&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb2-10" title="10">grat30_shapefile &lt;-<span class="st"> </span><span class="kw">paste</span>(shape_path, <span class="st">&quot;ne_50m_graticules_all/ne_50m_graticules_30.shp&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a></code></pre></div>
<p>Before reading each file, determine what kind it is (e.g. lines vs. polygons), then read and plot it. Using the <code>ogrInfo()</code> and <code>readOGR</code> functions from <code>rgdal</code> eliminates the necessity of selecting the appropriate function in <code>maptools</code>. In the ‘plot()’ functions below, use the <code>col</code> argument for lines, <code>bor</code> for polygon border colors.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="co"># find out kind of shapefile (lines vs. polygons)</span></a>
<a class="sourceLine" id="cb3-2" title="2">layer &lt;-<span class="st"> </span><span class="kw">ogrListLayers</span>(coast_shapefile)</a>
<a class="sourceLine" id="cb3-3" title="3"><span class="kw">ogrInfo</span>(coast_shapefile, <span class="dt">layer=</span>layer)</a></code></pre></div>
<pre><code>## Source: &quot;/Users/bartlein/Projects/ESSD/data/RMaps/source/ne_50m_coastline/ne_50m_coastline.shp&quot;, layer: &quot;ne_50m_coastline&quot;
## Driver: ESRI Shapefile; number of rows: 1428 
## Feature type: wkbLineString with 2 dimensions
## Extent: (-180 -85.19219) - (180 83.59961)
## CRS: +proj=longlat +datum=WGS84 +no_defs  
## LDID: 87 
## Number of fields: 2 
##         name type length  typeName
## 1  scalerank   12     10 Integer64
## 2 featurecla    4     32    String</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="co"># read the shape file</span></a>
<a class="sourceLine" id="cb5-2" title="2">coast_lines &lt;-<span class="st"> </span><span class="kw">readOGR</span>(coast_shapefile, <span class="dt">layer=</span>layer)</a></code></pre></div>
<pre><code>## OGR data source with driver: ESRI Shapefile 
## Source: &quot;/Users/bartlein/Projects/ESSD/data/RMaps/source/ne_50m_coastline/ne_50m_coastline.shp&quot;, layer: &quot;ne_50m_coastline&quot;
## with 1428 features
## It has 2 fields
## Integer64 fields read as strings:  scalerank</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">summary</span>(coast_lines)  </a></code></pre></div>
<pre><code>## Object of class SpatialLinesDataFrame
## Coordinates:
##          min       max
## x -180.00000 180.00000
## y  -85.19219  83.59961
## Is projected: FALSE 
## proj4string :
## [+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0]
## Data attributes:
##  scalerank     featurecla  
##  0:1428    Coastline:1428</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">plot</span>(coast_lines, <span class="dt">col=</span><span class="st">&quot;purple&quot;</span>)</a></code></pre></div>
<p><img src="RMaps_files/figure-html/read%20coast-1.png" width="2100" /></p>
<p>Get the Proj4 string for later use&gt;</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">unproj_proj4string &lt;-<span class="st"> </span><span class="kw">proj4string</span>(coast_lines)</a>
<a class="sourceLine" id="cb10-2" title="2">unproj_proj4string</a></code></pre></div>
<pre><code>## [1] &quot;+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0&quot;</code></pre>
<p>Read the ocean polygons.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="co"># find out kind of shapefile (lines vs. polygons)</span></a>
<a class="sourceLine" id="cb12-2" title="2">layer &lt;-<span class="st"> </span><span class="kw">ogrListLayers</span>(ocean_shapefile)</a>
<a class="sourceLine" id="cb12-3" title="3"><span class="kw">ogrInfo</span>(ocean_shapefile, <span class="dt">layer=</span>layer)</a></code></pre></div>
<pre><code>## Source: &quot;/Users/bartlein/Projects/ESSD/data/RMaps/source/ne_50m_ocean/ne_50m_ocean.shp&quot;, layer: &quot;ne_50m_ocean&quot;
## Driver: ESRI Shapefile; number of rows: 1 
## Feature type: wkbPolygon with 2 dimensions
## Extent: (-180 -85.19219) - (180 90)
## CRS: +proj=longlat +datum=WGS84 +no_defs  
## LDID: 87 
## Number of fields: 2 
##         name type length  typeName
## 1  scalerank   12     10 Integer64
## 2 featurecla    4     32    String</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="co"># read the shape file</span></a>
<a class="sourceLine" id="cb14-2" title="2">ocean_poly &lt;-<span class="st"> </span><span class="kw">readOGR</span>(ocean_shapefile, <span class="dt">layer=</span>layer)</a></code></pre></div>
<pre><code>## OGR data source with driver: ESRI Shapefile 
## Source: &quot;/Users/bartlein/Projects/ESSD/data/RMaps/source/ne_50m_ocean/ne_50m_ocean.shp&quot;, layer: &quot;ne_50m_ocean&quot;
## with 1 features
## It has 2 fields
## Integer64 fields read as strings:  scalerank</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="kw">summary</span>(ocean_poly)  </a></code></pre></div>
<pre><code>## Object of class SpatialPolygonsDataFrame
## Coordinates:
##          min max
## x -180.00000 180
## y  -85.19219  90
## Is projected: FALSE 
## proj4string :
## [+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0]
## Data attributes:
##  scalerank featurecla
##  0:1       Ocean:1</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="kw">plot</span>(ocean_poly, <span class="dt">col=</span><span class="st">&quot;lightblue&quot;</span>)</a></code></pre></div>
<p><img src="RMaps_files/figure-html/read%20ocean-1.png" width="2100" /></p>
<p>Read the other shape files the same way. (Note that the summary output is suppressed here.)</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">layer &lt;-<span class="st"> </span><span class="kw">ogrListLayers</span>(admin0_shapefile)</a>
<a class="sourceLine" id="cb19-2" title="2"><span class="kw">ogrInfo</span>(admin0_shapefile, <span class="dt">layer=</span>layer)</a>
<a class="sourceLine" id="cb19-3" title="3">admin0_poly &lt;-<span class="st"> </span><span class="kw">readOGR</span>(admin0_shapefile, <span class="dt">layer=</span>layer)</a>
<a class="sourceLine" id="cb19-4" title="4"><span class="kw">summary</span>(admin0_poly)  </a>
<a class="sourceLine" id="cb19-5" title="5"></a>
<a class="sourceLine" id="cb19-6" title="6">layer &lt;-<span class="st"> </span><span class="kw">ogrListLayers</span>(admin1_shapefile)</a>
<a class="sourceLine" id="cb19-7" title="7"><span class="kw">ogrInfo</span>(admin1_shapefile, <span class="dt">layer=</span>layer)</a>
<a class="sourceLine" id="cb19-8" title="8">admin1_poly &lt;-<span class="st"> </span><span class="kw">readOGR</span>(admin1_shapefile, <span class="dt">layer=</span>layer)</a>
<a class="sourceLine" id="cb19-9" title="9"><span class="kw">summary</span>(admin1_poly)  </a>
<a class="sourceLine" id="cb19-10" title="10"></a>
<a class="sourceLine" id="cb19-11" title="11">layer &lt;-<span class="st"> </span><span class="kw">ogrListLayers</span>(lakes_shapefile)</a>
<a class="sourceLine" id="cb19-12" title="12"><span class="kw">ogrInfo</span>(lakes_shapefile, <span class="dt">layer=</span>layer)</a>
<a class="sourceLine" id="cb19-13" title="13">lakes_poly &lt;-<span class="st"> </span><span class="kw">readOGR</span>(lakes_shapefile, <span class="dt">layer=</span>layer)</a>
<a class="sourceLine" id="cb19-14" title="14"><span class="kw">summary</span>(lakes_poly)  </a>
<a class="sourceLine" id="cb19-15" title="15"></a>
<a class="sourceLine" id="cb19-16" title="16">lrglakes_poly &lt;-<span class="st"> </span>lakes_poly[<span class="kw">as.numeric</span>(lakes_poly<span class="op">$</span>scalerank) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2</span> ,]</a>
<a class="sourceLine" id="cb19-17" title="17"></a>
<a class="sourceLine" id="cb19-18" title="18">layer &lt;-<span class="st"> </span><span class="kw">ogrListLayers</span>(grat30_shapefile)</a>
<a class="sourceLine" id="cb19-19" title="19"><span class="kw">ogrInfo</span>(grat30_shapefile, <span class="dt">layer=</span>layer)</a>
<a class="sourceLine" id="cb19-20" title="20">grat30_lines &lt;-<span class="st"> </span><span class="kw">readOGR</span>(grat30_shapefile, <span class="dt">layer=</span>layer)</a>
<a class="sourceLine" id="cb19-21" title="21"><span class="kw">summary</span>(grat30_lines)  </a>
<a class="sourceLine" id="cb19-22" title="22"></a>
<a class="sourceLine" id="cb19-23" title="23">layer &lt;-<span class="st"> </span><span class="kw">ogrListLayers</span>(bb_shapefile)</a>
<a class="sourceLine" id="cb19-24" title="24"><span class="kw">ogrInfo</span>(bb_shapefile, <span class="dt">layer=</span>layer)</a>
<a class="sourceLine" id="cb19-25" title="25">bb_poly &lt;-<span class="st"> </span><span class="kw">readOGR</span>(bb_shapefile, <span class="dt">layer=</span>layer)</a>
<a class="sourceLine" id="cb19-26" title="26"><span class="kw">summary</span>(bb_poly) </a>
<a class="sourceLine" id="cb19-27" title="27">bb_lines &lt;-<span class="st"> </span><span class="kw">as</span>(bb_poly, <span class="st">&quot;SpatialLines&quot;</span>)</a></code></pre></div>
<p>Plot everything (except ocean).</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="co"># plot everything</span></a>
<a class="sourceLine" id="cb20-2" title="2"><span class="kw">plot</span>(coast_lines, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>)</a>
<a class="sourceLine" id="cb20-3" title="3"><span class="kw">plot</span>(admin0_poly, <span class="dt">bor=</span><span class="st">&quot;gray&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb20-4" title="4"><span class="kw">plot</span>(admin1_poly, <span class="dt">bor=</span><span class="st">&quot;pink&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb20-5" title="5"><span class="kw">plot</span>(lakes_poly, <span class="dt">bor=</span><span class="st">&quot;lightblue&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb20-6" title="6"><span class="kw">plot</span>(lrglakes_poly, <span class="dt">bor=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb20-7" title="7"><span class="kw">plot</span>(grat30_lines, <span class="dt">col=</span><span class="st">&quot;lightblue&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb20-8" title="8"><span class="kw">plot</span>(bb_lines, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb20-9" title="9"><span class="kw">plot</span>(coast_lines, <span class="dt">col=</span><span class="st">&quot;purple&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="RMaps_files/figure-html/plot%20input%20shapefiles-1.png" width="2100" /></p>
</div>
<div id="project-the-shapefiles" class="section level2">
<h2><span class="header-section-number">2.2</span> Project the shapefiles</h2>
<p>Next, transform (project) the individual shapefiles into the Robinson projection using <code>spTransform</code>. Set the <code>proj4</code> string for the projectdion using the <code>CRS()</code> function.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="co"># set Robinson CRS</span></a>
<a class="sourceLine" id="cb21-2" title="2">unproj_crs &lt;-<span class="st"> </span><span class="kw">CRS</span>(<span class="st">&quot;+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0&quot;</span>)</a>
<a class="sourceLine" id="cb21-3" title="3">unproj_crs</a></code></pre></div>
<pre><code>## CRS arguments:
##  +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1">robin_crs &lt;-<span class="st"> </span><span class="kw">CRS</span>(<span class="st">&quot;+proj=robin +lon_0=0w&quot;</span>)</a>
<a class="sourceLine" id="cb23-2" title="2">robin_crs</a></code></pre></div>
<pre><code>## CRS arguments: +proj=robin +lon_0=0w +ellps=WGS84</code></pre>
<p>Now do the projections.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="co"># do projections</span></a>
<a class="sourceLine" id="cb25-2" title="2">bb_poly_proj &lt;-<span class="st"> </span><span class="kw">spTransform</span>(bb_poly, robin_crs)</a>
<a class="sourceLine" id="cb25-3" title="3">coast_lines_proj &lt;-<span class="st"> </span><span class="kw">spTransform</span>(coast_lines, robin_crs)</a>
<a class="sourceLine" id="cb25-4" title="4">admin0_poly_proj &lt;-<span class="st"> </span><span class="kw">spTransform</span>(admin0_poly, robin_crs)</a>
<a class="sourceLine" id="cb25-5" title="5">admin1_poly_proj &lt;-<span class="st"> </span><span class="kw">spTransform</span>(admin1_poly, robin_crs)</a>
<a class="sourceLine" id="cb25-6" title="6">lakes_poly_proj &lt;-<span class="st"> </span><span class="kw">spTransform</span>(lakes_poly, robin_crs)</a>
<a class="sourceLine" id="cb25-7" title="7">grat30_lines_proj &lt;-<span class="st"> </span><span class="kw">spTransform</span>(grat30_lines, robin_crs)</a>
<a class="sourceLine" id="cb25-8" title="8">lrglakes_poly_proj &lt;-<span class="st"> </span><span class="kw">spTransform</span>(lrglakes_poly, robin_crs)</a></code></pre></div>
<p>Plot the projected shapefiles.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="co"># plot projected files</span></a>
<a class="sourceLine" id="cb26-2" title="2"><span class="kw">plot</span>(bb_poly_proj, <span class="dt">col=</span><span class="st">&quot;gray95&quot;</span>)</a>
<a class="sourceLine" id="cb26-3" title="3"><span class="kw">plot</span>(admin0_poly_proj, <span class="dt">col=</span><span class="st">&quot;white&quot;</span>, <span class="dt">bor=</span><span class="st">&quot;pink&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb26-4" title="4"><span class="kw">plot</span>(admin1_poly_proj, <span class="dt">col=</span><span class="st">&quot;white&quot;</span>, <span class="dt">bor=</span><span class="st">&quot;pink&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb26-5" title="5"><span class="kw">plot</span>(lakes_poly_proj, <span class="dt">bor=</span><span class="st">&quot;lightblue&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb26-6" title="6"><span class="kw">plot</span>(lrglakes_poly_proj, <span class="dt">bor=</span><span class="st">&quot;purple&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb26-7" title="7"><span class="kw">plot</span>(coast_lines_proj, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb26-8" title="8"><span class="kw">plot</span>(grat30_lines_proj, <span class="dt">col=</span><span class="st">&quot;lightblue&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb26-9" title="9"><span class="kw">plot</span>(bb_poly_proj, <span class="dt">bor=</span><span class="st">&quot;black&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="RMaps_files/figure-html/plot%20projected-1.png" width="2100" /></p>
<p>Because the map we’re creating will use the borders and lakes only as outlines (as opposed to polygons that might be filled with a specific color), those polygons can be converted to <code>SpatialLines</code> objects.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="co"># convert polygons to spatial lines</span></a>
<a class="sourceLine" id="cb27-2" title="2">admin0_lines_proj &lt;-<span class="st"> </span><span class="kw">as</span>(admin0_poly_proj, <span class="st">&quot;SpatialLines&quot;</span>)</a>
<a class="sourceLine" id="cb27-3" title="3">admin1_lines_proj &lt;-<span class="st"> </span><span class="kw">as</span>(admin1_poly_proj, <span class="st">&quot;SpatialLines&quot;</span>)</a>
<a class="sourceLine" id="cb27-4" title="4">lakes_lines_proj &lt;-<span class="st"> </span><span class="kw">as</span>(lakes_poly_proj, <span class="st">&quot;SpatialLines&quot;</span>)</a>
<a class="sourceLine" id="cb27-5" title="5">lrglakes_lines_proj &lt;-<span class="st"> </span><span class="kw">as</span>(lrglakes_poly_proj, <span class="st">&quot;SpatialLines&quot;</span>)</a>
<a class="sourceLine" id="cb27-6" title="6">bb_lines_proj &lt;-<span class="st"> </span><span class="kw">as</span>(bb_poly_proj, <span class="st">&quot;SpatialLines&quot;</span>)</a></code></pre></div>
<p>Plot the <code>SpatialLines</code> objects</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="co"># test the SpatialLines shapefiles</span></a>
<a class="sourceLine" id="cb28-2" title="2"><span class="kw">plot</span>(bb_poly_proj, <span class="dt">col=</span><span class="st">&quot;gray95&quot;</span>)</a>
<a class="sourceLine" id="cb28-3" title="3"><span class="kw">plot</span>(coast_lines_proj, <span class="dt">col=</span><span class="st">&quot;green&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb28-4" title="4"><span class="kw">plot</span>(admin0_lines_proj, <span class="dt">col=</span><span class="st">&quot;lightblue&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb28-5" title="5"><span class="kw">plot</span>(admin1_lines_proj, <span class="dt">col=</span><span class="st">&quot;lightblue&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb28-6" title="6"><span class="kw">plot</span>(lakes_lines_proj, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb28-7" title="7"><span class="kw">plot</span>(lrglakes_lines_proj, <span class="dt">col=</span><span class="st">&quot;purple&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb28-8" title="8"><span class="kw">plot</span>(grat30_lines_proj, <span class="dt">col=</span><span class="st">&quot;gray&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb28-9" title="9"><span class="kw">plot</span>(coast_lines_proj, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb28-10" title="10"><span class="kw">plot</span>(bb_lines_proj, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="RMaps_files/figure-html/plot%20spatial%20lines-1.png" width="2100" /></p>
</div>
<div id="write-out-the-projected-shapefiles" class="section level2">
<h2><span class="header-section-number">2.3</span> Write out the projected shapefiles</h2>
<p>Next, write out the projected shapefiles, first setting the output path.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="co"># write out the various shapefiles </span></a>
<a class="sourceLine" id="cb29-2" title="2">outpath &lt;-<span class="st"> &quot;/Users/bartlein/Projects/ESSD/data/RMaps/derived/glrob_50m/&quot;</span></a>
<a class="sourceLine" id="cb29-3" title="3">outshape &lt;-<span class="st"> </span>coast_lines_proj</a>
<a class="sourceLine" id="cb29-4" title="4">outfile &lt;-<span class="st"> &quot;glRob_50m_coast_lines&quot;</span></a>
<a class="sourceLine" id="cb29-5" title="5">outshapefile &lt;-<span class="st"> </span><span class="kw">paste</span>(outpath,outfile,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb29-6" title="6">spdf &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">as.numeric</span>(<span class="kw">row.names</span>(outshape)))</a>
<a class="sourceLine" id="cb29-7" title="7"><span class="kw">row.names</span>(spdf) &lt;-<span class="st"> </span><span class="kw">row.names</span>(outshape)</a>
<a class="sourceLine" id="cb29-8" title="8">outshape &lt;-<span class="st"> </span><span class="kw">SpatialLinesDataFrame</span>(outshape, spdf)</a>
<a class="sourceLine" id="cb29-9" title="9"><span class="kw">writeOGR</span>(outshape, outshapefile, outfile, <span class="dt">driver=</span><span class="st">&quot;ESRI Shapefile&quot;</span>, <span class="dt">overwrite_layer=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p>It’s always good practice to test whether the shapefile has ideed been written out correctly. Read it back in and plot it.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1">test &lt;-<span class="st"> </span><span class="kw">readOGR</span>(outshapefile)</a></code></pre></div>
<pre><code>## OGR data source with driver: ESRI Shapefile 
## Source: &quot;/Users/bartlein/Projects/ESSD/data/RMaps/derived/glRob_50m/glRob_50m_coast_lines&quot;, layer: &quot;glRob_50m_coast_lines&quot;
## with 1428 features
## It has 1 fields</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"><span class="kw">plot</span>(test, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>)</a></code></pre></div>
<p><img src="RMaps_files/figure-html/test%20shape-1.png" width="2100" /></p>
<p>Write out the other shapefiles.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1">outshape &lt;-<span class="st"> </span>bb_poly_proj</a>
<a class="sourceLine" id="cb33-2" title="2">outfile &lt;-<span class="st"> &quot;glRob_50m_bb_poly&quot;</span></a>
<a class="sourceLine" id="cb33-3" title="3">outshapefile &lt;-<span class="st"> </span><span class="kw">paste</span>(outpath,outfile,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb33-4" title="4">spdf &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">as.numeric</span>(<span class="kw">row.names</span>(outshape)))</a>
<a class="sourceLine" id="cb33-5" title="5"><span class="kw">row.names</span>(spdf) &lt;-<span class="st"> </span><span class="kw">row.names</span>(outshape)</a>
<a class="sourceLine" id="cb33-6" title="6">outshape &lt;-<span class="st"> </span><span class="kw">SpatialPolygonsDataFrame</span>(outshape, spdf)</a>
<a class="sourceLine" id="cb33-7" title="7"><span class="kw">writeOGR</span>(outshape, outshapefile, outfile, <span class="dt">driver=</span><span class="st">&quot;ESRI Shapefile&quot;</span>, <span class="dt">overwrite_layer=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb33-8" title="8"></a>
<a class="sourceLine" id="cb33-9" title="9">outshape &lt;-<span class="st"> </span>bb_lines_proj</a>
<a class="sourceLine" id="cb33-10" title="10">outfile &lt;-<span class="st"> &quot;glRob_50m_bb_lines&quot;</span></a>
<a class="sourceLine" id="cb33-11" title="11">outshapefile &lt;-<span class="st"> </span><span class="kw">paste</span>(outpath,outfile,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb33-12" title="12">spdf &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">as.numeric</span>(<span class="kw">row.names</span>(outshape)))</a>
<a class="sourceLine" id="cb33-13" title="13"><span class="kw">row.names</span>(spdf) &lt;-<span class="st"> </span><span class="kw">row.names</span>(outshape)</a>
<a class="sourceLine" id="cb33-14" title="14">outshape &lt;-<span class="st"> </span><span class="kw">SpatialLinesDataFrame</span>(outshape, spdf)</a>
<a class="sourceLine" id="cb33-15" title="15"><span class="kw">writeOGR</span>(outshape, outshapefile, outfile, <span class="dt">driver=</span><span class="st">&quot;ESRI Shapefile&quot;</span>, <span class="dt">overwrite_layer=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb33-16" title="16"></a>
<a class="sourceLine" id="cb33-17" title="17">outshape &lt;-<span class="st"> </span>admin0_poly_proj</a>
<a class="sourceLine" id="cb33-18" title="18">outfile &lt;-<span class="st"> &quot;glRob_50m_admin0_poly&quot;</span></a>
<a class="sourceLine" id="cb33-19" title="19">outshapefile &lt;-<span class="st"> </span><span class="kw">paste</span>(outpath,outfile,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb33-20" title="20">spdf &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">as.numeric</span>(<span class="kw">row.names</span>(outshape)))</a>
<a class="sourceLine" id="cb33-21" title="21"><span class="kw">row.names</span>(spdf) &lt;-<span class="st"> </span><span class="kw">row.names</span>(outshape)</a>
<a class="sourceLine" id="cb33-22" title="22">outshape &lt;-<span class="st"> </span><span class="kw">SpatialPolygonsDataFrame</span>(outshape, spdf)</a>
<a class="sourceLine" id="cb33-23" title="23"><span class="kw">writeOGR</span>(outshape, outshapefile, outfile, <span class="dt">driver=</span><span class="st">&quot;ESRI Shapefile&quot;</span>, <span class="dt">overwrite_layer=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb33-24" title="24"></a>
<a class="sourceLine" id="cb33-25" title="25">outshape &lt;-<span class="st"> </span>admin0_lines_proj</a>
<a class="sourceLine" id="cb33-26" title="26">outfile &lt;-<span class="st"> &quot;glRob_50m_admin0_lines&quot;</span></a>
<a class="sourceLine" id="cb33-27" title="27">outshapefile &lt;-<span class="st"> </span><span class="kw">paste</span>(outpath,outfile,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb33-28" title="28">spdf &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">as.numeric</span>(<span class="kw">row.names</span>(outshape)))</a>
<a class="sourceLine" id="cb33-29" title="29"><span class="kw">row.names</span>(spdf) &lt;-<span class="st"> </span><span class="kw">row.names</span>(outshape)</a>
<a class="sourceLine" id="cb33-30" title="30">outshape &lt;-<span class="st"> </span><span class="kw">SpatialLinesDataFrame</span>(outshape, spdf)</a>
<a class="sourceLine" id="cb33-31" title="31"><span class="kw">writeOGR</span>(outshape, outshapefile, outfile, <span class="dt">driver=</span><span class="st">&quot;ESRI Shapefile&quot;</span>, <span class="dt">overwrite_layer=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb33-32" title="32"></a>
<a class="sourceLine" id="cb33-33" title="33">outshape &lt;-<span class="st"> </span>admin1_poly_proj</a>
<a class="sourceLine" id="cb33-34" title="34">outfile &lt;-<span class="st"> &quot;glRob_50m_admin1_poly&quot;</span></a>
<a class="sourceLine" id="cb33-35" title="35">outshapefile &lt;-<span class="st"> </span><span class="kw">paste</span>(outpath,outfile,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb33-36" title="36">spdf &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">as.numeric</span>(<span class="kw">row.names</span>(outshape)))</a>
<a class="sourceLine" id="cb33-37" title="37"><span class="kw">row.names</span>(spdf) &lt;-<span class="st"> </span><span class="kw">row.names</span>(outshape)</a>
<a class="sourceLine" id="cb33-38" title="38">outshape &lt;-<span class="st"> </span><span class="kw">SpatialPolygonsDataFrame</span>(outshape, spdf)</a>
<a class="sourceLine" id="cb33-39" title="39"><span class="kw">writeOGR</span>(outshape, outshapefile, outfile, <span class="dt">driver=</span><span class="st">&quot;ESRI Shapefile&quot;</span>, <span class="dt">overwrite_layer=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb33-40" title="40"></a>
<a class="sourceLine" id="cb33-41" title="41">outshape &lt;-<span class="st"> </span>admin1_lines_proj</a>
<a class="sourceLine" id="cb33-42" title="42">outfile &lt;-<span class="st"> &quot;glRob_50m_admin1_lines&quot;</span></a>
<a class="sourceLine" id="cb33-43" title="43">outshapefile &lt;-<span class="st"> </span><span class="kw">paste</span>(outpath,outfile,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb33-44" title="44">spdf &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">as.numeric</span>(<span class="kw">row.names</span>(outshape)))</a>
<a class="sourceLine" id="cb33-45" title="45"><span class="kw">row.names</span>(spdf) &lt;-<span class="st"> </span><span class="kw">row.names</span>(outshape)</a>
<a class="sourceLine" id="cb33-46" title="46">outshape &lt;-<span class="st"> </span><span class="kw">SpatialLinesDataFrame</span>(outshape, spdf)</a>
<a class="sourceLine" id="cb33-47" title="47"><span class="kw">writeOGR</span>(outshape, outshapefile, outfile, <span class="dt">driver=</span><span class="st">&quot;ESRI Shapefile&quot;</span>, <span class="dt">overwrite_layer=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb33-48" title="48"></a>
<a class="sourceLine" id="cb33-49" title="49">outshape &lt;-<span class="st"> </span>lakes_poly_proj</a>
<a class="sourceLine" id="cb33-50" title="50">outfile &lt;-<span class="st"> &quot;glRob_50m_lakes_poly&quot;</span></a>
<a class="sourceLine" id="cb33-51" title="51">outshapefile &lt;-<span class="st"> </span><span class="kw">paste</span>(outpath,outfile,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb33-52" title="52">spdf &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">as.numeric</span>(<span class="kw">row.names</span>(outshape)))</a>
<a class="sourceLine" id="cb33-53" title="53"><span class="kw">row.names</span>(spdf) &lt;-<span class="st"> </span><span class="kw">row.names</span>(outshape)</a>
<a class="sourceLine" id="cb33-54" title="54">outshape &lt;-<span class="st"> </span><span class="kw">SpatialPolygonsDataFrame</span>(outshape, spdf)</a>
<a class="sourceLine" id="cb33-55" title="55"><span class="kw">writeOGR</span>(outshape, outshapefile, outfile, <span class="dt">driver=</span><span class="st">&quot;ESRI Shapefile&quot;</span>, <span class="dt">overwrite_layer=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb33-56" title="56"></a>
<a class="sourceLine" id="cb33-57" title="57">outshape &lt;-<span class="st"> </span>lakes_lines_proj</a>
<a class="sourceLine" id="cb33-58" title="58">outfile &lt;-<span class="st"> &quot;glRob_50m_lakes_lines&quot;</span></a>
<a class="sourceLine" id="cb33-59" title="59">outshapefile &lt;-<span class="st"> </span><span class="kw">paste</span>(outpath,outfile,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb33-60" title="60">spdf &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">as.numeric</span>(<span class="kw">row.names</span>(outshape)))</a>
<a class="sourceLine" id="cb33-61" title="61"><span class="kw">row.names</span>(spdf) &lt;-<span class="st"> </span><span class="kw">row.names</span>(outshape)</a>
<a class="sourceLine" id="cb33-62" title="62">outshape &lt;-<span class="st"> </span><span class="kw">SpatialLinesDataFrame</span>(outshape, spdf)</a>
<a class="sourceLine" id="cb33-63" title="63"><span class="kw">writeOGR</span>(outshape, outshapefile, outfile, <span class="dt">driver=</span><span class="st">&quot;ESRI Shapefile&quot;</span>, <span class="dt">overwrite_layer=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb33-64" title="64"></a>
<a class="sourceLine" id="cb33-65" title="65">outshape &lt;-<span class="st"> </span>lrglakes_poly_proj</a>
<a class="sourceLine" id="cb33-66" title="66">outfile &lt;-<span class="st"> &quot;glRob_50m_lrglakes_poly&quot;</span></a>
<a class="sourceLine" id="cb33-67" title="67">outshapefile &lt;-<span class="st"> </span><span class="kw">paste</span>(outpath,outfile,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb33-68" title="68">spdf &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">as.numeric</span>(<span class="kw">row.names</span>(outshape)))</a>
<a class="sourceLine" id="cb33-69" title="69"><span class="kw">row.names</span>(spdf) &lt;-<span class="st"> </span><span class="kw">row.names</span>(outshape)</a>
<a class="sourceLine" id="cb33-70" title="70">outshape &lt;-<span class="st"> </span><span class="kw">SpatialPolygonsDataFrame</span>(outshape, spdf)</a>
<a class="sourceLine" id="cb33-71" title="71"><span class="kw">writeOGR</span>(outshape, outshapefile, outfile, <span class="dt">driver=</span><span class="st">&quot;ESRI Shapefile&quot;</span>, <span class="dt">overwrite_layer=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb33-72" title="72"></a>
<a class="sourceLine" id="cb33-73" title="73">outshape &lt;-<span class="st"> </span>lrglakes_lines_proj</a>
<a class="sourceLine" id="cb33-74" title="74">outfile &lt;-<span class="st"> &quot;glRob_50m_lrglakes_lines&quot;</span></a>
<a class="sourceLine" id="cb33-75" title="75">outshapefile &lt;-<span class="st"> </span><span class="kw">paste</span>(outpath,outfile,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb33-76" title="76">spdf &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">as.numeric</span>(<span class="kw">row.names</span>(outshape)))</a>
<a class="sourceLine" id="cb33-77" title="77"><span class="kw">row.names</span>(spdf) &lt;-<span class="st"> </span><span class="kw">row.names</span>(outshape)</a>
<a class="sourceLine" id="cb33-78" title="78">outshape &lt;-<span class="st"> </span><span class="kw">SpatialLinesDataFrame</span>(outshape, spdf)</a>
<a class="sourceLine" id="cb33-79" title="79"><span class="kw">writeOGR</span>(outshape, outshapefile, outfile, <span class="dt">driver=</span><span class="st">&quot;ESRI Shapefile&quot;</span>, <span class="dt">overwrite_layer=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb33-80" title="80"></a>
<a class="sourceLine" id="cb33-81" title="81">outshape &lt;-<span class="st"> </span>grat30_lines_proj</a>
<a class="sourceLine" id="cb33-82" title="82">outfile &lt;-<span class="st"> &quot;glRob_50m_grat30_lines&quot;</span></a>
<a class="sourceLine" id="cb33-83" title="83">outshapefile &lt;-<span class="st"> </span><span class="kw">paste</span>(outpath,outfile,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb33-84" title="84">spdf &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">as.numeric</span>(<span class="kw">row.names</span>(outshape)))</a>
<a class="sourceLine" id="cb33-85" title="85"><span class="kw">row.names</span>(spdf) &lt;-<span class="st"> </span><span class="kw">row.names</span>(outshape)</a>
<a class="sourceLine" id="cb33-86" title="86">outshape &lt;-<span class="st"> </span><span class="kw">SpatialLinesDataFrame</span>(outshape, spdf)</a>
<a class="sourceLine" id="cb33-87" title="87"><span class="kw">writeOGR</span>(outshape, outshapefile, outfile, <span class="dt">driver=</span><span class="st">&quot;ESRI Shapefile&quot;</span>, <span class="dt">overwrite_layer=</span><span class="ot">TRUE</span>)</a></code></pre></div>
</div>
<div id="clip-out-a-polygon-for-the-caspian" class="section level2">
<h2><span class="header-section-number">2.4</span> Clip out a polygon for the Caspian</h2>
<p>Another setup step, and again one that creates some resuable files, is to make a polygon shape file for the Caspian Sea, which can be plotted and filled with color.</p>
<p>The first step is to creat a “bounding box” that surrouds the Caspian.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1">caspian_bb &lt;-<span class="st"> </span><span class="kw">as</span>(<span class="kw">extent</span>(<span class="dv">45</span>, <span class="dv">56</span>, <span class="dv">35</span>, <span class="dv">50</span>), <span class="st">&quot;SpatialPolygons&quot;</span>)</a>
<a class="sourceLine" id="cb34-2" title="2"><span class="kw">proj4string</span>(caspian_bb) &lt;-<span class="st"> </span>unproj_proj4string</a>
<a class="sourceLine" id="cb34-3" title="3"><span class="kw">summary</span>(caspian_bb)</a></code></pre></div>
<pre><code>## Object of class SpatialPolygons
## Coordinates:
##   min max
## x  45  56
## y  35  50
## Is projected: FALSE 
## proj4string :
## [+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0]</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1"><span class="co"># get the points that define the ouline of the Caspian</span></a>
<a class="sourceLine" id="cb36-2" title="2">caspian_poly &lt;-<span class="st"> </span><span class="kw">gIntersection</span>(ocean_poly, caspian_bb)</a>
<a class="sourceLine" id="cb36-3" title="3"><span class="kw">proj4string</span>(caspian_poly) &lt;-<span class="st"> </span>unproj_proj4string</a>
<a class="sourceLine" id="cb36-4" title="4"><span class="kw">summary</span>(caspian_poly)</a></code></pre></div>
<pre><code>## Object of class SpatialPolygons
## Coordinates:
##        min      max
## x 46.70723 54.72324
## y 36.61450 47.11016
## Is projected: FALSE 
## proj4string :
## [+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0]</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1"><span class="kw">plot</span>(coast_lines, <span class="dt">col=</span><span class="st">&quot;purple&quot;</span>)</a>
<a class="sourceLine" id="cb38-2" title="2"><span class="kw">plot</span>(caspian_poly, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="RMaps_files/figure-html/Caspian%20outline-1.png" width="2100" /></p>
<p>Project and plot the Caspian polygon:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1">caspian_poly_proj &lt;-<span class="st"> </span><span class="kw">spTransform</span>(caspian_poly, robin_crs)</a>
<a class="sourceLine" id="cb39-2" title="2"><span class="kw">plot</span>(bb_poly_proj, <span class="dt">bor=</span><span class="st">&quot;black&quot;</span>)</a>
<a class="sourceLine" id="cb39-3" title="3"><span class="kw">plot</span>(coast_lines_proj, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb39-4" title="4"><span class="kw">plot</span>(caspian_poly_proj, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="RMaps_files/figure-html/project%20polygon-1.png" width="2100" /></p>
<p>Write out the Caspian polygon.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1">outshape &lt;-<span class="st"> </span>caspian_poly_proj</a>
<a class="sourceLine" id="cb40-2" title="2">outfile &lt;-<span class="st"> &quot;glRob_50m_caspian_poly&quot;</span></a>
<a class="sourceLine" id="cb40-3" title="3">outshapefile &lt;-<span class="st"> </span><span class="kw">paste</span>(outpath,outfile,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb40-4" title="4">spdf &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">as.numeric</span>(<span class="kw">row.names</span>(outshape)))</a>
<a class="sourceLine" id="cb40-5" title="5"><span class="kw">row.names</span>(spdf) &lt;-<span class="st"> </span><span class="kw">row.names</span>(outshape)</a>
<a class="sourceLine" id="cb40-6" title="6">outshape &lt;-<span class="st"> </span><span class="kw">SpatialPolygonsDataFrame</span>(outshape, spdf)</a>
<a class="sourceLine" id="cb40-7" title="7"><span class="kw">writeOGR</span>(outshape, outshapefile, outfile, <span class="dt">driver=</span><span class="st">&quot;ESRI Shapefile&quot;</span>, <span class="dt">overwrite_layer=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## Warning in writeOGR(outshape, outshapefile, outfile, driver = &quot;ESRI Shapefile&quot;, : Field names abbreviated
## for ESRI Shapefile driver</code></pre>
<p><a href="Rmaps.html">[Back to top]</a></p>
</div>
</div>
<div id="set-up-tree-cover-data" class="section level1">
<h1><span class="header-section-number">3</span> Set up tree-cover data</h1>
<p>One version of Fig. 1 in Marlon et al. (2016) includes a gray-shade “layer” of the “UMD” tree-cover data (Defries et al., 2000, A new global 1-km dataset of percentage tree cover derived from remote sensing, <em>Global Change Biology</em> 6:247-254) <a href="http://glcf.umd.edu/data/treecover/data.shtml">[http://glcf.umd.edu/data/treecover/data.shtml]</a>, used to provide a background context for the location of the GCDv3 sites. The data were converted to a netCDF file, and this is read, and in turn coverted to spatial points and spatial polygon dataframes.</p>
<div id="read-the-tree-cover-data" class="section level2">
<h2><span class="header-section-number">3.1</span> Read the tree-cover data</h2>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1"><span class="co"># read a single-variable netCDF dataset using raster()</span></a>
<a class="sourceLine" id="cb42-2" title="2">tree_path &lt;-<span class="st"> &quot;/Users/bartlein/Projects/ESSD/data/nc_files/&quot;</span></a>
<a class="sourceLine" id="cb42-3" title="3">tree_name &lt;-<span class="st"> &quot;treecov.nc&quot;</span></a>
<a class="sourceLine" id="cb42-4" title="4">tree_file &lt;-<span class="st"> </span><span class="kw">paste</span>(tree_path, tree_name, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb42-5" title="5">tree &lt;-<span class="st"> </span><span class="kw">raster</span>(tree_file) <span class="co"># open treecov.nc</span></a>
<a class="sourceLine" id="cb42-6" title="6">tree</a></code></pre></div>
<pre><code>## class       : RasterLayer 
## dimensions  : 360, 720, 259200  (nrow, ncol, ncell)
## resolution  : 0.5, 0.5  (x, y)
## extent      : -180, 180, -90, 90  (xmin, xmax, ymin, ymax)
## coord. ref. : +proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0 
## data source : /Users/bartlein/Projects/ESSD/data/nc_files/treecov.nc 
## names       : treecov 
## zvar        : treecov</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1"><span class="co"># levelplot</span></a>
<a class="sourceLine" id="cb44-2" title="2">mapTheme &lt;-<span class="st"> </span><span class="kw">rasterTheme</span>(<span class="dt">region=</span><span class="kw">brewer.pal</span>(<span class="dv">8</span>,<span class="st">&quot;Greens&quot;</span>))</a>
<a class="sourceLine" id="cb44-3" title="3">plt &lt;-<span class="st"> </span><span class="kw">levelplot</span>(tree, <span class="dt">margin=</span>F, <span class="dt">par.settings=</span>mapTheme)</a>
<a class="sourceLine" id="cb44-4" title="4">plt <span class="op">+</span><span class="st"> </span><span class="kw">layer</span>(<span class="kw">sp.lines</span>(coast_lines, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">lwd=</span><span class="fl">0.5</span>))</a></code></pre></div>
<p><img src="RMaps_files/figure-html/plot%20treecover-1.png" width="2100" /></p>
<p>Create a SpatialPoints data frame, and plot it:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1"><span class="co"># create spatial points data frame</span></a>
<a class="sourceLine" id="cb45-2" title="2">tree_pts &lt;-<span class="st"> </span><span class="kw">as</span>(tree, <span class="st">&quot;SpatialPointsDataFrame&quot;</span>)</a>
<a class="sourceLine" id="cb45-3" title="3"><span class="kw">summary</span>(tree_pts)</a></code></pre></div>
<pre><code>## Object of class SpatialPointsDataFrame
## Coordinates:
##       min    max
## x -179.75 179.75
## y  -55.75  83.25
## Is projected: FALSE 
## proj4string :
## [+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0]
## Number of points: 60480
## Data attributes:
##     treecov     
##  Min.   :-2.00  
##  1st Qu.:-1.00  
##  Median :-1.00  
##  Mean   :20.22  
##  3rd Qu.:42.00  
##  Max.   :80.00</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1">plotclr &lt;-<span class="st"> </span><span class="kw">brewer.pal</span>(<span class="dv">9</span>,<span class="st">&quot;Greens&quot;</span>)</a>
<a class="sourceLine" id="cb47-2" title="2">cutpts &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>)</a>
<a class="sourceLine" id="cb47-3" title="3">color_class &lt;-<span class="st"> </span><span class="kw">findInterval</span>(tree_pts<span class="op">$</span>treecov, cutpts)<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb47-4" title="4"><span class="kw">plot</span>(tree_pts<span class="op">$</span>x, tree_pts<span class="op">$</span>y, <span class="dt">col=</span>plotclr[color_class], <span class="dt">pch=</span><span class="dv">16</span>, <span class="dt">cex=</span><span class="fl">0.25</span>)</a>
<a class="sourceLine" id="cb47-5" title="5"><span class="kw">plot</span>(coast_lines, <span class="dt">add=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="RMaps_files/figure-html/plot%20treecover%20spatialpoins-1.png" width="2100" /></p>
<p>Convert the points to polygons.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1"><span class="co"># spatial polygons (takes a while, especially to plot)</span></a>
<a class="sourceLine" id="cb48-2" title="2">tree_poly &lt;-<span class="st"> </span><span class="kw">as</span>(tree, <span class="st">&quot;SpatialPolygonsDataFrame&quot;</span>)</a>
<a class="sourceLine" id="cb48-3" title="3"><span class="kw">summary</span>(tree_poly)</a></code></pre></div>
<pre><code>## Object of class SpatialPolygonsDataFrame
## Coordinates:
##    min   max
## x -180 180.0
## y  -56  83.5
## Is projected: FALSE 
## proj4string :
## [+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0]
## Data attributes:
##     treecov     
##  Min.   :-2.00  
##  1st Qu.:-1.00  
##  Median :-1.00  
##  Mean   :20.22  
##  3rd Qu.:42.00  
##  Max.   :80.00</code></pre>
<p>Plot the treecover polygons.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1"><span class="co"># plot the polygons</span></a>
<a class="sourceLine" id="cb50-2" title="2"><span class="co">#pdf(file=&quot;treecov_poly.pdf&quot;)</span></a>
<a class="sourceLine" id="cb50-3" title="3">plotclr &lt;-<span class="st"> </span><span class="kw">brewer.pal</span>(<span class="dv">9</span>,<span class="st">&quot;Greens&quot;</span>)</a>
<a class="sourceLine" id="cb50-4" title="4">cutpts &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>)</a>
<a class="sourceLine" id="cb50-5" title="5">color_class &lt;-<span class="st"> </span><span class="kw">findInterval</span>(tree_poly<span class="op">$</span>treecov, cutpts)<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb50-6" title="6">clr &lt;-<span class="st"> </span>plotclr[color_class]</a>
<a class="sourceLine" id="cb50-7" title="7"><span class="kw">plot</span>(bb_lines, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>)</a>
<a class="sourceLine" id="cb50-8" title="8"><span class="kw">plot</span>(tree_poly, <span class="dt">col=</span>clr, <span class="dt">bor=</span>clr, <span class="dt">lwd=</span><span class="fl">0.1</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb50-9" title="9"><span class="kw">plot</span>(coast_lines, <span class="dt">lwd=</span><span class="fl">0.25</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="RMaps_files/figure-html/plot%20treecover%20polygons-1.png" width="2100" /></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1"><span class="co">#dev.off()</span></a></code></pre></div>
<p>Write out the shapefiles.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1"><span class="co"># write tree_ptws</span></a>
<a class="sourceLine" id="cb52-2" title="2">outpath &lt;-<span class="st"> &quot;/Users/bartlein/Projects/ESSD/data/RMaps/derived/treecov/&quot;</span></a>
<a class="sourceLine" id="cb52-3" title="3">outshape &lt;-<span class="st"> </span>tree_pts</a>
<a class="sourceLine" id="cb52-4" title="4">outfile &lt;-<span class="st"> &quot;treecov_pts&quot;</span></a>
<a class="sourceLine" id="cb52-5" title="5">outshapefile &lt;-<span class="st"> </span><span class="kw">paste</span>(outpath,outfile,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb52-6" title="6"><span class="kw">writeOGR</span>(outshape, outshapefile, outfile, <span class="dt">driver=</span><span class="st">&quot;ESRI Shapefile&quot;</span>, <span class="dt">overwrite_layer=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb52-7" title="7"><span class="co"># write &lt;- tree_poly</span></a>
<a class="sourceLine" id="cb52-8" title="8">outshape &lt;-<span class="st"> </span>tree_poly</a>
<a class="sourceLine" id="cb52-9" title="9">outfile &lt;-<span class="st"> &quot;treecov_poly&quot;</span></a>
<a class="sourceLine" id="cb52-10" title="10">outshapefile &lt;-<span class="st"> </span><span class="kw">paste</span>(outpath,outfile,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb52-11" title="11"><span class="kw">writeOGR</span>(outshape, outshapefile, outfile, <span class="dt">driver=</span><span class="st">&quot;ESRI Shapefile&quot;</span>, <span class="dt">overwrite_layer=</span><span class="ot">TRUE</span>)</a></code></pre></div>
</div>
<div id="project-the-treecover-points-and-polygons" class="section level2">
<h2><span class="header-section-number">3.2</span> Project the treecover points and polygons</h2>
<p>Project and plot the shapefiles</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1">tree_pts_proj &lt;-<span class="st"> </span><span class="kw">spTransform</span>(tree_pts, robin_crs)</a>
<a class="sourceLine" id="cb53-2" title="2"><span class="kw">summary</span>(tree_pts_proj)</a></code></pre></div>
<pre><code>## Object of class SpatialPointsDataFrame
## Coordinates:
##         min      max
## x -14606972 16782196
## y  -5913980  8319388
## Is projected: TRUE 
## proj4string : [+proj=robin +lon_0=0w +ellps=WGS84]
## Number of points: 60480
## Data attributes:
##     treecov     
##  Min.   :-2.00  
##  1st Qu.:-1.00  
##  Median :-1.00  
##  Mean   :20.22  
##  3rd Qu.:42.00  
##  Max.   :80.00</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1">plotclr &lt;-<span class="st"> </span><span class="kw">brewer.pal</span>(<span class="dv">9</span>,<span class="st">&quot;Greens&quot;</span>)</a>
<a class="sourceLine" id="cb55-2" title="2">cutpts &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>)</a>
<a class="sourceLine" id="cb55-3" title="3">color_class &lt;-<span class="st"> </span><span class="kw">findInterval</span>(tree_pts_proj<span class="op">$</span>treecov, cutpts)<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb55-4" title="4"><span class="kw">plot</span>(bb_lines_proj, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">axes=</span><span class="ot">FALSE</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb55-5" title="5"><span class="kw">points</span>(tree_pts_proj<span class="op">$</span>x, tree_pts_proj<span class="op">$</span>y, <span class="dt">col=</span>plotclr[color_class], <span class="dt">pch=</span><span class="dv">16</span>, <span class="dt">cex=</span><span class="fl">0.25</span>)</a>
<a class="sourceLine" id="cb55-6" title="6"><span class="kw">plot</span>(coast_lines_proj, <span class="dt">add=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="RMaps_files/figure-html/plot%20treecover%20projected%20spatialpoints-1.png" width="2100" /></p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1">tree_poly_proj &lt;-<span class="st"> </span><span class="kw">spTransform</span>(tree_poly, robin_crs)</a>
<a class="sourceLine" id="cb56-2" title="2"><span class="kw">summary</span>(tree_poly_proj)</a></code></pre></div>
<pre><code>## Object of class SpatialPolygonsDataFrame
## Coordinates:
##         min      max
## x -14636489 16811803
## y  -5939113  8334404
## Is projected: TRUE 
## proj4string : [+proj=robin +lon_0=0w +ellps=WGS84]
## Data attributes:
##     treecov     
##  Min.   :-2.00  
##  1st Qu.:-1.00  
##  Median :-1.00  
##  Mean   :20.22  
##  3rd Qu.:42.00  
##  Max.   :80.00</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1">plotclr &lt;-<span class="st"> </span><span class="kw">brewer.pal</span>(<span class="dv">9</span>,<span class="st">&quot;Greens&quot;</span>)</a>
<a class="sourceLine" id="cb58-2" title="2">cutpts &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>)</a>
<a class="sourceLine" id="cb58-3" title="3">color_class &lt;-<span class="st"> </span><span class="kw">findInterval</span>(tree_poly_proj<span class="op">$</span>treecov, cutpts)<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb58-4" title="4">clr &lt;-<span class="st"> </span>plotclr[color_class]</a>
<a class="sourceLine" id="cb58-5" title="5"><span class="kw">plot</span>(bb_lines_proj, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">axes=</span><span class="ot">FALSE</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb58-6" title="6"><span class="kw">plot</span>(tree_poly_proj, <span class="dt">col=</span>clr, <span class="dt">bor=</span>clr, <span class="dt">lwd=</span><span class="fl">0.1</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb58-7" title="7"><span class="kw">plot</span>(coast_lines_proj, <span class="dt">lwd=</span><span class="fl">0.25</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="RMaps_files/figure-html/plot%20treecover%20projected%20polygons-1.png" width="2100" /></p>
<p>Write out the projected shapefiles.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1"><span class="co"># write tree_pts_proj</span></a>
<a class="sourceLine" id="cb59-2" title="2">outshape &lt;-<span class="st"> </span>tree_pts_proj</a>
<a class="sourceLine" id="cb59-3" title="3">outfile &lt;-<span class="st"> &quot;treecov_pts_proj&quot;</span></a>
<a class="sourceLine" id="cb59-4" title="4">outshapefile &lt;-<span class="st"> </span><span class="kw">paste</span>(outpath,outfile,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb59-5" title="5"><span class="kw">writeOGR</span>(outshape, outshapefile, outfile, <span class="dt">driver=</span><span class="st">&quot;ESRI Shapefile&quot;</span>, <span class="dt">overwrite_layer=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb59-6" title="6"><span class="co"># write &lt;- tree_poly_proj</span></a>
<a class="sourceLine" id="cb59-7" title="7">outshape &lt;-<span class="st"> </span>tree_poly_proj</a>
<a class="sourceLine" id="cb59-8" title="8">outfile &lt;-<span class="st"> &quot;treecov_poly_proj&quot;</span></a>
<a class="sourceLine" id="cb59-9" title="9">outshapefile &lt;-<span class="st"> </span><span class="kw">paste</span>(outpath,outfile,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb59-10" title="10"><span class="kw">writeOGR</span>(outshape, outshapefile, outfile, <span class="dt">driver=</span><span class="st">&quot;ESRI Shapefile&quot;</span>, <span class="dt">overwrite_layer=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p><a href="Rmaps.html">[Back to top]</a></p>
</div>
</div>
<div id="map-the-gcdv3-charcoal-records" class="section level1">
<h1><span class="header-section-number">4</span> Map the GCDv3 charcoal records</h1>
<p>Figure 1 of Marlon et al. (2016) shows the distribution of charcoal records, and additionally shows by means of symbol color the number of samples in each record. Two versions of the figure will be produced: 1) as published, and 2) with the tree-cover data as a gray-shaded background.</p>
<div id="read-the-projected-shape-files" class="section level2">
<h2><span class="header-section-number">4.1</span> Read the projected shape files</h2>
<p>First read the projected (Robinson) shape files produced above.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1"><span class="kw">library</span>(sp)</a>
<a class="sourceLine" id="cb60-2" title="2"><span class="kw">library</span>(classInt)</a></code></pre></div>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1"><span class="co"># read the projected Robinson shapefiles</span></a>
<a class="sourceLine" id="cb61-2" title="2">shapepath &lt;-<span class="st"> &quot;/Users/bartlein/Projects/ESSD/data/RMaps/derived/glRob_50m/&quot;</span></a>
<a class="sourceLine" id="cb61-3" title="3">coast_lines_proj &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="kw">paste</span>(shapepath, <span class="st">&quot;glRob_50m_coast_lines&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb61-4" title="4">admin0_lines_proj &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="kw">paste</span>(shapepath, <span class="st">&quot;glRob_50m_admin0_lines&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb61-5" title="5">admin0_poly_proj &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="kw">paste</span>(shapepath, <span class="st">&quot;glRob_50m_admin0_poly&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb61-6" title="6">bb_lines_proj &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="kw">paste</span>(shapepath, <span class="st">&quot;glRob_50m_bb_lines&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb61-7" title="7">bb_poly_proj &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="kw">paste</span>(shapepath, <span class="st">&quot;glRob_50m_bb_poly&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb61-8" title="8">grat30_lines_proj &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="kw">paste</span>(shapepath, <span class="st">&quot;glRob_50m_grat30_lines&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb61-9" title="9">lrglakes_poly_proj &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="kw">paste</span>(shapepath, <span class="st">&quot;glRob_50m_lrglakes_poly&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb61-10" title="10">caspian_poly_proj &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="kw">paste</span>(shapepath, <span class="st">&quot;glRob_50m_caspian_poly&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a></code></pre></div>
<p>Read the projected tree-cover polygons (this can be slow–lots of polygons!)</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1"><span class="co"># tree-cover shape file</span></a>
<a class="sourceLine" id="cb62-2" title="2">treecover_path &lt;-<span class="st"> &quot;/Users/bartlein/Projects/ESSD/data/RMaps/derived/treecov/&quot;</span></a>
<a class="sourceLine" id="cb62-3" title="3">tree_poly_proj &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="kw">paste</span>(treecover_path, <span class="st">&quot;treecov_poly_proj.shp&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))  </a></code></pre></div>
<pre><code>## OGR data source with driver: ESRI Shapefile 
## Source: &quot;/Users/bartlein/Projects/ESSD/data/RMaps/derived/treecov/treecov_poly_proj.shp&quot;, layer: &quot;treecov_poly_proj&quot;
## with 60480 features
## It has 3 fields</code></pre>
<p>Set cutpoints and gray-scale color numbers for plotting the tree-cover data. These were calculated to follow a “Munsell sequence” of equally perceived class intervals.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1"><span class="co"># colors for tree cover</span></a>
<a class="sourceLine" id="cb64-2" title="2">tree_clr_upper &lt;-<span class="st"> </span><span class="kw">c</span>(   <span class="dv">1</span>,    <span class="dv">15</span>,    <span class="dv">20</span>,    <span class="dv">25</span>,    <span class="dv">30</span>,    <span class="dv">35</span>,    <span class="dv">40</span>,    <span class="dv">45</span>,    <span class="dv">50</span>,    <span class="dv">55</span>,    <span class="dv">60</span>,    <span class="dv">65</span>,    <span class="dv">70</span>,    <span class="dv">75</span>,   <span class="dv">999</span>)</a>
<a class="sourceLine" id="cb64-3" title="3">tree_clr_gray &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.000</span>, <span class="fl">0.979</span>, <span class="fl">0.954</span>, <span class="fl">0.926</span>, <span class="fl">0.894</span>, <span class="fl">0.859</span>, <span class="fl">0.820</span>, <span class="fl">0.778</span>, <span class="fl">0.733</span>, <span class="fl">0.684</span>, <span class="fl">0.632</span>, <span class="fl">0.576</span>, <span class="fl">0.517</span>, <span class="fl">0.455</span>, <span class="fl">0.389</span>)</a>
<a class="sourceLine" id="cb64-4" title="4">colnum &lt;-<span class="st"> </span><span class="kw">findInterval</span>(tree_poly_proj<span class="op">$</span>treecov, tree_clr_upper)<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb64-5" title="5">clr &lt;-<span class="st"> </span><span class="kw">gray</span>(tree_clr_gray[colnum], <span class="dt">alpha=</span><span class="ot">NULL</span>)</a></code></pre></div>
</div>
<div id="read-the-gcdv3-data" class="section level2">
<h2><span class="header-section-number">4.2</span> Read the GCDv3 data</h2>
<p>Read the GCDv3 charcoal site-location data.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1"><span class="co"># read the data</span></a>
<a class="sourceLine" id="cb65-2" title="2">csvpath &lt;-<span class="st"> &quot;/Users/bartlein/Projects/ESSD/data/csv_files/&quot;</span></a>
<a class="sourceLine" id="cb65-3" title="3">csvname &lt;-<span class="st"> &quot;GCDv3_MapData_Fig1.csv&quot;</span></a>
<a class="sourceLine" id="cb65-4" title="4">gcdv3 &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="kw">paste</span>(csvpath, csvname, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb65-5" title="5">gcdv3_pts &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">cbind</span>(gcdv3<span class="op">$</span>Long,gcdv3<span class="op">$</span>Lat,gcdv3<span class="op">$</span>samples22k))</a>
<a class="sourceLine" id="cb65-6" title="6"><span class="kw">names</span>(gcdv3_pts) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;lon&quot;</span>,<span class="st">&quot;lat&quot;</span>,<span class="st">&quot;samples22k&quot;</span>)</a>
<a class="sourceLine" id="cb65-7" title="7"><span class="kw">head</span>(gcdv3_pts)</a></code></pre></div>
<pre><code>##         lon     lat samples22k
## 1 -110.6161 44.6628        668
## 2 -110.3467 44.9183        567
## 3 -114.9867 45.7044        367
## 4 -114.2619 45.8919        387
## 5 -114.6503 46.3206        435
## 6 -113.4403 45.8406        971</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1"><span class="kw">coordinates</span>(gcdv3_pts) &lt;-<span class="st"> </span><span class="er">~</span>lon<span class="op">+</span>lat</a>
<a class="sourceLine" id="cb67-2" title="2"><span class="kw">proj4string</span>(gcdv3_pts) &lt;-<span class="st"> </span><span class="kw">CRS</span>(<span class="st">&quot;+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0&quot;</span>)</a>
<a class="sourceLine" id="cb67-3" title="3"><span class="kw">summary</span>(gcdv3_pts)</a></code></pre></div>
<pre><code>## Object of class SpatialPointsDataFrame
## Coordinates:
##            min      max
## lon -179.56000 179.5000
## lat  -54.88333  69.3833
## Is projected: FALSE 
## proj4string :
## [+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0]
## Number of points: 736
## Data attributes:
##    samples22k    
##  Min.   :   5.0  
##  1st Qu.:  29.0  
##  Median :  58.0  
##  Mean   : 162.0  
##  3rd Qu.: 118.5  
##  Max.   :8166.0</code></pre>
<p>Set symbol size and colors for the charcoal points.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1"><span class="co"># symbol size and colors</span></a>
<a class="sourceLine" id="cb69-2" title="2">nsamp_cutpts &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>,<span class="dv">10000</span>)</a>
<a class="sourceLine" id="cb69-3" title="3">nsamp_colors &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;green3&quot;</span>,<span class="st">&quot;deepskyblue2&quot;</span>,<span class="st">&quot;slateblue4&quot;</span>,<span class="st">&quot;purple&quot;</span>)</a>
<a class="sourceLine" id="cb69-4" title="4">nsamp_cex &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb69-5" title="5">nsamp_num &lt;-<span class="st"> </span><span class="kw">findInterval</span>(gcdv3_pts<span class="op">$</span>samples22k, nsamp_cutpts)<span class="op">+</span><span class="dv">1</span></a></code></pre></div>
<p>Project the charcoal point data.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1"><span class="co"># project the data</span></a>
<a class="sourceLine" id="cb70-2" title="2">robin.crs &lt;-<span class="st"> </span><span class="kw">CRS</span>(<span class="st">&quot;+proj=robin +lon_0=0w&quot;</span>)</a>
<a class="sourceLine" id="cb70-3" title="3">gcdv3_pts.proj &lt;-<span class="st"> </span><span class="kw">spTransform</span>(gcdv3_pts, robin.crs)</a></code></pre></div>
</div>
<div id="plot-the-maps" class="section level2">
<h2><span class="header-section-number">4.3</span> Plot the maps</h2>
<p>First, plot the sites with no background. The code below creates a .pdf file in the working directory.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" title="1"><span class="co"># version with no background</span></a>
<a class="sourceLine" id="cb71-2" title="2">pdffile &lt;-<span class="st"> &quot;gcdv3_nsamp.pdf&quot;</span></a>
<a class="sourceLine" id="cb71-3" title="3"><span class="kw">pdf</span>(<span class="kw">paste</span>(pdffile,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>), <span class="dt">paper=</span><span class="st">&quot;letter&quot;</span>, <span class="dt">width=</span><span class="dv">8</span>, <span class="dt">height=</span><span class="dv">8</span>)</a>
<a class="sourceLine" id="cb71-4" title="4"></a>
<a class="sourceLine" id="cb71-5" title="5">  <span class="kw">plot</span>(bb_poly_proj, <span class="dt">col=</span><span class="st">&quot;gray90&quot;</span>, <span class="dt">bor=</span><span class="st">&quot;black&quot;</span>, <span class="dt">lwd=</span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb71-6" title="6">  <span class="kw">plot</span>(grat30_lines_proj, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">lwd=</span><span class="fl">0.3</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb71-7" title="7">  <span class="kw">plot</span>(admin0_poly_proj, <span class="dt">col=</span><span class="st">&quot;white&quot;</span>, <span class="dt">bor=</span><span class="st">&quot;gray50&quot;</span>, <span class="dt">lwd=</span><span class="fl">0.4</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb71-8" title="8">  <span class="kw">plot</span>(lrglakes_poly_proj, <span class="dt">col=</span><span class="st">&quot;gray90&quot;</span>, <span class="dt">bor=</span><span class="st">&quot;black&quot;</span>, <span class="dt">lwd=</span><span class="fl">0.2</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb71-9" title="9">  <span class="kw">plot</span>(caspian_poly_proj, <span class="dt">col=</span><span class="st">&quot;gray90&quot;</span>, <span class="dt">bor=</span><span class="st">&quot;black&quot;</span>, <span class="dt">lwd=</span><span class="fl">0.2</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb71-10" title="10">  <span class="kw">plot</span>(coast_lines_proj, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">lwd=</span><span class="fl">0.5</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb71-11" title="11">  <span class="kw">plot</span>(bb_lines_proj, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">lwd=</span><span class="fl">1.0</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb71-12" title="12">  </a>
<a class="sourceLine" id="cb71-13" title="13">  <span class="kw">plot</span>(gcdv3_pts.proj, <span class="dt">pch=</span><span class="dv">2</span>, <span class="dt">col=</span>nsamp_colors[nsamp_num], <span class="dt">cex=</span>nsamp_cex[nsamp_num], <span class="dt">lwd=</span><span class="fl">0.6</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb71-14" title="14">  </a>
<a class="sourceLine" id="cb71-15" title="15">  <span class="kw">text</span>(<span class="op">-</span><span class="dv">17000000</span>, <span class="dv">9100000</span>, <span class="dt">pos=</span><span class="dv">4</span>, <span class="dt">cex=</span><span class="fl">0.8</span>, <span class="st">&quot;GCDv3 -- Number of Samples (Since 22 ka)&quot;</span>)</a>
<a class="sourceLine" id="cb71-16" title="16">  <span class="kw">legend</span>(<span class="op">-</span><span class="dv">17000000</span>, <span class="dv">-5000000</span>, <span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;&lt; 10&quot;</span>,<span class="st">&quot;10 - 100&quot;</span>,<span class="st">&quot;100 - 1000&quot;</span>,<span class="st">&quot;&gt; 1000&quot;</span>), <span class="dt">bg=</span><span class="st">&quot;white&quot;</span>,</a>
<a class="sourceLine" id="cb71-17" title="17">    <span class="dt">title=</span><span class="st">&quot;Number of Samples&quot;</span>, <span class="dt">pch=</span><span class="dv">2</span>, <span class="dt">pt.lwd=</span><span class="fl">0.6</span>, <span class="dt">col=</span>nsamp_colors, <span class="dt">cex=</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb71-18" title="18"></a>
<a class="sourceLine" id="cb71-19" title="19"><span class="kw">dev.off</span>()</a></code></pre></div>
<p>The resulting plot will look like this:<br />
<img src="images/gcdv3_nsamp.png" /></p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1"><span class="co"># version with treecover background</span></a>
<a class="sourceLine" id="cb72-2" title="2">pdffile &lt;-<span class="st"> &quot;gcdv3_nsamp_treecov.pdf&quot;</span></a>
<a class="sourceLine" id="cb72-3" title="3"><span class="kw">pdf</span>(pdffile, <span class="dt">paper=</span><span class="st">&quot;letter&quot;</span>, <span class="dt">width=</span><span class="dv">8</span>, <span class="dt">height=</span><span class="dv">8</span>)</a>
<a class="sourceLine" id="cb72-4" title="4"></a>
<a class="sourceLine" id="cb72-5" title="5">  <span class="kw">plot</span>(bb_poly_proj, <span class="dt">col=</span><span class="st">&quot;aliceblue&quot;</span>, <span class="dt">bor=</span><span class="st">&quot;black&quot;</span>, <span class="dt">lwd=</span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb72-6" title="6">  <span class="kw">plot</span>(grat30_lines_proj, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">lwd=</span><span class="fl">0.2</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb72-7" title="7">  <span class="kw">plot</span>(tree_poly_proj, <span class="dt">col=</span>clr, <span class="dt">bor=</span>clr, <span class="dt">lwd=</span><span class="fl">0.01</span>, <span class="dt">ljoin=</span><span class="st">&quot;bevel&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb72-8" title="8">  <span class="kw">plot</span>(admin0_lines_proj, <span class="dt">col=</span><span class="st">&quot;gray50&quot;</span>, <span class="dt">lwd=</span><span class="fl">0.2</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb72-9" title="9">  <span class="kw">plot</span>(lrglakes_poly_proj, <span class="dt">col=</span><span class="st">&quot;aliceblue&quot;</span>, <span class="dt">bor=</span><span class="st">&quot;black&quot;</span>, <span class="dt">lwd=</span><span class="fl">0.2</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb72-10" title="10">  <span class="kw">plot</span>(caspian_poly_proj, <span class="dt">col=</span><span class="st">&quot;aliceblue&quot;</span>, <span class="dt">bor=</span><span class="st">&quot;black&quot;</span>, <span class="dt">lwd=</span><span class="fl">0.2</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb72-11" title="11">  <span class="kw">plot</span>(coast_lines_proj, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">lwd=</span><span class="fl">0.2</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb72-12" title="12">  <span class="kw">plot</span>(bb_lines_proj, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">lwd=</span><span class="fl">1.0</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb72-13" title="13">  </a>
<a class="sourceLine" id="cb72-14" title="14">  <span class="co"># print the symbols in white to knockout underlying tree cover</span></a>
<a class="sourceLine" id="cb72-15" title="15">  <span class="kw">plot</span>(gcdv3_pts.proj, <span class="dt">pch=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="st">&quot;white&quot;</span>, <span class="dt">cex=</span>nsamp_cex[nsamp_num], <span class="dt">lwd=</span><span class="fl">1.5</span>, <span class="dt">add=</span><span class="ot">TRUE</span>) </a>
<a class="sourceLine" id="cb72-16" title="16">  <span class="kw">plot</span>(gcdv3_pts.proj, <span class="dt">pch=</span><span class="dv">2</span>, <span class="dt">col=</span>nsamp_colors[nsamp_num], <span class="dt">cex=</span>nsamp_cex[nsamp_num], <span class="dt">lwd=</span><span class="fl">0.6</span>, <span class="dt">add=</span><span class="ot">TRUE</span>) </a>
<a class="sourceLine" id="cb72-17" title="17"></a>
<a class="sourceLine" id="cb72-18" title="18">  <span class="kw">text</span>(<span class="op">-</span><span class="dv">17000000</span>, <span class="dv">9100000</span>, <span class="dt">pos=</span><span class="dv">4</span>, <span class="dt">cex=</span><span class="fl">0.8</span>, <span class="st">&quot;GCDv3 -- Number of Samples (Since 22 ka)&quot;</span>)</a>
<a class="sourceLine" id="cb72-19" title="19">  <span class="kw">legend</span>(<span class="op">-</span><span class="dv">17000000</span>, <span class="dv">-5000000</span>, <span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;&lt; 10&quot;</span>,<span class="st">&quot;10 - 100&quot;</span>,<span class="st">&quot;100 - 1000&quot;</span>,<span class="st">&quot;&gt; 1000&quot;</span>), <span class="dt">bg=</span><span class="st">&quot;white&quot;</span>,</a>
<a class="sourceLine" id="cb72-20" title="20">    <span class="dt">title=</span><span class="st">&quot;Number of Samples&quot;</span>, <span class="dt">pch=</span><span class="dv">2</span>, <span class="dt">pt.lwd=</span><span class="fl">0.6</span>, <span class="dt">col=</span>nsamp_colors, <span class="dt">cex=</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb72-21" title="21"><span class="kw">dev.off</span>()</a></code></pre></div>
<p>The resulting plot will look like this: <img src="images/gcdv3_nsamp_treecov.png" /></p>
<p><a href="Rmaps.html">[Back to top]</a></p>
</div>
</div>
<div id="a-second-example" class="section level1">
<h1><span class="header-section-number">5</span> A second example</h1>
<p>This second example illustrates the creating of a base map for North America that conforms to the projection used for the <code>na10km_v2</code> data. As before, <em>Natural Earth</em> shapefiles are read and projected, this time using a Lambert Azimuthal Equal-Area projection, and trimmed to the appropriate region.</p>
<div id="read-the-natural-earth-shapefiles" class="section level2">
<h2><span class="header-section-number">5.1</span> Read the Natural Earth shapefiles</h2>
<p>Load the appropriate packages.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" title="1"><span class="kw">library</span>(maptools)</a>
<a class="sourceLine" id="cb73-2" title="2"><span class="kw">library</span>(sp)</a>
<a class="sourceLine" id="cb73-3" title="3"><span class="kw">library</span>(rgdal)</a>
<a class="sourceLine" id="cb73-4" title="4"><span class="kw">library</span>(raster)</a>
<a class="sourceLine" id="cb73-5" title="5"><span class="kw">library</span>(rgeos)</a>
<a class="sourceLine" id="cb73-6" title="6"><span class="kw">library</span>(lattice)</a></code></pre></div>
<p>Set the shapefile names, including those for global coastlines, adminstrative units (borders). Set the filenames:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1"><span class="co"># Natural Earth shape files -- global (Robinson) projections</span></a>
<a class="sourceLine" id="cb74-2" title="2"><span class="co"># get shapefiles from http://www.naturalearthdata.com</span></a>
<a class="sourceLine" id="cb74-3" title="3">shape_path &lt;-<span class="st"> &quot;/Users/bartlein/Projects/ESSD/data/RMaps/source/&quot;</span></a>
<a class="sourceLine" id="cb74-4" title="4">coast_shapefile &lt;-<span class="st"> </span><span class="kw">paste</span>(shape_path, <span class="st">&quot;ne_10m_coastline/ne_10m_coastline.shp&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb74-5" title="5">admin0_shapefile &lt;-<span class="st"> </span><span class="kw">paste</span>(shape_path, <span class="st">&quot;ne_10m_admin_0_countries/ne_10m_admin_0_countries.shp&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb74-6" title="6">admin1_shapefile &lt;-<span class="st"> </span><span class="kw">paste</span>(shape_path, <span class="st">&quot;ne_10m_admin_1_states_provinces_lakes/ne_10m_admin_1_states_provinces_lakes.shp&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb74-7" title="7">lakes_shapefile &lt;-<span class="st"> </span><span class="kw">paste</span>(shape_path, <span class="st">&quot;ne_10m_lakes/ne_10m_lakes.shp&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a></code></pre></div>
<p>Read and plot the shapefiles (note: summary output is suppressed)</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" title="1">layer &lt;-<span class="st"> </span><span class="kw">ogrListLayers</span>(coast_shapefile)</a>
<a class="sourceLine" id="cb75-2" title="2"><span class="kw">ogrInfo</span>(coast_shapefile, <span class="dt">layer=</span>layer)</a>
<a class="sourceLine" id="cb75-3" title="3">coast_lines &lt;-<span class="st"> </span><span class="kw">readOGR</span>(coast_shapefile, <span class="dt">layer=</span>layer)</a>
<a class="sourceLine" id="cb75-4" title="4"><span class="kw">summary</span>(coast_lines)  </a>
<a class="sourceLine" id="cb75-5" title="5"><span class="kw">plot</span>(coast_lines)</a>
<a class="sourceLine" id="cb75-6" title="6"></a>
<a class="sourceLine" id="cb75-7" title="7">layer &lt;-<span class="st"> </span><span class="kw">ogrListLayers</span>(admin0_shapefile)</a>
<a class="sourceLine" id="cb75-8" title="8"><span class="kw">ogrInfo</span>(admin0_shapefile, <span class="dt">layer=</span>layer)</a>
<a class="sourceLine" id="cb75-9" title="9">admin0_poly &lt;-<span class="st"> </span><span class="kw">readOGR</span>(admin0_shapefile, <span class="dt">layer=</span>layer)</a>
<a class="sourceLine" id="cb75-10" title="10"><span class="kw">summary</span>(admin0_poly)  </a>
<a class="sourceLine" id="cb75-11" title="11"><span class="kw">plot</span>(admin0_poly, <span class="dt">bor=</span><span class="st">&quot;gray&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb75-12" title="12"></a>
<a class="sourceLine" id="cb75-13" title="13">layer &lt;-<span class="st"> </span><span class="kw">ogrListLayers</span>(admin1_shapefile)</a>
<a class="sourceLine" id="cb75-14" title="14"><span class="kw">ogrInfo</span>(admin1_shapefile, <span class="dt">layer=</span>layer)</a>
<a class="sourceLine" id="cb75-15" title="15">admin1_poly &lt;-<span class="st"> </span><span class="kw">readOGR</span>(admin1_shapefile, <span class="dt">layer=</span>layer)</a>
<a class="sourceLine" id="cb75-16" title="16"><span class="kw">summary</span>(admin1_poly)  </a>
<a class="sourceLine" id="cb75-17" title="17"><span class="kw">plot</span>(admin1_poly, <span class="dt">bor=</span><span class="st">&quot;lightgreen&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb75-18" title="18"></a>
<a class="sourceLine" id="cb75-19" title="19">layer &lt;-<span class="st"> </span><span class="kw">ogrListLayers</span>(lakes_shapefile)</a>
<a class="sourceLine" id="cb75-20" title="20"><span class="kw">ogrInfo</span>(lakes_shapefile, <span class="dt">layer=</span>layer)</a>
<a class="sourceLine" id="cb75-21" title="21">lakes_poly &lt;-<span class="st"> </span><span class="kw">readOGR</span>(lakes_shapefile, <span class="dt">layer=</span>layer)</a>
<a class="sourceLine" id="cb75-22" title="22"><span class="kw">summary</span>(lakes_poly)  </a>
<a class="sourceLine" id="cb75-23" title="23"><span class="kw">plot</span>(lakes_poly, <span class="dt">bor=</span><span class="st">&quot;lightblue&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb75-24" title="24"></a>
<a class="sourceLine" id="cb75-25" title="25">lrglakes_poly &lt;-<span class="st"> </span>lakes_poly[<span class="kw">as.numeric</span>(lakes_poly<span class="op">$</span>scalerank) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2</span> ,]</a>
<a class="sourceLine" id="cb75-26" title="26"><span class="kw">plot</span>(lrglakes_poly, <span class="dt">bor=</span><span class="st">&quot;purple&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="RMaps_files/figure-html/read%20shapefiles-1.png" width="2100" /> Take a look at the <code>admin1_poly</code> dataframe, to figure out the codes for Candadian and U.S. provincial and state borders.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1"><span class="kw">head</span>(admin0_poly)</a></code></pre></div>
<pre><code>##   scalerank      featurecla LABELRANK     SOVEREIGNT SOV_A3 ADM0_DIF LEVEL              TYPE       ADMIN
## 0         3 Admin-0 country         5    Netherlands    NL1        1     2           Country       Aruba
## 1         0 Admin-0 country         3    Afghanistan    AFG        0     2 Sovereign country Afghanistan
## 2         0 Admin-0 country         3         Angola    AGO        0     2 Sovereign country      Angola
## 3         3 Admin-0 country         6 United Kingdom    GB1        1     2        Dependency    Anguilla
## 4         0 Admin-0 country         6        Albania    ALB        0     2 Sovereign country     Albania
## 5         3 Admin-0 country         6        Finland    FI1        1     2           Country       Aland
##   ADM0_A3 GEOU_DIF     GEOUNIT GU_A3 SU_DIF     SUBUNIT SU_A3 BRK_DIFF        NAME     NAME_LONG BRK_A3
## 0     ABW        0       Aruba   ABW      0       Aruba   ABW        0       Aruba         Aruba    ABW
## 1     AFG        0 Afghanistan   AFG      0 Afghanistan   AFG        0 Afghanistan   Afghanistan    AFG
## 2     AGO        0      Angola   AGO      0      Angola   AGO        0      Angola        Angola    AGO
## 3     AIA        0    Anguilla   AIA      0    Anguilla   AIA        0    Anguilla      Anguilla    AIA
## 4     ALB        0     Albania   ALB      0     Albania   ALB        0     Albania       Albania    ALB
## 5     ALD        0       Aland   ALD      0       Aland   ALD        0       Aland Aland Islands    ALD
##      BRK_NAME BRK_GROUP ABBREV POSTAL                    FORMAL_EN FORMAL_FR NOTE_ADM0 NOTE_BRK
## 0       Aruba      &lt;NA&gt;  Aruba     AW                        Aruba      &lt;NA&gt;     Neth.     &lt;NA&gt;
## 1 Afghanistan      &lt;NA&gt;   Afg.     AF Islamic State of Afghanistan      &lt;NA&gt;      &lt;NA&gt;     &lt;NA&gt;
## 2      Angola      &lt;NA&gt;   Ang.     AO  People&#39;s Republic of Angola      &lt;NA&gt;      &lt;NA&gt;     &lt;NA&gt;
## 3    Anguilla      &lt;NA&gt;   Ang.     AI                         &lt;NA&gt;      &lt;NA&gt;      U.K.     &lt;NA&gt;
## 4     Albania      &lt;NA&gt;   Alb.     AL          Republic of Albania      &lt;NA&gt;      &lt;NA&gt;     &lt;NA&gt;
## 5       Aland      &lt;NA&gt;  Aland     AI                Åland Islands      &lt;NA&gt;      Fin.     &lt;NA&gt;
##     NAME_SORT NAME_ALT MAPCOLOR7 MAPCOLOR8 MAPCOLOR9 MAPCOLOR13  POP_EST GDP_MD_EST POP_YEAR LASTCENSUS
## 0       Aruba     &lt;NA&gt;         4         2         2          9   103065     2258.0      -99       2010
## 1 Afghanistan     &lt;NA&gt;         5         6         8          7 28400000    22270.0      -99       1979
## 2      Angola     &lt;NA&gt;         3         2         6          1 12799293   110300.0      -99       1970
## 3    Anguilla     &lt;NA&gt;         6         6         6          3    14436      108.9      -99        -99
## 4     Albania     &lt;NA&gt;         1         4         1          6  3639453    21810.0      -99       2001
## 5       Aland     &lt;NA&gt;         4         1         4          6    27153     1563.0      -99        -99
##   GDP_YEAR                    ECONOMY              INCOME_GRP WIKIPEDIA FIPS_10_ ISO_A2 ISO_A3 ISO_N3
## 0      -99       6. Developing region 2. High income: nonOECD       -99       AA     AW    ABW    533
## 1      -99  7. Least developed region           5. Low income       -99       AF     AF    AFG    004
## 2      -99  7. Least developed region  3. Upper middle income       -99       AO     AO    AGO    024
## 3      -99       6. Developing region  3. Upper middle income       -99       AV     AI    AIA    660
## 4      -99       6. Developing region  4. Lower middle income       -99       AL     AL    ALB    008
## 5      -99 2. Developed region: nonG7    1. High income: OECD       -99      -99     AX    ALA    248
##   UN_A3 WB_A2 WB_A3   WOE_ID WOE_ID_EH                   WOE_NOTE ADM0_A3_IS ADM0_A3_US ADM0_A3_UN
## 0   533    AW   ABW 23424736  23424736 Exact WOE match as country        ABW        ABW        -99
## 1   004    AF   AFG 23424739  23424739 Exact WOE match as country        AFG        AFG        -99
## 2   024    AO   AGO 23424745  23424745 Exact WOE match as country        AGO        AGO        -99
## 3   660   -99   -99 23424751  23424751 Exact WOE match as country        AIA        AIA        -99
## 4   008    AL   ALB 23424742  23424742 Exact WOE match as country        ALB        ALB        -99
## 5   248   -99   -99 12577865  12577865 Exact WOE match as country        ALA        ALD        -99
##   ADM0_A3_WB     CONTINENT REGION_UN       SUBREGION                 REGION_WB NAME_LEN LONG_LEN
## 0        -99 North America  Americas       Caribbean Latin America &amp; Caribbean        5        5
## 1        -99          Asia      Asia   Southern Asia                South Asia       11       11
## 2        -99        Africa    Africa   Middle Africa        Sub-Saharan Africa        6        6
## 3        -99 North America  Americas       Caribbean Latin America &amp; Caribbean        8        8
## 4        -99        Europe    Europe Southern Europe     Europe &amp; Central Asia        7        7
## 5        -99        Europe    Europe Northern Europe     Europe &amp; Central Asia        5       13
##   ABBREV_LEN TINY HOMEPART
## 0          5    4      -99
## 1          4  -99        1
## 2          4  -99        1
## 3          4  -99      -99
## 4          4  -99        1
## 5          5    5      -99</code></pre>
<p>The approprate code to extract the U.S. and Canada data is <code>admin1_poly$sr_sov_a3 == "CAN"</code> and <code>admin1_poly$sr_sov_a3 == "US1"</code>. Extract the borders, and plot the resulting shapefiles.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1">can_poly &lt;-<span class="st"> </span>admin1_poly[admin1_poly<span class="op">$</span>sov_a3 <span class="op">==</span><span class="st"> &quot;CAN&quot;</span> ,]</a>
<a class="sourceLine" id="cb78-2" title="2">us_poly &lt;-<span class="st"> </span>admin1_poly[admin1_poly<span class="op">$</span>sov_a3 <span class="op">==</span><span class="st"> &quot;US1&quot;</span>,]</a>
<a class="sourceLine" id="cb78-3" title="3"><span class="kw">plot</span>(coast_lines)</a>
<a class="sourceLine" id="cb78-4" title="4"><span class="kw">plot</span>(can_poly, <span class="dt">bor=</span><span class="st">&quot;red&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb78-5" title="5"><span class="kw">plot</span>(us_poly, <span class="dt">bor=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="RMaps_files/figure-html/extract%20US%20and%20Candada-1.png" width="2100" /></p>
<p>Convert the U.S. and Canada polygons to <code>SpatialLines</code>:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" title="1">can_lines &lt;-<span class="st"> </span><span class="kw">as</span>(can_poly, <span class="st">&quot;SpatialLines&quot;</span>)</a>
<a class="sourceLine" id="cb79-2" title="2">us_lines &lt;-<span class="st"> </span><span class="kw">as</span>(us_poly, <span class="st">&quot;SpatialLines&quot;</span>)</a></code></pre></div>
</div>
<div id="project-the-shape-files" class="section level2">
<h2><span class="header-section-number">5.2</span> Project the shape files</h2>
<p>Set the <code>proj4string</code> value and the coordinate reference system for the na10km_v2 grid:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1">na_proj4string &lt;-<span class="st"> &quot;+proj=laea +lon_0=-100 +lat_0=50 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs&quot;</span></a>
<a class="sourceLine" id="cb80-2" title="2">na_crs =<span class="st"> </span><span class="kw">CRS</span>(na_proj4string)</a></code></pre></div>
<p>Project the various shapefiles (and plot the coastlines as an example):</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1">coast_lines_proj &lt;-<span class="kw">spTransform</span>(coast_lines, na_crs)</a>
<a class="sourceLine" id="cb81-2" title="2">admin0_poly_proj &lt;-<span class="kw">spTransform</span>(admin0_poly, na_crs)</a>
<a class="sourceLine" id="cb81-3" title="3">admin1_poly_proj &lt;-<span class="kw">spTransform</span>(admin1_poly, na_crs)</a>
<a class="sourceLine" id="cb81-4" title="4">lakes_poly_proj &lt;-<span class="kw">spTransform</span>(lakes_poly, na_crs)</a>
<a class="sourceLine" id="cb81-5" title="5">lrglakes_poly_proj &lt;-<span class="kw">spTransform</span>(lrglakes_poly, na_crs)</a>
<a class="sourceLine" id="cb81-6" title="6">can_poly_proj &lt;-<span class="kw">spTransform</span>(can_poly, na_crs)</a>
<a class="sourceLine" id="cb81-7" title="7">us_poly_proj &lt;-<span class="kw">spTransform</span>(us_poly, na_crs)</a>
<a class="sourceLine" id="cb81-8" title="8">can_lines_proj &lt;-<span class="kw">spTransform</span>(can_lines, na_crs)</a>
<a class="sourceLine" id="cb81-9" title="9">us_lines_proj &lt;-<span class="kw">spTransform</span>(us_lines, na_crs)</a>
<a class="sourceLine" id="cb81-10" title="10"></a>
<a class="sourceLine" id="cb81-11" title="11"><span class="kw">plot</span>(coast_lines_proj)</a>
<a class="sourceLine" id="cb81-12" title="12"><span class="kw">plot</span>(admin0_poly_proj, <span class="dt">bor=</span><span class="st">&quot;gray&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb81-13" title="13"><span class="kw">plot</span>(coast_lines_proj, <span class="dt">add=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="RMaps_files/figure-html/project%20shapefiles-1.png" width="2100" /></p>
<p>Define a bounding box for trimming the polygon and line shape files to the area covered by the na10km_v2 grid. The extent of the area is known from the definition of the grid, but could also be determined by reading an na10km_v2 netCDF file. The projected <code>admin</code> shape files are quite complicated, and create “topology exception errors”. These can be fixed using an approach discussed on StackExchange <a href="http://gis.stackexchange.com/questions/163445/r-solution-for-topologyexception-input-geom-1-is-invalid-self-intersection-er">[link]</a></p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1">na10km_bb &lt;-<span class="st"> </span><span class="kw">as</span>(<span class="kw">extent</span>(<span class="op">-</span><span class="dv">5770000</span>,<span class="dv">5000000</span>,<span class="op">-</span><span class="dv">4510000</span>,<span class="dv">4480000</span>), <span class="st">&quot;SpatialPolygons&quot;</span>)</a>
<a class="sourceLine" id="cb82-2" title="2"><span class="kw">proj4string</span>(na10km_bb) &lt;-<span class="st"> </span>na_proj4string</a>
<a class="sourceLine" id="cb82-3" title="3"></a>
<a class="sourceLine" id="cb82-4" title="4">na10km_coast_lines_proj &lt;-<span class="st"> </span><span class="kw">gIntersection</span>(coast_lines_proj, na10km_bb)</a>
<a class="sourceLine" id="cb82-5" title="5">na10km_lakes_poly_proj &lt;-<span class="st"> </span><span class="kw">gIntersection</span>(lakes_poly_proj, na10km_bb)</a>
<a class="sourceLine" id="cb82-6" title="6">na10km_lrglakes_poly_proj &lt;-<span class="st"> </span><span class="kw">gIntersection</span>(lrglakes_poly_proj, na10km_bb)</a>
<a class="sourceLine" id="cb82-7" title="7">na10km_can_poly_proj &lt;-<span class="st"> </span><span class="kw">gIntersection</span>(can_poly_proj, na10km_bb)</a>
<a class="sourceLine" id="cb82-8" title="8">na10km_us_poly_proj &lt;-<span class="st"> </span><span class="kw">gIntersection</span>(us_poly_proj, na10km_bb)</a>
<a class="sourceLine" id="cb82-9" title="9">na10km_can_lines_proj &lt;-<span class="st"> </span><span class="kw">gIntersection</span>(can_lines_proj, na10km_bb)</a>
<a class="sourceLine" id="cb82-10" title="10">na10km_us_lines_proj &lt;-<span class="st"> </span><span class="kw">gIntersection</span>(us_lines_proj, na10km_bb)</a></code></pre></div>
<p>Now do the <code>admin</code> shape files:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" title="1">na10km_bb &lt;-<span class="st"> </span><span class="kw">gBuffer</span>(na10km_bb, <span class="dt">byid=</span><span class="ot">TRUE</span>, <span class="dt">width=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb83-2" title="2">admin0_poly_proj &lt;-<span class="st"> </span><span class="kw">gSimplify</span>(admin0_poly_proj, <span class="dt">tol =</span> <span class="fl">0.00001</span>)</a>
<a class="sourceLine" id="cb83-3" title="3">na10km_admin0_poly_proj &lt;-<span class="st"> </span><span class="kw">gBuffer</span>(admin0_poly_proj, <span class="dt">byid=</span><span class="ot">TRUE</span>, <span class="dt">width=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb83-4" title="4">na10km_admin0_poly_proj &lt;-<span class="st"> </span><span class="kw">gIntersection</span>(admin0_poly_proj, <span class="dt">byid=</span><span class="ot">TRUE</span>, na10km_bb)</a>
<a class="sourceLine" id="cb83-5" title="5">admin1_poly_proj &lt;-<span class="st"> </span><span class="kw">gSimplify</span>(admin1_poly_proj, <span class="dt">tol =</span> <span class="fl">0.00001</span>)</a>
<a class="sourceLine" id="cb83-6" title="6">na10km_admin1_poly_proj &lt;-<span class="st"> </span><span class="kw">gBuffer</span>(admin1_poly_proj, <span class="dt">byid=</span><span class="ot">TRUE</span>, <span class="dt">width=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb83-7" title="7">na10km_admin1_poly_proj &lt;-<span class="st"> </span><span class="kw">gIntersection</span>(admin1_poly_proj, <span class="dt">byid=</span><span class="ot">TRUE</span>, na10km_bb)</a></code></pre></div>
<p>Plot the projected shapefiles.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1"><span class="kw">plot</span>(na10km_coast_lines_proj)</a>
<a class="sourceLine" id="cb84-2" title="2"><span class="kw">plot</span>(na10km_admin0_poly_proj, <span class="dt">bor=</span><span class="st">&quot;gray&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb84-3" title="3"><span class="kw">plot</span>(na10km_can_lines_proj, <span class="dt">col=</span><span class="st">&quot;pink&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb84-4" title="4"><span class="kw">plot</span>(na10km_us_lines_proj, <span class="dt">col=</span><span class="st">&quot;lightblue&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb84-5" title="5"><span class="kw">plot</span>(na10km_lrglakes_poly_proj, <span class="dt">bor=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb84-6" title="6"><span class="kw">plot</span>(na10km_bb, <span class="dt">bor=</span><span class="st">&quot;purple&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="RMaps_files/figure-html/plot%20projected%20shapefiles-1.png" width="2100" /></p>
</div>
<div id="write-out-the-projected-and-trimmed-shape-files" class="section level2">
<h2><span class="header-section-number">5.3</span> Write out the projected and trimmed shape files</h2>
<p>Next, write out the projected shapefiles, first setting the output path.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1"><span class="co"># write out the various shapefiles </span></a>
<a class="sourceLine" id="cb85-2" title="2">outpath &lt;-<span class="st"> &quot;/Users/bartlein/Projects/ESSD/data/RMaps/derived/na10km_10m/&quot;</span></a>
<a class="sourceLine" id="cb85-3" title="3">outshape &lt;-<span class="st"> </span>na10km_coast_lines_proj</a>
<a class="sourceLine" id="cb85-4" title="4">outfile &lt;-<span class="st"> &quot;na10km_10m_coast_lines&quot;</span></a>
<a class="sourceLine" id="cb85-5" title="5">outshapefile &lt;-<span class="st"> </span><span class="kw">paste</span>(outpath,outfile,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb85-6" title="6">spdf &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">as.numeric</span>(<span class="kw">row.names</span>(outshape)))</a>
<a class="sourceLine" id="cb85-7" title="7"><span class="kw">row.names</span>(spdf) &lt;-<span class="st"> </span><span class="kw">row.names</span>(outshape)</a>
<a class="sourceLine" id="cb85-8" title="8">outshape &lt;-<span class="st"> </span><span class="kw">SpatialLinesDataFrame</span>(outshape, spdf)</a>
<a class="sourceLine" id="cb85-9" title="9"><span class="kw">writeOGR</span>(outshape, outshapefile, outfile, <span class="dt">driver=</span><span class="st">&quot;ESRI Shapefile&quot;</span>, <span class="dt">overwrite_layer=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p>It’s always good practice to test whether the shapefile has ideed been written out correctly. Read it back in and plot it.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1">test &lt;-<span class="st"> </span><span class="kw">readOGR</span>(outshapefile)</a></code></pre></div>
<pre><code>## OGR data source with driver: ESRI Shapefile 
## Source: &quot;/Users/bartlein/Projects/ESSD/data/RMaps/derived/na10km_10m/na10km_10m_coast_lines&quot;, layer: &quot;na10km_10m_coast_lines&quot;
## with 1 features
## It has 1 fields</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1"><span class="kw">plot</span>(test, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>)</a></code></pre></div>
<p><img src="RMaps_files/figure-html/test%20shape2-1.png" width="2100" /></p>
<p>Write out the other shape files (output is suppressed):</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" title="1"><span class="co"># write out the various shapefiles </span></a>
<a class="sourceLine" id="cb89-2" title="2">outshape &lt;-<span class="st"> </span>na10km_bb</a>
<a class="sourceLine" id="cb89-3" title="3">outfile &lt;-<span class="st"> &quot;na10km_10m_bb&quot;</span></a>
<a class="sourceLine" id="cb89-4" title="4">outshapefile &lt;-<span class="st"> </span><span class="kw">paste</span>(outpath,outfile,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb89-5" title="5">spdf &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">as.numeric</span>(<span class="kw">row.names</span>(outshape)))</a>
<a class="sourceLine" id="cb89-6" title="6"><span class="kw">row.names</span>(spdf) &lt;-<span class="st"> </span><span class="kw">row.names</span>(outshape)</a>
<a class="sourceLine" id="cb89-7" title="7">outshape &lt;-<span class="st"> </span><span class="kw">SpatialPolygonsDataFrame</span>(outshape, spdf)</a>
<a class="sourceLine" id="cb89-8" title="8"><span class="kw">writeOGR</span>(outshape, outshapefile, outfile, <span class="dt">driver=</span><span class="st">&quot;ESRI Shapefile&quot;</span>, <span class="dt">overwrite_layer=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb89-9" title="9"></a>
<a class="sourceLine" id="cb89-10" title="10">outshape &lt;-<span class="st"> </span>na10km_lakes_poly_proj</a>
<a class="sourceLine" id="cb89-11" title="11">outfile &lt;-<span class="st"> &quot;na10km_10m_lakes_poly&quot;</span></a>
<a class="sourceLine" id="cb89-12" title="12">outshapefile &lt;-<span class="st"> </span><span class="kw">paste</span>(outpath,outfile,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb89-13" title="13">spdf &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">as.numeric</span>(<span class="kw">row.names</span>(outshape)))</a>
<a class="sourceLine" id="cb89-14" title="14"><span class="kw">row.names</span>(spdf) &lt;-<span class="st"> </span><span class="kw">row.names</span>(outshape)</a>
<a class="sourceLine" id="cb89-15" title="15">outshape &lt;-<span class="st"> </span><span class="kw">SpatialPolygonsDataFrame</span>(outshape, spdf)</a>
<a class="sourceLine" id="cb89-16" title="16"><span class="kw">writeOGR</span>(outshape, outshapefile, outfile, <span class="dt">driver=</span><span class="st">&quot;ESRI Shapefile&quot;</span>, <span class="dt">overwrite_layer=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb89-17" title="17"></a>
<a class="sourceLine" id="cb89-18" title="18">outshape &lt;-<span class="st"> </span>na10km_lrglakes_poly_proj</a>
<a class="sourceLine" id="cb89-19" title="19">outfile &lt;-<span class="st"> &quot;na10km_10m_lrglakes_poly&quot;</span></a>
<a class="sourceLine" id="cb89-20" title="20">outshapefile &lt;-<span class="st"> </span><span class="kw">paste</span>(outpath,outfile,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb89-21" title="21">spdf &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">as.numeric</span>(<span class="kw">row.names</span>(outshape)))</a>
<a class="sourceLine" id="cb89-22" title="22"><span class="kw">row.names</span>(spdf) &lt;-<span class="st"> </span><span class="kw">row.names</span>(outshape)</a>
<a class="sourceLine" id="cb89-23" title="23">outshape &lt;-<span class="st"> </span><span class="kw">SpatialPolygonsDataFrame</span>(outshape, spdf)</a>
<a class="sourceLine" id="cb89-24" title="24"><span class="kw">writeOGR</span>(outshape, outshapefile, outfile, <span class="dt">driver=</span><span class="st">&quot;ESRI Shapefile&quot;</span>, <span class="dt">overwrite_layer=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb89-25" title="25"></a>
<a class="sourceLine" id="cb89-26" title="26">outshape &lt;-<span class="st"> </span>na10km_can_poly_proj</a>
<a class="sourceLine" id="cb89-27" title="27">outfile &lt;-<span class="st"> &quot;na10km_10m_can_poly&quot;</span></a>
<a class="sourceLine" id="cb89-28" title="28">outshapefile &lt;-<span class="st"> </span><span class="kw">paste</span>(outpath,outfile,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb89-29" title="29">spdf &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">as.numeric</span>(<span class="kw">row.names</span>(outshape)))</a>
<a class="sourceLine" id="cb89-30" title="30"><span class="kw">row.names</span>(spdf) &lt;-<span class="st"> </span><span class="kw">row.names</span>(outshape)</a>
<a class="sourceLine" id="cb89-31" title="31">outshape &lt;-<span class="st"> </span><span class="kw">SpatialPolygonsDataFrame</span>(outshape, spdf)</a>
<a class="sourceLine" id="cb89-32" title="32"><span class="kw">writeOGR</span>(outshape, outshapefile, outfile, <span class="dt">driver=</span><span class="st">&quot;ESRI Shapefile&quot;</span>, <span class="dt">overwrite_layer=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb89-33" title="33"></a>
<a class="sourceLine" id="cb89-34" title="34">outshape &lt;-<span class="st"> </span>na10km_us_poly_proj</a>
<a class="sourceLine" id="cb89-35" title="35">outfile &lt;-<span class="st"> &quot;na10km_10m_us_poly&quot;</span></a>
<a class="sourceLine" id="cb89-36" title="36">outshapefile &lt;-<span class="st"> </span><span class="kw">paste</span>(outpath,outfile,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb89-37" title="37">spdf &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">as.numeric</span>(<span class="kw">row.names</span>(outshape)))</a>
<a class="sourceLine" id="cb89-38" title="38"><span class="kw">row.names</span>(spdf) &lt;-<span class="st"> </span><span class="kw">row.names</span>(outshape)</a>
<a class="sourceLine" id="cb89-39" title="39">outshape &lt;-<span class="st"> </span><span class="kw">SpatialPolygonsDataFrame</span>(outshape, spdf)</a>
<a class="sourceLine" id="cb89-40" title="40"><span class="kw">writeOGR</span>(outshape, outshapefile, outfile, <span class="dt">driver=</span><span class="st">&quot;ESRI Shapefile&quot;</span>, <span class="dt">overwrite_layer=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb89-41" title="41"></a>
<a class="sourceLine" id="cb89-42" title="42">outshape &lt;-<span class="st"> </span>na10km_can_lines_proj</a>
<a class="sourceLine" id="cb89-43" title="43">outfile &lt;-<span class="st"> &quot;na10km_10m_can_lines&quot;</span></a>
<a class="sourceLine" id="cb89-44" title="44">outshapefile &lt;-<span class="st"> </span><span class="kw">paste</span>(outpath,outfile,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb89-45" title="45">spdf &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">as.numeric</span>(<span class="kw">row.names</span>(outshape)))</a>
<a class="sourceLine" id="cb89-46" title="46"><span class="kw">row.names</span>(spdf) &lt;-<span class="st"> </span><span class="kw">row.names</span>(outshape)</a>
<a class="sourceLine" id="cb89-47" title="47">outshape &lt;-<span class="st"> </span><span class="kw">SpatialLinesDataFrame</span>(outshape, spdf)</a>
<a class="sourceLine" id="cb89-48" title="48"><span class="kw">writeOGR</span>(outshape, outshapefile, outfile, <span class="dt">driver=</span><span class="st">&quot;ESRI Shapefile&quot;</span>, <span class="dt">overwrite_layer=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb89-49" title="49"></a>
<a class="sourceLine" id="cb89-50" title="50">outshape &lt;-<span class="st"> </span>na10km_us_lines_proj</a>
<a class="sourceLine" id="cb89-51" title="51">outfile &lt;-<span class="st"> &quot;na10km_10m_us_lines&quot;</span></a>
<a class="sourceLine" id="cb89-52" title="52">outshapefile &lt;-<span class="st"> </span><span class="kw">paste</span>(outpath,outfile,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb89-53" title="53">spdf &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">as.numeric</span>(<span class="kw">row.names</span>(outshape)))</a>
<a class="sourceLine" id="cb89-54" title="54"><span class="kw">row.names</span>(spdf) &lt;-<span class="st"> </span><span class="kw">row.names</span>(outshape)</a>
<a class="sourceLine" id="cb89-55" title="55">outshape &lt;-<span class="st"> </span><span class="kw">SpatialLinesDataFrame</span>(outshape, spdf)</a>
<a class="sourceLine" id="cb89-56" title="56"><span class="kw">writeOGR</span>(outshape, outshapefile, outfile, <span class="dt">driver=</span><span class="st">&quot;ESRI Shapefile&quot;</span>, <span class="dt">overwrite_layer=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb89-57" title="57"></a>
<a class="sourceLine" id="cb89-58" title="58">outshape &lt;-<span class="st"> </span>na10km_admin0_poly_proj</a>
<a class="sourceLine" id="cb89-59" title="59">outfile &lt;-<span class="st"> &quot;na10km_10m_admin0_poly&quot;</span></a>
<a class="sourceLine" id="cb89-60" title="60">outshapefile &lt;-<span class="st"> </span><span class="kw">paste</span>(outpath,outfile,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb89-61" title="61">spdf &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">as.numeric</span>(<span class="kw">row.names</span>(outshape)))</a>
<a class="sourceLine" id="cb89-62" title="62"><span class="kw">row.names</span>(spdf) &lt;-<span class="st"> </span><span class="kw">row.names</span>(outshape)</a>
<a class="sourceLine" id="cb89-63" title="63">outshape &lt;-<span class="st"> </span><span class="kw">SpatialPolygonsDataFrame</span>(outshape, spdf)</a>
<a class="sourceLine" id="cb89-64" title="64"><span class="kw">writeOGR</span>(outshape, outshapefile, outfile, <span class="dt">driver=</span><span class="st">&quot;ESRI Shapefile&quot;</span>, <span class="dt">overwrite_layer=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb89-65" title="65"></a>
<a class="sourceLine" id="cb89-66" title="66">outshape &lt;-<span class="st"> </span>na10km_admin1_poly_proj</a>
<a class="sourceLine" id="cb89-67" title="67">outfile &lt;-<span class="st"> &quot;na10km_10m_admin1_poly&quot;</span></a>
<a class="sourceLine" id="cb89-68" title="68">outshapefile &lt;-<span class="st"> </span><span class="kw">paste</span>(outpath,outfile,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb89-69" title="69">spdf &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">as.numeric</span>(<span class="kw">row.names</span>(outshape)))</a>
<a class="sourceLine" id="cb89-70" title="70"><span class="kw">row.names</span>(spdf) &lt;-<span class="st"> </span><span class="kw">row.names</span>(outshape)</a>
<a class="sourceLine" id="cb89-71" title="71">outshape &lt;-<span class="st"> </span><span class="kw">SpatialPolygonsDataFrame</span>(outshape, spdf)</a>
<a class="sourceLine" id="cb89-72" title="72"><span class="kw">writeOGR</span>(outshape, outshapefile, outfile, <span class="dt">driver=</span><span class="st">&quot;ESRI Shapefile&quot;</span>, <span class="dt">overwrite_layer=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p><a href="Rmaps.html">[Back to top]</a></p>
</div>
</div>
<div id="map-of-north-american-shaded-relief" class="section level1">
<h1><span class="header-section-number">6</span> Map of North American shaded relief</h1>
<div id="read-the-read-the-projected-and-trimmed-shapefiles" class="section level2">
<h2><span class="header-section-number">6.1</span> Read the read the projected and trimmed shapefiles</h2>
<p>Load the appropriate packages.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1"><span class="kw">library</span>(sp)</a></code></pre></div>
<p>Read the shapefiles:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" title="1">shapepath &lt;-<span class="st"> &quot;/Users/bartlein/Projects/ESSD/data/RMaps/derived/na10km_10m/&quot;</span></a>
<a class="sourceLine" id="cb91-2" title="2">na10km_bb &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="kw">paste</span>(shapepath, <span class="st">&quot;na10km_10m_bb.shp&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb91-3" title="3">na10km_coast_lines_proj &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="kw">paste</span>(shapepath, <span class="st">&quot;na10km_10m_coast_lines.shp&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb91-4" title="4">na10km_admin0_poly_proj &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="kw">paste</span>(shapepath, <span class="st">&quot;na10km_10m_admin0_poly.shp&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb91-5" title="5">na10km_lakes_poly_proj &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="kw">paste</span>(shapepath, <span class="st">&quot;na10km_10m_lakes_poly.shp&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb91-6" title="6">na10km_lrglakes_poly_proj &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="kw">paste</span>(shapepath, <span class="st">&quot;na10km_10m_lrglakes_poly.shp&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb91-7" title="7">na10km_can_lines_proj &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="kw">paste</span>(shapepath, <span class="st">&quot;na10km_10m_can_lines.shp&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb91-8" title="8">na10km_us_lines_proj &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="kw">paste</span>(shapepath, <span class="st">&quot;na10km_10m_us_lines.shp&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a></code></pre></div>
<p>Plot the projected and trimmed shapefiles:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1"><span class="kw">plot</span>(na10km_admin0_poly_proj, <span class="dt">bor=</span><span class="st">&quot;gray&quot;</span>)</a>
<a class="sourceLine" id="cb92-2" title="2"><span class="kw">plot</span>(na10km_can_lines_proj, <span class="dt">col=</span><span class="st">&quot;gray&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb92-3" title="3"><span class="kw">plot</span>(na10km_us_lines_proj, <span class="dt">col=</span><span class="st">&quot;gray&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb92-4" title="4"><span class="kw">plot</span>(na10km_lrglakes_poly_proj, <span class="dt">col=</span><span class="st">&quot;lightblue&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb92-5" title="5"><span class="kw">plot</span>(na10km_coast_lines_proj, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb92-6" title="6"><span class="kw">plot</span>(na10km_bb, <span class="dt">bor=</span><span class="st">&quot;black&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="RMaps_files/figure-html/plot%20projected%20and%20trimmed%20shapefiles-1.png" width="2100" /></p>
</div>
<div id="read-a-shaded-relief-file" class="section level2">
<h2><span class="header-section-number">6.2</span> Read a shaded relief file</h2>
<p>Read a pre-computed shaded relief file. This could also be crearted by reading the na10km_v2 grid-point elevations and using the <code>hillshade</code> function from the <code>raster</code> package. Note that in this file, the coordinates are in km, and so they must be multiplied by 1000.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1">datapath &lt;-<span class="st"> &quot;/Users/bartlein/Projects/ESSD/data/csv_files/&quot;</span></a>
<a class="sourceLine" id="cb93-2" title="2">datafile &lt;-<span class="st"> &quot;na10km_shade.csv&quot;</span></a>
<a class="sourceLine" id="cb93-3" title="3">shade &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="kw">paste</span>(datapath,datafile,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb93-4" title="4">shade<span class="op">$</span>x &lt;-<span class="st"> </span>shade<span class="op">$</span>x<span class="op">*</span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb93-5" title="5">shade<span class="op">$</span>y &lt;-<span class="st"> </span>shade<span class="op">$</span>y<span class="op">*</span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb93-6" title="6"><span class="kw">head</span>(shade)</a></code></pre></div>
<pre><code>##          x       y    shade      lat       lon
## 1 -5770000 -820000 0.691208 21.83661 -160.1851
## 2 -5760000 -820000 0.691208 21.90175 -160.1023
## 3 -5720000 -860000 0.310095 21.90119 -159.5651
## 4 -5720000 -850000 0.333957 21.96637 -159.6163
## 5 -5720000 -840000 0.559432 22.03148 -159.6676
## 6 -5720000 -830000 0.956591 22.09651 -159.7191</code></pre>
<p>Convert the dataframe to a SpatialPixelsData Frame</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1"><span class="kw">coordinates</span>(shade) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>)</a>
<a class="sourceLine" id="cb95-2" title="2"><span class="kw">points2grid</span>(shade)</a></code></pre></div>
<pre><code>## Warning in points2grid(shade): grid has empty column/rows in dimension 1</code></pre>
<pre><code>##                          x        y
## cellcentre.offset -5770000 -4510000
## cellsize             10000    10000
## cells.dim             1078      900</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" title="1">shade_pixels &lt;-<span class="st"> </span><span class="kw">as</span>(shade, <span class="st">&quot;SpatialPixelsDataFrame&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in points2grid(points, tolerance, round): grid has empty column/rows in dimension 1</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" title="1"><span class="kw">summary</span>(shade_pixels)</a></code></pre></div>
<pre><code>## Object of class SpatialPixelsDataFrame
## Coordinates:
##        min     max
## x -5775000 5005000
## y -4515000 4485000
## Is projected: NA 
## proj4string : [NA]
## Number of points: 282017
## Grid attributes:
##   cellcentre.offset cellsize cells.dim
## x          -5770000    10000      1078
## y          -4510000    10000       900
## Data attributes:
##      shade              lat              lon          
##  Min.   :-0.5064   Min.   :-2.757   Min.   :-203.188  
##  1st Qu.: 0.6297   1st Qu.:35.292   1st Qu.:-113.434  
##  Median : 0.6958   Median :49.353   Median : -96.309  
##  Mean   : 0.6556   Mean   :46.929   Mean   : -96.031  
##  3rd Qu.: 0.7318   3rd Qu.:62.580   3rd Qu.: -74.614  
##  Max.   : 1.0000   Max.   :83.617   Max.   :   4.453</code></pre>
<p>Read some predetermined (gray-scale) colors for the shading.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" title="1">colorfile &lt;-<span class="st"> &quot;shade40_clr.csv&quot;</span></a>
<a class="sourceLine" id="cb102-2" title="2">shade_rgb &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="kw">paste</span>(datapath, colorfile, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb102-3" title="3">shade_clr &lt;-<span class="st"> </span><span class="kw">rgb</span>(shade_rgb)</a></code></pre></div>
<p>Set the (gray-scale) color numbers for each pixel:</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" title="1">shade_int &lt;-<span class="st"> </span><span class="kw">as.integer</span>(((shade<span class="op">$</span>shade<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span><span class="dv">40</span>)<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb103-2" title="2">shade_colnum &lt;-<span class="st"> </span>shade_clr[shade_int]</a></code></pre></div>
</div>
<div id="make-the-map" class="section level2">
<h2><span class="header-section-number">6.3</span> Make the map</h2>
<p>Plot the shaded-relief colors and the various shape files. The location of the text string was determined by plotting an initial version ofthe map, and using the <code>locate()</code> function. The <code>cex=0.09</code> argument in the <code>points()</code> function was detrmined by trial and error.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" title="1"><span class="kw">pdf</span>(<span class="dt">file =</span> <span class="st">&quot;na_shade01b.pdf&quot;</span>)</a>
<a class="sourceLine" id="cb104-2" title="2"><span class="kw">plot</span>(na10km_bb, <span class="dt">col=</span><span class="st">&quot;gray95&quot;</span>)</a>
<a class="sourceLine" id="cb104-3" title="3"><span class="kw">points</span>(shade_pixels, <span class="dt">pch=</span><span class="dv">15</span>, <span class="dt">cex=</span><span class="fl">0.09</span>, <span class="dt">col=</span>shade_colnum)</a>
<a class="sourceLine" id="cb104-4" title="4"><span class="kw">plot</span>(na10km_admin0_poly_proj, <span class="dt">lwd=</span><span class="fl">0.2</span>, <span class="dt">bor=</span><span class="st">&quot;gray50&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb104-5" title="5"><span class="kw">plot</span>(na10km_can_lines_proj, <span class="dt">lwd=</span><span class="fl">0.2</span>, <span class="dt">col=</span><span class="st">&quot;gray50&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb104-6" title="6"><span class="kw">plot</span>(na10km_us_lines_proj, <span class="dt">lwd=</span><span class="fl">0.2</span>, <span class="dt">col=</span><span class="st">&quot;gray50&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb104-7" title="7"><span class="kw">plot</span>(na10km_lrglakes_poly_proj, <span class="dt">lwd=</span><span class="fl">0.2</span>, <span class="dt">bor=</span><span class="st">&quot;black&quot;</span>, <span class="dt">col=</span><span class="st">&quot;gray90&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb104-8" title="8"><span class="kw">plot</span>(na10km_coast_lines_proj, <span class="dt">lwd=</span><span class="fl">0.3</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb104-9" title="9"><span class="kw">text</span>(<span class="op">-</span><span class="dv">5770000</span>, <span class="dv">4620000</span>, <span class="dt">pos=</span><span class="kw">c</span>(<span class="dv">4</span>), <span class="dt">offset=</span><span class="fl">0.0</span>, <span class="dt">cex=</span><span class="fl">1.0</span>, <span class="st">&quot;NA10km_v2 -- 10m Natural Earth Outlines&quot;</span>)</a>
<a class="sourceLine" id="cb104-10" title="10"><span class="kw">plot</span>(na10km_bb, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb104-11" title="11"><span class="kw">dev.off</span>()</a></code></pre></div>
<p>The resulting plot will look like this: <img src="images/na_shade01b.png" /></p>
<p><a href="Rmaps.html">[Back to top]</a></p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
