<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Visualization for explanation</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/clipboard-1.7.1/clipboard.min.js"></script>
<link href="site_libs/primer-tooltips-1.4.0/build.css" rel="stylesheet" />
<link href="site_libs/klippy-0.0.0.9500/css/klippy.min.css" rel="stylesheet" />
<script src="site_libs/klippy-0.0.0.9500/js/klippy.min.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; } /* Alert */
code span.an { color: #008000; } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { color: #0000ff; } /* ControlFlow */
code span.ch { color: #008080; } /* Char */
code span.cn { } /* Constant */
code span.co { color: #008000; } /* Comment */
code span.cv { color: #008000; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #0000ff; } /* Keyword */
code span.op { } /* Operator */
code span.ot { color: #ff4000; } /* Other */
code span.pp { color: #ff4000; } /* Preprocessor */
code span.sc { color: #008080; } /* SpecialChar */
code span.ss { color: #008080; } /* SpecialString */
code span.st { color: #008080; } /* String */
code span.va { } /* Variable */
code span.vs { color: #008080; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="html-md-01.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">R for Earth-System Science</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="overview.html">Overview</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Topics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Lecture topics</li>
    <li>
      <a href="intro.html">Introduction: R, RStudio, and other infrastructure</a>
    </li>
    <li>
      <a href="usingR.html">Using R</a>
    </li>
    <li>
      <a href="ESSdata.html">Earth-system science data</a>
    </li>
    <li>
      <a href="netCDF.html">netCDF in R</a>
    </li>
    <li>
      <a href="raster_intro.html">raster and netCDF in R</a>
    </li>
    <li>
      <a href="hdf5_intro.html">HDF in R</a>
    </li>
    <li>
      <a href="geospatial.html">Geospatial analyses</a>
    </li>
    <li>
      <a href="RMaps.html">Maps in R</a>
    </li>
    <li>
      <a href="RMaps2.html">Maps in R (2)</a>
    </li>
    <li>
      <a href="rasterVis01.html">Visualization:  raster and rasterVis</a>
    </li>
    <li>
      <a href="vis_ggplot01.html">Visualization for explanation</a>
    </li>
    <li>
      <a href="highdim.html">Visualization of high-dimensional data</a>
    </li>
    <li>
      <a href="PCA.html">Principal components analysis</a>
    </li>
    <li>
      <a href="multivariate.html">Other multivariate analyses</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tasks
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="geog495_ex01.html">Install R and RStudio</a>
    </li>
    <li>
      <a href="packages-and-data.html">Install packages and data</a>
    </li>
    <li>
      <a href="GitHub.html">Git and GitHub</a>
    </li>
    <li>
      <a href="Ex_UsingR.html">Using R exercise</a>
    </li>
    <li>
      <a href="markdown.html">Markdown and RMarkdown</a>
    </li>
    <li>
      <a href="install_netCDF.html">Install netCDF</a>
    </li>
    <li>
      <a href="install_Panoply.html">Install Panoply</a>
    </li>
    <li>
      <a href="transfer.html">File transfer</a>
    </li>
    <li>
      <a href="project.html">GitHub project repository and web page</a>
    </li>
    <li>
      <a href="ltms-and-anomalies.html">Long-term means and anomalies</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Resources
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="readings.html">Readings</a>
    </li>
    <li>
      <a href="websites.html">Old course web pages</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="about.html">About</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Visualization for explanation</h1>

</div>

<div id="TOC">
<ul>
<li><a href="#introduction"><span class="toc-section-number">1</span> Introduction</a></li>
<li><a href="#data"><span class="toc-section-number">2</span> Data</a></li>
<li><a href="#maps"><span class="toc-section-number">3</span> Maps</a></li>
<li><a href="#set-up"><span class="toc-section-number">4</span> Set up</a><ul>
<li><a href="#transformation"><span class="toc-section-number">4.1</span> Transformation</a></li>
<li><a href="#censor-observations-with-unusual-megabiome-values"><span class="toc-section-number">4.2</span> Censor observations with unusual megabiome values</a></li>
</ul></li>
<li><a href="#controls-of-biomass-burning"><span class="toc-section-number">5</span> Controls of biomass burning</a><ul>
<li><a href="#bivariate-relationship-with-burned-fraction"><span class="toc-section-number">5.1</span> Bivariate relationship with burned fraction</a></li>
<li><a href="#influence-of-vegetation-type-on-biomass-burning"><span class="toc-section-number">5.2</span> Influence of vegetation type on biomass burning</a></li>
<li><a href="#a-two-predictor-generalized-additive-model-gam"><span class="toc-section-number">5.3</span> A two-predictor Generalized Additive Model (GAM)</a></li>
</ul></li>
</ul>
</div>

<script>
  addClassKlippyTo("pre.r, pre.markdown");
  addKlippy('right', 'top', 'auto', '1', 'Copy code', 'Copied!');
</script>
<div id="introduction" class="section level1">
<h1><span class="header-section-number">1</span> Introduction</h1>
<p>Although although visualization is often used simply to characterize individual variables, its use to understand relationship among variables is probably of greater value (see, for example, Wickham, H, and G. Grolemund, 2017, <em>R for Data Science</em>, O’Reilly <a href="https://proquestcombo.safaribooksonline.com/9781491910382">UO library</a>. The examples here reproduce some of the analyses in Daniau, A.-L., P.J. Bartlein, S.P. Harrison and 57 others, 2012, Predictability of biomass burning in response to climate changes, <em>Global Biogeochemical Cycles</em> 26, GB4007, <a href="https://doi.org/10.1029/2011GB004249">doi:10.1029/2011GB004249</a>, which focued on both paleo and present-day relationship between global biomass burning and climate. The present-day analysis focused on the prediction of satellite remote-sensing patterns of biomass burning from the GFEDv3.1 database (Global Fire Emissions, <a href="http://www.globalfiredata.org">http://www.globalfiredata.org</a>). The idea was to find a small number of predictors of the broadscale patterns of biomass burning, and it turned out that in both the paleo and present-day data sets, those predictors were mean annual temperature and precipitation minus evaporation (P-E, or <code>pme</code>). The analysis below recapitulates some of the analyses in the Daniau et al. paper.</p>
<p>Here, most of the analysis is done using the <code>ggplot2</code> package for mapping and visualization.</p>
</div>
<div id="data" class="section level1">
<h1><span class="header-section-number">2</span> Data</h1>
<p>The input data consist of the GFEDv3.1 burned fraction (of half-degree grid cells, <code>gfed</code>), several bioclimatic variables (mean annual temperature (<code>mat</code>), mean temperature of the warmest and coldest months (<code>mtwa</code> and <code>mtco</code> respectively), growing degree days (5-deg C base, <code>gdd5</code>), annual precipitation (<code>map</code>), annual equilibrium evapotranspiration (<code>aet</code>), precipitation minus evapotranspiration (<code>pme</code>), lightning-strike frequency (<code>hmrc</code>), population density (<code>gpw</code>), net primary productivity (<code>npp</code>), treecover (<code>treecov</code>), and two categorical variables describing “megabiomes” and potential natural vegetation types (<code>megabiome</code> and <code>vegtype</code> respectively).</p>
<p>Load the necessary packages:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># load packages</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">library</span>(sf)</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw">library</span>(tidyr)</a></code></pre></div>
<pre><code>## 
## Attaching package: &#39;tidyr&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:raster&#39;:
## 
##     extract</code></pre>
<p>Read the data from a pre-made <code>.csv</code> file.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="co"># read the data</span></a>
<a class="sourceLine" id="cb4-2" title="2">csvpath &lt;-<span class="st"> &quot;/Users/bartlein/Projects/ESSD/data/csv_files/&quot;</span></a>
<a class="sourceLine" id="cb4-3" title="3">csvname &lt;-<span class="st"> &quot;global_fire.csv&quot;</span></a>
<a class="sourceLine" id="cb4-4" title="4">csvfile &lt;-<span class="st"> </span><span class="kw">paste</span>(csvpath, csvname, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb4-5" title="5">gf &lt;-<span class="st"> </span><span class="kw">read.csv</span>(csvfile)</a>
<a class="sourceLine" id="cb4-6" title="6"><span class="kw">str</span>(gf)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    54642 obs. of  17 variables:
##  $ lon      : num  -73.8 -73.2 -72.8 -72.2 -71.8 ...
##  $ lat      : num  -52.8 -52.8 -52.8 -52.8 -52.8 ...
##  $ gfed     : num  0 0 0 0 0 0 0 0 0 0 ...
##  $ mat      : num  6.54 5.72 5.16 5.51 5.53 ...
##  $ mtco     : num  3.1 1.9 1 1 0.8 ...
##  $ mtwa     : num  9.7 9.2 8.9 9.6 9.8 ...
##  $ gdd5     : num  690 543 466 569 598 ...
##  $ gpw      : num  1.78 1.78 1.78 1.78 1.78 ...
##  $ hrmc     : num  0.031 0.031 0.031 0.031 0 ...
##  $ map      : int  3992 3222 2485 1829 1217 687 381 309 297 284 ...
##  $ aet      : num  393 335 366 490 585 ...
##  $ alpha    : num  0.667 0.576 0.635 0.833 0.983 ...
##  $ pme      : num  3599 2887 2119 1339 632 ...
##  $ treecov  : int  0 0 0 0 39 0 0 23 0 0 ...
##  $ npp      : num  331 348 381 377 442 ...
##  $ megabiome: Factor w/ 10 levels &quot;BorF&quot;,&quot;Dsrt&quot;,..: 5 5 5 5 5 5 5 1 1 1 ...
##  $ vegtype  : Factor w/ 15 levels &quot;BrDFW&quot;,&quot;BrEFW&quot;,..: 4 6 4 5 5 5 5 5 5 5 ...</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">summary</span>(gf)</a></code></pre></div>
<pre><code>##       lon               lat              gfed                mat               mtco        
##  Min.   :-179.75   Min.   :-52.75   Min.   :0.0000000   Min.   :-22.808   Min.   :-51.600  
##  1st Qu.: -60.25   1st Qu.:  7.25   1st Qu.:0.0000000   1st Qu.: -1.358   1st Qu.:-19.100  
##  Median :  31.75   Median : 36.75   Median :0.0001737   Median : 10.946   Median :  0.100  
##  Mean   :  22.12   Mean   : 29.85   Mean   :0.0229601   Mean   : 10.068   Mean   : -1.871  
##  3rd Qu.:  93.75   3rd Qu.: 55.75   3rd Qu.:0.0051268   3rd Qu.: 23.292   3rd Qu.: 16.700  
##  Max.   : 179.75   Max.   : 80.25   Max.   :1.1285924   Max.   : 30.500   Max.   : 28.000  
##                                                                                            
##       mtwa            gdd5           gpw                hrmc             map              aet        
##  Min.   :-1.50   Min.   :   0   Min.   :   0.000   Min.   : 0.000   Min.   :   0.0   Min.   :   0.0  
##  1st Qu.:15.60   1st Qu.: 895   1st Qu.:   0.203   1st Qu.: 1.037   1st Qu.: 273.0   1st Qu.: 229.7  
##  Median :22.20   Median :2737   Median :   2.135   Median : 3.112   Median : 500.0   Median : 385.6  
##  Mean   :21.48   Mean   :3667   Mean   :  38.516   Mean   : 7.221   Mean   : 709.6   Mean   : 474.2  
##  3rd Qu.:27.40   3rd Qu.:6678   3rd Qu.:  17.975   3rd Qu.:10.265   3rd Qu.: 927.0   3rd Qu.: 663.4  
##  Max.   :38.20   Max.   :9317   Max.   :7895.593   Max.   :98.868   Max.   :7531.0   Max.   :1538.3  
##                                                                                                      
##      alpha             pme              treecov          npp           megabiome        vegtype     
##  Min.   :0.0000   Min.   : -13.052   Min.   : 0.0   Min.   :   5.9   BorF   :11356   EDMFW  : 8787  
##  1st Qu.:0.4491   1st Qu.:   0.265   1st Qu.: 0.0   1st Qu.: 176.4   GrsShrb: 9372   Savan  : 6766  
##  Median :0.6678   Median :  66.514   Median : 0.0   Median : 340.6   TempF  : 7874   GrStp  : 5958  
##  Mean   :0.6003   Mean   : 235.368   Mean   :21.9   Mean   : 411.4   Dsrt   : 6728   Dsrt   : 5443  
##  3rd Qu.:0.7997   3rd Qu.: 257.029   3rd Qu.:44.0   3rd Qu.: 581.6   TropF  : 6678   TrEFW  : 5225  
##  Max.   :1.0000   Max.   :6073.094   Max.   :80.0   Max.   :1372.7   Tund   : 4896   ShrbO  : 4494  
##                                                                      (Other): 7738   (Other):17969</code></pre>
<p>The two categorical (i.e. factor) variables have levels arranged in the default alphabetical order. The following code reorders the levels into something more ecologically and climatically sensible:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="co"># reorder megabiomes</span></a>
<a class="sourceLine" id="cb8-2" title="2">megabiome_name &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;TropF&quot;</span>, <span class="st">&quot;WarmF&quot;</span>, <span class="st">&quot;SavDWd&quot;</span>, <span class="st">&quot;GrsShrb&quot;</span>, <span class="st">&quot;Dsrt&quot;</span>, <span class="st">&quot;TempF&quot;</span>, <span class="st">&quot;BorF&quot;</span>, <span class="st">&quot;Tund&quot;</span>, <span class="st">&quot;None&quot;</span>, <span class="st">&quot;Ice&quot;</span>)</a>
<a class="sourceLine" id="cb8-3" title="3">gf<span class="op">$</span>megabiome &lt;-<span class="st"> </span><span class="kw">factor</span>(gf<span class="op">$</span>megabiome, <span class="dt">levels=</span>megabiome_name)</a>
<a class="sourceLine" id="cb8-4" title="4"></a>
<a class="sourceLine" id="cb8-5" title="5"><span class="co"># reorder vegtypes</span></a>
<a class="sourceLine" id="cb8-6" title="6">vegtype_name &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;TrEFW&quot;</span>,<span class="st">&quot;TrDFW&quot;</span>,<span class="st">&quot;TeBEFW&quot;</span>,<span class="st">&quot;TeNEFW&quot;</span>,<span class="st">&quot;TeDFW&quot;</span>,<span class="st">&quot;BrEFW&quot;</span>,<span class="st">&quot;BrDFW&quot;</span>,<span class="st">&quot;EDMFW&quot;</span>,</a>
<a class="sourceLine" id="cb8-7" title="7">                  <span class="st">&quot;Savan&quot;</span>,<span class="st">&quot;GrStp&quot;</span>,<span class="st">&quot;ShrbD&quot;</span>,<span class="st">&quot;ShrbO&quot;</span>,<span class="st">&quot;Tund&quot;</span>,<span class="st">&quot;Dsrt&quot;</span>,<span class="st">&quot;PDRI&quot;</span>)</a>
<a class="sourceLine" id="cb8-8" title="8">gf<span class="op">$</span>vegtype &lt;-<span class="st"> </span><span class="kw">factor</span>(gf<span class="op">$</span>vegtype, <span class="dt">levels=</span>vegtype_name)</a>
<a class="sourceLine" id="cb8-9" title="9"></a>
<a class="sourceLine" id="cb8-10" title="10"><span class="co"># check the new ordering of factor levels</span></a>
<a class="sourceLine" id="cb8-11" title="11"><span class="kw">str</span>(gf[<span class="dv">16</span><span class="op">:</span><span class="dv">17</span>])</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    54642 obs. of  2 variables:
##  $ megabiome: Factor w/ 10 levels &quot;TropF&quot;,&quot;WarmF&quot;,..: 9 9 9 9 9 9 9 7 7 7 ...
##  $ vegtype  : Factor w/ 15 levels &quot;TrEFW&quot;,&quot;TrDFW&quot;,..: 8 15 8 10 10 10 10 10 10 10 ...</code></pre>
</div>
<div id="maps" class="section level1">
<h1><span class="header-section-number">3</span> Maps</h1>
<p>It’s geneerally useful to map the data first. The following code implements <code>ggplot2</code> maps. A shapefile of world outlines is read the usual way with the <code>sf</code> package, then converted to a <code>ggplot2</code> compatible format using the <code>fortify()</code> function:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="co"># read a world outlines shape file</span></a>
<a class="sourceLine" id="cb10-2" title="2">shp_path &lt;-<span class="st"> &quot;/Users/bartlein/Projects/ESSD/data/shp_files/ne_110m_admin_0_countries/&quot;</span></a>
<a class="sourceLine" id="cb10-3" title="3">shp_name &lt;-<span class="st"> &quot;ne_110m_admin_0_countries.shp&quot;</span></a>
<a class="sourceLine" id="cb10-4" title="4">shp_file &lt;-<span class="st"> </span><span class="kw">paste</span>(shp_path, shp_name, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb10-5" title="5"></a>
<a class="sourceLine" id="cb10-6" title="6"><span class="co"># read the shapefile</span></a>
<a class="sourceLine" id="cb10-7" title="7">world_shp &lt;-<span class="st"> </span><span class="kw">read_sf</span>(shp_file)</a>
<a class="sourceLine" id="cb10-8" title="8">world_outline &lt;-<span class="st"> </span><span class="kw">as</span>(<span class="kw">st_geometry</span>(world_shp), <span class="dt">Class=</span><span class="st">&quot;Spatial&quot;</span>)</a>
<a class="sourceLine" id="cb10-9" title="9">world_outline_gg &lt;-<span class="st"> </span><span class="kw">fortify</span>(world_outline)</a>
<a class="sourceLine" id="cb10-10" title="10"></a>
<a class="sourceLine" id="cb10-11" title="11"><span class="co"># ggplot map of world_outline</span></a>
<a class="sourceLine" id="cb10-12" title="12"><span class="kw">ggplot</span>(world_outline_gg, <span class="kw">aes</span>(long, lat)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_polygon</span>(<span class="kw">aes</span>(<span class="dt">group =</span> group), <span class="dt">color =</span> <span class="st">&quot;gray50&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb10-13" title="13"><span class="st">  </span><span class="kw">coord_quickmap</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="vis_ggplot01_files/figure-html/unnamed-chunk-4-1.png" width="75%" height="75%" /></p>
<p>The map-pattern of the burned-fraction variable can be produced as follows:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw">ggplot</span>(gf, <span class="kw">aes</span>(lon, lat))  <span class="op">+</span></a>
<a class="sourceLine" id="cb11-2" title="2"><span class="st">  </span><span class="kw">geom_raster</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> <span class="kw">log10</span>(gf<span class="op">$</span>gfed))) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-3" title="3"><span class="st">  </span><span class="kw">scale_fill_gradient2</span>(<span class="dt">low =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">mid=</span><span class="st">&quot;orange&quot;</span>, <span class="dt">high =</span> <span class="st">&quot;firebrick1&quot;</span>, <span class="dt">midpoint=</span><span class="op">-</span><span class="dv">4</span>, <span class="dt">na.value=</span><span class="st">&quot;gray80&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-4" title="4"><span class="st">  </span><span class="kw">geom_polygon</span>(<span class="kw">aes</span>(long, lat, <span class="dt">group =</span> group), world_outline_gg, <span class="dt">color =</span> <span class="st">&quot;gray70&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">lwd=</span><span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-5" title="5"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;GFEDv3.1 Burned Fraction&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-6" title="6"><span class="st">  </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>)</a></code></pre></div>
<p><img src="vis_ggplot01_files/figure-html/unnamed-chunk-5-1.png" width="75%" height="75%" /></p>
</div>
<div id="set-up" class="section level1">
<h1><span class="header-section-number">4</span> Set up</h1>
<div id="transformation" class="section level2">
<h2><span class="header-section-number">4.1</span> Transformation</h2>
<p>Simple inspection of the data and preliminary examination reveals that many of the variables have long-tailed distributions, and non-linear relationships. This can be verified using a faceted plot of histograms. Note the use of the <code>dplyr</code> <code>gather()</code> function to “stack” the variables, and the <code>free_x</code> argument to the `facet_wrap() function to allow each variable to plotted on individual as opposed to joint scales:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="co"># check distributions</span></a>
<a class="sourceLine" id="cb12-2" title="2"><span class="kw">ggplot</span>(<span class="kw">gather</span>(gf[<span class="dv">3</span><span class="op">:</span><span class="dv">15</span>]), <span class="kw">aes</span>(value)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">20</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-4" title="4"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>key, <span class="dt">scales =</span> <span class="st">&#39;free_x&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-5" title="5"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="vis_ggplot01_files/figure-html/unnamed-chunk-6-1.png" width="75%" height="75%" /></p>
<p>For example, burned fraction has the kind of distribution, that if zeros are removed and the values tranformed by taking logarithms, would be approximately normal.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="co"># transform variables</span></a>
<a class="sourceLine" id="cb13-2" title="2"><span class="kw">hist</span>(<span class="kw">log10</span>(gf<span class="op">$</span>gfed[gf<span class="op">$</span>gfed <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>]))</a></code></pre></div>
<p><img src="vis_ggplot01_files/figure-html/unnamed-chunk-7-1.png" width="75%" height="75%" /></p>
<p>Find the minimum non-zero value of burned fraction:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">min</span>(<span class="kw">log10</span>(gf<span class="op">$</span>gfed[gf<span class="op">$</span>gfed <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>]))</a></code></pre></div>
<pre><code>## [1] -7.618481</code></pre>
<p>Tranform by taking logs (base 10), adding an increment slightly smaller than that minimum value, and check the distribution again.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">gf<span class="op">$</span>gfed &lt;-<span class="st"> </span><span class="kw">log10</span>(gf<span class="op">$</span>gfed <span class="op">+</span><span class="st"> </span><span class="fl">1e-6</span>)</a>
<a class="sourceLine" id="cb16-2" title="2"><span class="kw">hist</span>(gf<span class="op">$</span>gfed)</a></code></pre></div>
<p><img src="vis_ggplot01_files/figure-html/unnamed-chunk-9-1.png" width="75%" height="75%" /></p>
<p>A few other variables can be transformed in a similar fashion:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="kw">hist</span>(gf<span class="op">$</span>hrmc)</a>
<a class="sourceLine" id="cb17-2" title="2">gf<span class="op">$</span>hrmc &lt;-<span class="st"> </span><span class="kw">sqrt</span>(gf<span class="op">$</span>hrmc)</a>
<a class="sourceLine" id="cb17-3" title="3"><span class="kw">hist</span>(gf<span class="op">$</span>hrmc)</a>
<a class="sourceLine" id="cb17-4" title="4"></a>
<a class="sourceLine" id="cb17-5" title="5"><span class="kw">hist</span>(<span class="kw">log10</span>(gf<span class="op">$</span>gpw[gf<span class="op">$</span>gpw <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>]))</a>
<a class="sourceLine" id="cb17-6" title="6"><span class="kw">min</span>(<span class="kw">log10</span>(gf<span class="op">$</span>gpw[gf<span class="op">$</span>gpw <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>]))</a>
<a class="sourceLine" id="cb17-7" title="7">gf<span class="op">$</span>gpw &lt;-<span class="st"> </span><span class="kw">log10</span>(gf<span class="op">$</span>gpw <span class="op">+</span><span class="st"> </span><span class="fl">1e-10</span>)</a>
<a class="sourceLine" id="cb17-8" title="8"><span class="kw">hist</span>(gf<span class="op">$</span>gpw)</a>
<a class="sourceLine" id="cb17-9" title="9"></a>
<a class="sourceLine" id="cb17-10" title="10"><span class="kw">hist</span>(gf<span class="op">$</span>map)</a>
<a class="sourceLine" id="cb17-11" title="11">gf<span class="op">$</span>map &lt;-<span class="st"> </span><span class="kw">sqrt</span>(gf<span class="op">$</span>map)</a>
<a class="sourceLine" id="cb17-12" title="12"><span class="kw">hist</span>(gf<span class="op">$</span>map)</a>
<a class="sourceLine" id="cb17-13" title="13"></a>
<a class="sourceLine" id="cb17-14" title="14"><span class="kw">hist</span>(gf<span class="op">$</span>pme)</a>
<a class="sourceLine" id="cb17-15" title="15">gf<span class="op">$</span>pme &lt;-<span class="st"> </span><span class="kw">sqrt</span>(gf<span class="op">$</span>pme <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(gf<span class="op">$</span>pme))</a>
<a class="sourceLine" id="cb17-16" title="16"><span class="kw">hist</span>(gf<span class="op">$</span>pme)</a></code></pre></div>
<p>Check the distributions again:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="co"># check distributions</span></a>
<a class="sourceLine" id="cb18-2" title="2"><span class="kw">ggplot</span>(<span class="kw">gather</span>(gf[<span class="dv">3</span><span class="op">:</span><span class="dv">15</span>]), <span class="kw">aes</span>(value)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-3" title="3"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">20</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb18-4" title="4"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>key, <span class="dt">scales =</span> <span class="st">&#39;free_x&#39;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb18-5" title="5"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="vis_ggplot01_files/figure-html/unnamed-chunk-12-1.png" width="75%" height="75%" /></p>
</div>
<div id="censor-observations-with-unusual-megabiome-values" class="section level2">
<h2><span class="header-section-number">4.2</span> Censor observations with unusual megabiome values</h2>
<p>In the following analyses, the <code>megabiome</code> variable will be used to label points and to construct faceted plots. There are a few observations with <code>megabiome</code> values of “None” or “Ice”:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="co"># check levels for megabiomes</span></a>
<a class="sourceLine" id="cb19-2" title="2"><span class="kw">levels</span>(gf<span class="op">$</span>megabiome)</a></code></pre></div>
<pre><code>##  [1] &quot;TropF&quot;   &quot;WarmF&quot;   &quot;SavDWd&quot;  &quot;GrsShrb&quot; &quot;Dsrt&quot;    &quot;TempF&quot;   &quot;BorF&quot;    &quot;Tund&quot;    &quot;None&quot;    &quot;Ice&quot;</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="kw">table</span>(gf<span class="op">$</span>megabiome)</a></code></pre></div>
<pre><code>## 
##   TropF   WarmF  SavDWd GrsShrb    Dsrt   TempF    BorF    Tund    None     Ice 
##    6678    2331    4719    9372    6728    7874   11356    4896     638      50</code></pre>
<p>These can be removed by creating a list of the megabiomes we want to include, and dropping the “None” and “Ice” observations. (The same could be done for the <code>vegtype</code> variable.)</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="co"># drop last two categories</span></a>
<a class="sourceLine" id="cb23-2" title="2">mb2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;TropF&quot;</span>, <span class="st">&quot;WarmF&quot;</span>, <span class="st">&quot;SavDWd&quot;</span>, <span class="st">&quot;GrsShrb&quot;</span>, <span class="st">&quot;Dsrt&quot;</span>, <span class="st">&quot;TempF&quot;</span>, <span class="st">&quot;BorF&quot;</span>, <span class="st">&quot;Tund&quot;</span>)</a>
<a class="sourceLine" id="cb23-3" title="3">gf &lt;-<span class="st"> </span>gf[gf<span class="op">$</span>megabiome <span class="op">%in%</span><span class="st"> </span>mb2, ]</a>
<a class="sourceLine" id="cb23-4" title="4"><span class="kw">table</span>(gf<span class="op">$</span>megabiome)</a></code></pre></div>
<pre><code>## 
##   TropF   WarmF  SavDWd GrsShrb    Dsrt   TempF    BorF    Tund    None     Ice 
##    6678    2331    4719    9372    6728    7874   11356    4896       0       0</code></pre>
</div>
</div>
<div id="controls-of-biomass-burning" class="section level1">
<h1><span class="header-section-number">5</span> Controls of biomass burning</h1>
<p>There is a continuum of ideas on what controls biomass burning, which has at one end climate, and the other ignition (lighting and humans). (It’s envogue to always discuss biomass burning from the perspective of controls as a triangle, no matter what the scale of analysis, and so a triangle here would be climate-humans-lightning, but it turns out that humans and lightning aren’t really significant at a global scale–lightning is well correlated with other climate variables, and humans suppress as many fires as they set.)</p>
<p>The goal here is to look at the relationships between burned fraction and the other available predictors. The particular mechanism is a <code>ggplot2</code> plot, with added “smooths” (including both linear and non-linear (i.e. non-parametric) curves). Although the addition of smooth curves to what are ordinary scatter plots could be viewed as simple plot-summary mechanisms, the are actually the first step in coming up with a systematic relationshp between one of the potential predictors and the response (burned fraction). The following plots consist of simple scatter plots, supplemented by one of two smoothed curves: 1) a data-driven flexible curve, as implemented by a generalized additive model (GAM), which makes no assumption about the form of the relationship, other than it’s relatively smooth; and 2) a linear (i.e. OLS) regression line.</p>
<div id="bivariate-relationship-with-burned-fraction" class="section level2">
<h2><span class="header-section-number">5.1</span> Bivariate relationship with burned fraction</h2>
<p>The first set of plots consist of one-predictor-variable-at-a-time plots, staring with the basic moisture and temperature variables as preditors. Here, for example, is a plot of burned fraction vs. P-E, with a GAM curve added. That curve is specified by the argument <code>(method = 'gam', formula = y ~ s(x, bs = "cs", k = 4</code> to the <code>geom_smooth()</code> function. The <code>formula</code> argument specifies a GAM with a cubic spline (with “shrinkage”), and relatively small number of “knots” (<code>k=4</code>), which yields a relative smooth curve, one more appropriate form summarizing as opposed to interpolating).</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="co"># single-variable plots</span></a>
<a class="sourceLine" id="cb25-2" title="2"><span class="co"># burned fraction vs. pme</span></a>
<a class="sourceLine" id="cb25-3" title="3"><span class="kw">ggplot</span>(<span class="dt">data =</span> gf) <span class="op">+</span></a>
<a class="sourceLine" id="cb25-4" title="4"><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> gf<span class="op">$</span>pme, <span class="dt">y=</span>gfed) <span class="op">+</span></a>
<a class="sourceLine" id="cb25-5" title="5"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb25-6" title="6"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&#39;gam&#39;</span>, <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span><span class="kw">s</span>(x, <span class="dt">bs =</span> <span class="st">&quot;cs&quot;</span>, <span class="dt">k =</span> <span class="dv">4</span>), <span class="dt">col=</span><span class="st">&quot;purple&quot;</span>)  <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-7" title="7"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="vis_ggplot01_files/figure-html/unnamed-chunk-16-1.png" width="75%" height="75%" /></p>
<p>The relationship is evidently nonlinear; burned fraction is highest at intermediate levels of P-E. Here is a similar plot, with the Priestley-Taylor <code>alpha</code> (the ratio AE/PE) as a predictor:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="co"># vs. alpha</span></a>
<a class="sourceLine" id="cb26-2" title="2"><span class="kw">ggplot</span>(<span class="dt">data =</span> gf) <span class="op">+</span></a>
<a class="sourceLine" id="cb26-3" title="3"><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> alpha, <span class="dt">y=</span>gfed) <span class="op">+</span></a>
<a class="sourceLine" id="cb26-4" title="4"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb26-5" title="5"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&#39;gam&#39;</span>, <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span><span class="kw">s</span>(x, <span class="dt">bs =</span> <span class="st">&quot;cs&quot;</span>, <span class="dt">k =</span> <span class="dv">4</span>), <span class="dt">col=</span><span class="st">&quot;purple&quot;</span>)  <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb26-6" title="6"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="vis_ggplot01_files/figure-html/unnamed-chunk-17-1.png" width="75%" height="75%" /></p>
<p>The relationship is similar to that for P-E: burned fraction is low in the driest <em>and</em> the wettest environments, and highest at intermediate levels of moisure.</p>
<p>The other likely important predictor of biomass burning is mean annual temperature <code>mat</code>, which on a global scale controls biomass productivity, and hence fuel avaiabiliy.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="co"># vs. mat</span></a>
<a class="sourceLine" id="cb27-2" title="2"><span class="kw">ggplot</span>(<span class="dt">data =</span> gf) <span class="op">+</span></a>
<a class="sourceLine" id="cb27-3" title="3"><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> mat, <span class="dt">y=</span>gfed) <span class="op">+</span></a>
<a class="sourceLine" id="cb27-4" title="4"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb27-5" title="5"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&#39;gam&#39;</span>, <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span><span class="kw">s</span>(x, <span class="dt">bs =</span> <span class="st">&quot;cs&quot;</span>, <span class="dt">k =</span> <span class="dv">3</span>), <span class="dt">col=</span><span class="st">&quot;purple&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-6" title="6"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="vis_ggplot01_files/figure-html/unnamed-chunk-18-1.png" width="75%" height="75%" /></p>
<p>The “curve” fit by the GAM model is not too curvy at all, and so it seems reasonable to summarize the relationship by a straight line model:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="co"># vs. mat, linear smaoth</span></a>
<a class="sourceLine" id="cb28-2" title="2"><span class="kw">ggplot</span>(<span class="dt">data =</span> gf) <span class="op">+</span></a>
<a class="sourceLine" id="cb28-3" title="3"><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> mat, <span class="dt">y=</span>gfed) <span class="op">+</span></a>
<a class="sourceLine" id="cb28-4" title="4"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb28-5" title="5"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)<span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-6" title="6"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="vis_ggplot01_files/figure-html/unnamed-chunk-19-1.png" width="75%" height="75%" /></p>
<p>Other potential relationship can be explored as follows:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="co"># vs. gdd5</span></a>
<a class="sourceLine" id="cb29-2" title="2"><span class="kw">ggplot</span>(<span class="dt">data =</span> gf) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-3" title="3"><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> gdd5, <span class="dt">y=</span>gfed) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-4" title="4"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-5" title="5"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&#39;gam&#39;</span>, <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span><span class="kw">s</span>(x, <span class="dt">bs =</span> <span class="st">&quot;cs&quot;</span>, <span class="dt">k =</span> <span class="dv">3</span>), <span class="dt">col=</span><span class="st">&quot;purple&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb29-6" title="6"><span class="st">  </span><span class="kw">theme_bw</span>()</a>
<a class="sourceLine" id="cb29-7" title="7"></a>
<a class="sourceLine" id="cb29-8" title="8"><span class="co"># vs. treecov</span></a>
<a class="sourceLine" id="cb29-9" title="9"><span class="kw">ggplot</span>(<span class="dt">data =</span> gf) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-10" title="10"><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> treecov, <span class="dt">y=</span>gfed) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-11" title="11"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-12" title="12"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&#39;gam&#39;</span>, <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span><span class="kw">s</span>(x, <span class="dt">bs =</span> <span class="st">&quot;cs&quot;</span>, <span class="dt">k =</span> <span class="dv">3</span>), <span class="dt">col=</span><span class="st">&quot;purple&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb29-13" title="13"><span class="st">  </span><span class="kw">theme_bw</span>()</a>
<a class="sourceLine" id="cb29-14" title="14"></a>
<a class="sourceLine" id="cb29-15" title="15"><span class="co"># vs. gpw</span></a>
<a class="sourceLine" id="cb29-16" title="16"><span class="kw">ggplot</span>(<span class="dt">data =</span> gf) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-17" title="17"><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> gpw, <span class="dt">y=</span>gfed) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-18" title="18"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-19" title="19"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&#39;gam&#39;</span>, <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span><span class="kw">s</span>(x, <span class="dt">bs =</span> <span class="st">&quot;cs&quot;</span>, <span class="dt">k =</span> <span class="dv">3</span>), <span class="dt">col=</span><span class="st">&quot;purple&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb29-20" title="20"><span class="st">  </span><span class="kw">theme_bw</span>()</a>
<a class="sourceLine" id="cb29-21" title="21"></a>
<a class="sourceLine" id="cb29-22" title="22"><span class="co"># vs. hrmc</span></a>
<a class="sourceLine" id="cb29-23" title="23"><span class="kw">ggplot</span>(<span class="dt">data =</span> gf) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-24" title="24"><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> hrmc, <span class="dt">y=</span>gfed) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-25" title="25"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-26" title="26"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&#39;gam&#39;</span>, <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span><span class="kw">s</span>(x, <span class="dt">bs =</span> <span class="st">&quot;cs&quot;</span>, <span class="dt">k =</span> <span class="dv">3</span>), <span class="dt">col=</span><span class="st">&quot;purple&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb29-27" title="27"><span class="st">  </span><span class="kw">theme_bw</span>()</a>
<a class="sourceLine" id="cb29-28" title="28"></a>
<a class="sourceLine" id="cb29-29" title="29"><span class="co"># vs. npp</span></a>
<a class="sourceLine" id="cb29-30" title="30"><span class="kw">ggplot</span>(<span class="dt">data =</span> gf) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-31" title="31"><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> npp, <span class="dt">y=</span>gfed) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-32" title="32"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-33" title="33"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&#39;gam&#39;</span>, <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span><span class="kw">s</span>(x, <span class="dt">bs =</span> <span class="st">&quot;cs&quot;</span>, <span class="dt">k =</span> <span class="dv">4</span>), <span class="dt">col=</span><span class="st">&quot;purple&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb29-34" title="34"><span class="st">  </span><span class="kw">theme_bw</span>() </a></code></pre></div>
</div>
<div id="influence-of-vegetation-type-on-biomass-burning" class="section level2">
<h2><span class="header-section-number">5.2</span> Influence of vegetation type on biomass burning</h2>
<p>Vegetation obviously has an impact on biomass burning, with low values in regions of sparse vegetation, like deserts and tundra, and potentially higher values in regions of dense vegetation. The impact on the relationship between one of the potential predictors and burned fraction of vegetation type can be explored by point-labled plots or multi-panel plots.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"><span class="co"># points by vegtype</span></a>
<a class="sourceLine" id="cb30-2" title="2"><span class="co"># burned fraction vs. alpha</span></a>
<a class="sourceLine" id="cb30-3" title="3"><span class="kw">ggplot</span>(<span class="dt">data =</span> gf) <span class="op">+</span></a>
<a class="sourceLine" id="cb30-4" title="4"><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> alpha, <span class="dt">y=</span>gfed) <span class="op">+</span></a>
<a class="sourceLine" id="cb30-5" title="5"><span class="st">  </span><span class="kw">scale_color_brewer</span>(<span class="dt">palette=</span><span class="st">&quot;Accent&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb30-6" title="6"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color=</span>gf<span class="op">$</span>megabiome)) <span class="op">+</span></a>
<a class="sourceLine" id="cb30-7" title="7"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&#39;gam&#39;</span>, <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span><span class="kw">s</span>(x, <span class="dt">bs =</span> <span class="st">&quot;cs&quot;</span>, <span class="dt">k =</span> <span class="dv">4</span>), <span class="dt">col=</span><span class="st">&quot;purple&quot;</span>)  <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb30-8" title="8"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="vis_ggplot01_files/figure-html/unnamed-chunk-21-1.png" width="75%" height="75%" /></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="co"># multiplanel plots by vegtype</span></a>
<a class="sourceLine" id="cb31-2" title="2"><span class="co"># vs. alpha</span></a>
<a class="sourceLine" id="cb31-3" title="3"><span class="kw">ggplot</span>(<span class="dt">data =</span> gf) <span class="op">+</span></a>
<a class="sourceLine" id="cb31-4" title="4"><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> alpha, <span class="dt">y=</span>gfed) <span class="op">+</span></a>
<a class="sourceLine" id="cb31-5" title="5"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb31-6" title="6"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&#39;gam&#39;</span>, <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span><span class="kw">s</span>(x, <span class="dt">bs =</span> <span class="st">&quot;cs&quot;</span>, <span class="dt">k =</span> <span class="dv">3</span>), <span class="dt">col=</span><span class="st">&quot;purple&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb31-7" title="7"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>gf<span class="op">$</span>megabiome, <span class="dt">nrow=</span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb31-8" title="8"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="vis_ggplot01_files/figure-html/unnamed-chunk-22-1.png" width="75%" height="75%" /> (Note that in the above plot <code>alpha</code> is used ambiguously, both as a variable name and as a property of the plotted points (i.e. their tranparency).)</p>
<p>Other plots can be constructed:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"><span class="co"># vs. mat</span></a>
<a class="sourceLine" id="cb32-2" title="2"><span class="kw">ggplot</span>(<span class="dt">data =</span> gf) <span class="op">+</span></a>
<a class="sourceLine" id="cb32-3" title="3"><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> mat, <span class="dt">y=</span>gfed) <span class="op">+</span></a>
<a class="sourceLine" id="cb32-4" title="4"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb32-5" title="5"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&#39;gam&#39;</span>, <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span><span class="kw">s</span>(x, <span class="dt">bs =</span> <span class="st">&quot;cs&quot;</span>, <span class="dt">k =</span> <span class="dv">3</span>), <span class="dt">col=</span><span class="st">&quot;purple&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb32-6" title="6"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>gf<span class="op">$</span>megabiome, <span class="dt">nrow=</span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb32-7" title="7"><span class="st">  </span><span class="kw">theme_bw</span>()</a>
<a class="sourceLine" id="cb32-8" title="8"></a>
<a class="sourceLine" id="cb32-9" title="9"><span class="co"># vs. mat, linear smooth</span></a>
<a class="sourceLine" id="cb32-10" title="10"><span class="kw">ggplot</span>(<span class="dt">data =</span> gf) <span class="op">+</span></a>
<a class="sourceLine" id="cb32-11" title="11"><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> mat, <span class="dt">y=</span>gfed) <span class="op">+</span></a>
<a class="sourceLine" id="cb32-12" title="12"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb32-13" title="13"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>x, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb32-14" title="14"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>gf<span class="op">$</span>megabiome, <span class="dt">nrow=</span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb32-15" title="15"><span class="st">  </span><span class="kw">theme_bw</span>()</a>
<a class="sourceLine" id="cb32-16" title="16"></a>
<a class="sourceLine" id="cb32-17" title="17"><span class="co"># vs. npp</span></a>
<a class="sourceLine" id="cb32-18" title="18"><span class="kw">ggplot</span>(<span class="dt">data =</span> gf) <span class="op">+</span></a>
<a class="sourceLine" id="cb32-19" title="19"><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> npp, <span class="dt">y=</span>gfed) <span class="op">+</span></a>
<a class="sourceLine" id="cb32-20" title="20"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb32-21" title="21"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&#39;gam&#39;</span>, <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span><span class="kw">s</span>(x, <span class="dt">bs =</span> <span class="st">&quot;cs&quot;</span>, <span class="dt">k =</span> <span class="dv">3</span>), <span class="dt">col=</span><span class="st">&quot;purple&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb32-22" title="22"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>gf<span class="op">$</span>megabiome, <span class="dt">nrow=</span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb32-23" title="23"><span class="st">  </span><span class="kw">theme_bw</span>()</a>
<a class="sourceLine" id="cb32-24" title="24"></a>
<a class="sourceLine" id="cb32-25" title="25"><span class="co"># vs. npp, linear smooth</span></a>
<a class="sourceLine" id="cb32-26" title="26"><span class="kw">ggplot</span>(<span class="dt">data =</span> gf) <span class="op">+</span></a>
<a class="sourceLine" id="cb32-27" title="27"><span class="st">  </span><span class="kw">aes</span>(<span class="dt">x =</span> npp, <span class="dt">y=</span>gfed) <span class="op">+</span></a>
<a class="sourceLine" id="cb32-28" title="28"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb32-29" title="29"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&#39;lm&#39;</span>, <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>x, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb32-30" title="30"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>gf<span class="op">$</span>megabiome, <span class="dt">nrow=</span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb32-31" title="31"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
</div>
<div id="a-two-predictor-generalized-additive-model-gam" class="section level2">
<h2><span class="header-section-number">5.3</span> A two-predictor Generalized Additive Model (GAM)</h2>
<p>From the above, it seems that mean annual temperature <code>mat</code> and P-E <code>pme</code> (or AE/PE <code>alpha</code>) are the useful predictors of burned fraction (<code>gfed</code>). That raises the possibility of including both in a predictive model, which can be implemented using the <code>mgcv</code> package (which was also implicity used above).</p>
<p>Load the <code>mgcv</code> library, and fit a model with burned fraction as the response, and <code>mat</code> and <code>pme</code> as predictors:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"><span class="co"># load the package</span></a>
<a class="sourceLine" id="cb33-2" title="2"><span class="kw">library</span>(mgcv)</a></code></pre></div>
<pre><code>## Loading required package: nlme</code></pre>
<pre><code>## 
## Attaching package: &#39;nlme&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:raster&#39;:
## 
##     getData</code></pre>
<pre><code>## This is mgcv 1.8-28. For overview type &#39;help(&quot;mgcv-package&quot;)&#39;.</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1"><span class="co"># regressions</span></a>
<a class="sourceLine" id="cb38-2" title="2">gam01 &lt;-<span class="st"> </span><span class="kw">gam</span>(gf<span class="op">$</span>gfed <span class="op">~</span><span class="st"> </span><span class="kw">te</span>(mat, <span class="dt">bs=</span><span class="st">&quot;cs&quot;</span>, <span class="dt">k=</span><span class="dv">4</span>) <span class="op">+</span><span class="st"> </span><span class="kw">te</span>(pme, <span class="dt">bs=</span><span class="st">&quot;cs&quot;</span>, <span class="dt">k=</span><span class="dv">3</span>), <span class="dt">data=</span>gf)</a>
<a class="sourceLine" id="cb38-3" title="3"><span class="kw">summary</span>(gam01)</a></code></pre></div>
<pre><code>## 
## Family: gaussian 
## Link function: identity 
## 
## Formula:
## gf$gfed ~ te(mat, bs = &quot;cs&quot;, k = 4) + te(pme, bs = &quot;cs&quot;, k = 3)
## 
## Parametric coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -3.897832   0.007725  -504.6   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Approximate significance of smooth terms:
##           edf Ref.df    F p-value    
## te(mat) 2.981      3 1412  &lt;2e-16 ***
## te(pme) 2.000      2 1059  &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## R-sq.(adj) =  0.0989   Deviance explained =  9.9%
## GCV = 3.2199  Scale est. = 3.2196    n = 53954</code></pre>
<p>The first-order diagnostic plot for examining the fit of a GAM model can be gotten with the <code>gam.check()</code> function (not shown here)</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1"><span class="co"># diagnostic plots</span></a>
<a class="sourceLine" id="cb40-2" title="2"><span class="kw">par</span>(<span class="dt">mfcol=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb40-3" title="3"><span class="kw">gam.check</span>(gam01)</a>
<a class="sourceLine" id="cb40-4" title="4"><span class="kw">par</span>(<span class="dt">mfcol=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a></code></pre></div>
<p>An informative diagnostic is provided by the partial residual plots for each variable, which summarize the bivariate relationship between the response and the predictors.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1"><span class="kw">par</span>(<span class="dt">mfcol=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb41-2" title="2"><span class="kw">plot.gam</span>(gam01, <span class="dt">residuals=</span>F, <span class="dt">se=</span>T, <span class="dt">shade=</span>T, <span class="dt">pch=</span><span class="dv">16</span>, <span class="dt">cex=</span><span class="fl">0.5</span>)</a></code></pre></div>
<p><img src="vis_ggplot01_files/figure-html/unnamed-chunk-26-1.png" width="75%" height="75%" /></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1"><span class="kw">par</span>(<span class="dt">mfcol=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a></code></pre></div>
<p>Finally, the bivariate relationship can be revealed by a 3-D response surface.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1"><span class="co"># perspective plot</span></a>
<a class="sourceLine" id="cb43-2" title="2">new_mat &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from=</span><span class="op">-</span><span class="dv">20</span>, <span class="dt">to=</span><span class="dv">30</span>, <span class="dt">len=</span><span class="dv">40</span>); new_pme &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">0</span>, <span class="dt">to=</span><span class="dv">80</span>, <span class="dt">len=</span><span class="dv">40</span>)</a>
<a class="sourceLine" id="cb43-3" title="3"><span class="co">#new_mat &lt;- seq(from=min(gf$mat), to=max(gf$mat), len=40); new_pme &lt;- seq(from=min(gf$pme), to=max(gf$pme), len=40)</span></a>
<a class="sourceLine" id="cb43-4" title="4">new_x &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(<span class="dt">mat=</span>new_mat, <span class="dt">pme=</span>new_pme)</a>
<a class="sourceLine" id="cb43-5" title="5">gam01_sfc &lt;-<span class="st"> </span><span class="kw">predict</span>(gam01, new_x)</a>
<a class="sourceLine" id="cb43-6" title="6">gam01_sfc &lt;-<span class="st"> </span><span class="kw">matrix</span>(gam01_sfc, <span class="dv">40</span>, <span class="dv">40</span>)</a>
<a class="sourceLine" id="cb43-7" title="7"><span class="kw">persp</span>(new_mat, new_pme, gam01_sfc, <span class="dt">theta=</span><span class="op">-</span><span class="dv">65</span>, <span class="dt">phi=</span><span class="dv">30</span>, <span class="dt">d=</span><span class="fl">1.5</span>, <span class="dt">col=</span><span class="st">&quot;gray&quot;</span>, <span class="dt">ticktype=</span><span class="st">&quot;detailed&quot;</span>,</a>
<a class="sourceLine" id="cb43-8" title="8">      <span class="dt">zlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>,<span class="dv">0</span>), <span class="dt">xlab=</span><span class="st">&quot;MAT (C)&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;sqrt(Annual P-E (mm))&quot;</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">20</span>,<span class="dv">30</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>,<span class="dv">80</span>),</a>
<a class="sourceLine" id="cb43-9" title="9">      <span class="dt">zlab =</span> <span class="st">&quot;log10 GFED 3.1 Burned Fraction&quot;</span>)</a></code></pre></div>
<pre><code>## Warning in persp.default(new_mat, new_pme, gam01_sfc, theta = -65, phi = 30, : surface extends beyond the
## box</code></pre>
<p><img src="vis_ggplot01_files/figure-html/unnamed-chunk-27-1.png" width="75%" height="75%" /></p>
<p>The take-home message here is that burned fraction responds linearly to mean annual temperature, and cuvilinearly with respect to P-E, with (as we have already seen) highest values at intermediate levels of moisture.</p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
