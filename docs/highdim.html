<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Visualizing high-dimensional data sets</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; } /* Alert */
code span.an { color: #008000; } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { color: #0000ff; } /* ControlFlow */
code span.ch { color: #008080; } /* Char */
code span.cn { } /* Constant */
code span.co { color: #008000; } /* Comment */
code span.cv { color: #008000; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #0000ff; } /* Keyword */
code span.op { } /* Operator */
code span.ot { color: #ff4000; } /* Other */
code span.pp { color: #ff4000; } /* Preprocessor */
code span.sc { color: #008080; } /* SpecialChar */
code span.ss { color: #008080; } /* SpecialString */
code span.st { color: #008080; } /* String */
code span.va { } /* Variable */
code span.vs { color: #008080; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="html-md-01.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">R for Earth-System Science</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="overview.html">Overview</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Topics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Lecture topics</li>
    <li>
      <a href="intro.html">Introduction: R, RStudio, and other infrastructure</a>
    </li>
    <li>
      <a href="usingR.html">Using R</a>
    </li>
    <li>
      <a href="ESSdata.html">Earth-system science data</a>
    </li>
    <li>
      <a href="netCDF.html">netCDF in R</a>
    </li>
    <li>
      <a href="raster_intro.html">raster and netCDF in R</a>
    </li>
    <li>
      <a href="hdf5_intro.html">HDF in R</a>
    </li>
    <li>
      <a href="geospatial.html">Geospatial analyses</a>
    </li>
    <li>
      <a href="RMaps.html">Maps in R</a>
    </li>
    <li>
      <a href="RMaps2.html">Maps in R (2)</a>
    </li>
    <li>
      <a href="rasterVis01.html">Visualization:  raster and rasterVis</a>
    </li>
    <li>
      <a href="vis_ggplot01.html">Visualization for explanation</a>
    </li>
    <li>
      <a href="highdim.html">Visualization of high-dimensional data</a>
    </li>
    <li>
      <a href="multivariate.html">Multivariate analyses</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tasks
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="geog495_ex01.html">Install R and RStudio</a>
    </li>
    <li>
      <a href="packages-and-data.html">Install packages and data</a>
    </li>
    <li>
      <a href="GitHub.html">Git and GitHub</a>
    </li>
    <li>
      <a href="Ex_UsingR.html">Using R exercise</a>
    </li>
    <li>
      <a href="markdown.html">Markdown and RMarkdown</a>
    </li>
    <li>
      <a href="install_netCDF.html">Install netCDF</a>
    </li>
    <li>
      <a href="install_Panoply.html">Install Panoply</a>
    </li>
    <li>
      <a href="transfer.html">File transfer</a>
    </li>
    <li>
      <a href="project.html">GitHub project repository and web page</a>
    </li>
    <li>
      <a href="ltms-and-anomalies.html">Long-term means and anomalies</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Resources
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="readings.html">Readings</a>
    </li>
    <li>
      <a href="websites.html">Old course web pages</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="about.html">About</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Visualizing high-dimensional data sets</h1>

</div>

<div id="TOC">
<ul>
<li><a href="#introduction"><span class="toc-section-number">1</span> Introduction</a></li>
<li><a href="#parallel-coordinate-plots"><span class="toc-section-number">2</span> Parallel coordinate plots</a><ul>
<li><a href="#global-fire-data"><span class="toc-section-number">2.1</span> Global fire data</a></li>
<li><a href="#plots"><span class="toc-section-number">2.2</span> Plots</a></li>
</ul></li>
<li><a href="#high-density-plots-with-the-tabplot-package"><span class="toc-section-number">3</span> High-density plots with the tabplot package</a><ul>
<li><a href="#north-american-modern-pollen-data"><span class="toc-section-number">3.1</span> North American modern pollen data</a></li>
<li><a href="#plots-1"><span class="toc-section-number">3.2</span> Plots</a></li>
<li><a href="#global-fire-data-1"><span class="toc-section-number">3.3</span> Global fire data</a></li>
<li><a href="#plots-2"><span class="toc-section-number">3.4</span> Plots</a></li>
</ul></li>
<li><a href="#plotting-multivariatemultiple-time-series"><span class="toc-section-number">4</span> Plotting multivariate/multiple time series</a><ul>
<li><a href="#carp-l.-pollen-data"><span class="toc-section-number">4.1</span> Carp L. pollen data</a></li>
<li><a href="#plots-3"><span class="toc-section-number">4.2</span> Plots</a></li>
</ul></li>
<li><a href="#interactive-plots"><span class="toc-section-number">5</span> Interactive plots</a></li>
</ul>
</div>

<div id="introduction" class="section level1">
<h1><span class="header-section-number">1</span> Introduction</h1>
<p>One of the hallmarks of Earth-system science data is that it is either high-dimensional (i.e. many variables, as in a “wide” data frame), or high-resolution (i.e. many rows, as in a “tall” data frame). There has been a rapid increase in the availability of such data sets that may contain thousands of observations (high-resolution, i.e. high-density or high-frequency data sets) and tens or hundreds of variables or attributes (high-dimension). Data sets like these arise from:</p>
<ul>
<li>satellite remote sensing and other remote-sensing methods (e.g. hyperspectral methods)</li>
<li>comprehensive censuses and other polling activities</li>
<li>synthesis databases of existing data sets</li>
<li>“reanalysis” sets of climatological variables that may consist of multiple observations per day over spans of multiple decades</li>
<li>climate-model simulations of past, present and future climates</li>
<li>grid-point and other forms of data exported from GIS-managed data sets.</li>
</ul>
<p>Although computing resources now permit the rapid production of such data sets, there is still a need for visualizing and understanding the results, and in many contexts, the analysis of the data sets is lagging the production of the data. Several approaches are evolving::</p>
<ul>
<li>methods for visualizing many hundreds or thousands (or more) data points using “conventional” approaches, with about a million points now (2010’s) considered to represent a “large” data set.</li>
<li>methods for examining “linked” displays (usually interactively) that allow individual observations to be tracked across multiple views of a data</li>
<li>special-purpose analysis methods for dealing with high-resolution (density or frequency) data sets</li>
<li>traditional and novel methods for dealing with high-dimensional data sets (i.e. those with many variables, or more variables than observations)</li>
</ul>
</div>
<div id="parallel-coordinate-plots" class="section level1">
<h1><span class="header-section-number">2</span> Parallel coordinate plots</h1>
<p>Parallel coordiate plots in a sense present an individual axis for each variable in a dataframe along which the individual values of the variable are plotted (usually rescaled to lie between 0 and 1), with the points for a particular observation joined by straight-line segments. Usually the points themselves are <em>not</em> plotted to avoid clutter, but all data values (or “cells” in the dataframe) explictly appear on the plot, nearly a million of them in the example here. Parallel coordinate plots can be generated using the <code>GGally</code> package.</p>
<div id="global-fire-data" class="section level2">
<h2><span class="header-section-number">2.1</span> Global fire data</h2>
<p>The global fire data set provides a good instructional example of the development and use of parallel coordinate plots. The input data consist of the GFEDv3.1 burned fraction (of half-degree grid cells, <code>gfed</code>), several bioclimatic variables (mean annual temperature (<code>mat</code>), mean temperature of the warmest and coldest months (<code>mtwa</code> and <code>mtco</code> respectively), growing degree days (5-deg C base, <code>gdd5</code>), annual precipitation (<code>map</code>), annual equilibrium evapotranspiration (<code>aet</code>), precipitation minus evapotranspiration (<code>pme</code>), <code>alpha</code> (P-E),lightning-strike frequency (<code>hmrc</code>), population density (<code>gpw</code>), net primary productivity (<code>npp</code>), treecover (<code>treecov</code>), and two categorical variables describing “megabiomes” and potential natural vegetation types (<code>megabiome</code> and <code>vegtype</code> respectively).</p>
<p>Load the necessary packages:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># load packages</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(sf)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw">library</span>(tidyr)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="kw">library</span>(GGally)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">#library(gridExtra)</span></a></code></pre></div>
<p>Read the data from an existing <code>.csv</code> file.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># read the data -- output suppressed</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">csvpath &lt;-<span class="st"> &quot;/Users/bartlein/Projects/ESSD/data/csv_files/&quot;</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">csvname &lt;-<span class="st"> &quot;global_fire.csv&quot;</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4">csvfile &lt;-<span class="st"> </span><span class="kw">paste</span>(csvpath, csvname, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">gf &lt;-<span class="st"> </span><span class="kw">read.csv</span>(csvfile)</a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="kw">str</span>(gf)</a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="kw">summary</span>(gf)</a></code></pre></div>
<p>The two categorical (i.e. factor) variables have levels arranged in the default alphabetical order. The following code reorders the levels into something more ecologically and climatically sensible:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># reorder megabiomes -- output suppressed</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">megabiome_name &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;TropF&quot;</span>, <span class="st">&quot;WarmF&quot;</span>, <span class="st">&quot;SavDWd&quot;</span>, <span class="st">&quot;GrsShrb&quot;</span>, <span class="st">&quot;Dsrt&quot;</span>, <span class="st">&quot;TempF&quot;</span>, <span class="st">&quot;BorF&quot;</span>, <span class="st">&quot;Tund&quot;</span>, <span class="st">&quot;None&quot;</span>, <span class="st">&quot;Ice&quot;</span>)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">gf<span class="op">$</span>megabiome &lt;-<span class="st"> </span><span class="kw">factor</span>(gf<span class="op">$</span>megabiome, <span class="dt">levels=</span>megabiome_name)</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co"># reorder vegtypes</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6">vegtype_name &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;TrEFW&quot;</span>,<span class="st">&quot;TrDFW&quot;</span>,<span class="st">&quot;TeBEFW&quot;</span>,<span class="st">&quot;TeNEFW&quot;</span>,<span class="st">&quot;TeDFW&quot;</span>,<span class="st">&quot;BrEFW&quot;</span>,<span class="st">&quot;BrDFW&quot;</span>,<span class="st">&quot;EDMFW&quot;</span>,</a>
<a class="sourceLine" id="cb3-7" data-line-number="7">                  <span class="st">&quot;Savan&quot;</span>,<span class="st">&quot;GrStp&quot;</span>,<span class="st">&quot;ShrbD&quot;</span>,<span class="st">&quot;ShrbO&quot;</span>,<span class="st">&quot;Tund&quot;</span>,<span class="st">&quot;Dsrt&quot;</span>,<span class="st">&quot;PDRI&quot;</span>)</a>
<a class="sourceLine" id="cb3-8" data-line-number="8">gf<span class="op">$</span>vegtype &lt;-<span class="st"> </span><span class="kw">factor</span>(gf<span class="op">$</span>vegtype, <span class="dt">levels=</span>vegtype_name)</a>
<a class="sourceLine" id="cb3-9" data-line-number="9"></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="co"># check the new ordering of factor levels</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="kw">str</span>(gf[<span class="dv">16</span><span class="op">:</span><span class="dv">17</span>])</a></code></pre></div>
<p>Do the usual transformations:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># transformations (output suppressed)</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw">hist</span>(gf<span class="op">$</span>hrmc)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">gf<span class="op">$</span>hrmc &lt;-<span class="st"> </span><span class="kw">sqrt</span>(gf<span class="op">$</span>hrmc)</a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="kw">hist</span>(gf<span class="op">$</span>hrmc)</a>
<a class="sourceLine" id="cb4-5" data-line-number="5"></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="kw">hist</span>(<span class="kw">log10</span>(gf<span class="op">$</span>gpw[gf<span class="op">$</span>gpw <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>]))</a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="kw">min</span>(<span class="kw">log10</span>(gf<span class="op">$</span>gpw[gf<span class="op">$</span>gpw <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>]))</a>
<a class="sourceLine" id="cb4-8" data-line-number="8">gf<span class="op">$</span>gpw &lt;-<span class="st"> </span><span class="kw">log10</span>(gf<span class="op">$</span>gpw <span class="op">+</span><span class="st"> </span><span class="fl">1e-10</span>)</a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="kw">hist</span>(gf<span class="op">$</span>gpw)</a>
<a class="sourceLine" id="cb4-10" data-line-number="10"></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="kw">hist</span>(gf<span class="op">$</span>map)</a>
<a class="sourceLine" id="cb4-12" data-line-number="12">gf<span class="op">$</span>map &lt;-<span class="st"> </span><span class="kw">sqrt</span>(gf<span class="op">$</span>map)</a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="kw">hist</span>(gf<span class="op">$</span>map)</a>
<a class="sourceLine" id="cb4-14" data-line-number="14"></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="kw">hist</span>(gf<span class="op">$</span>pme)</a>
<a class="sourceLine" id="cb4-16" data-line-number="16">gf<span class="op">$</span>pme &lt;-<span class="st"> </span><span class="kw">sqrt</span>(gf<span class="op">$</span>pme <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(gf<span class="op">$</span>pme))</a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="kw">hist</span>(gf<span class="op">$</span>pme)</a></code></pre></div>
<p>Get a shapefile too:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># read a world outlines shape file</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">shp_path &lt;-<span class="st"> &quot;/Users/bartlein/Projects/ESSD/data/shp_files/ne_110m_admin_0_countries/&quot;</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3">shp_name &lt;-<span class="st"> &quot;ne_110m_admin_0_countries.shp&quot;</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4">shp_file &lt;-<span class="st"> </span><span class="kw">paste</span>(shp_path, shp_name, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb5-5" data-line-number="5"></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co"># read the shapefile</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7">world_shp &lt;-<span class="st"> </span><span class="kw">read_sf</span>(shp_file)</a>
<a class="sourceLine" id="cb5-8" data-line-number="8">world_outline &lt;-<span class="st"> </span><span class="kw">as</span>(<span class="kw">st_geometry</span>(world_shp), <span class="dt">Class=</span><span class="st">&quot;Spatial&quot;</span>)</a>
<a class="sourceLine" id="cb5-9" data-line-number="9">world_outline_gg &lt;-<span class="st"> </span><span class="kw">fortify</span>(world_outline)</a>
<a class="sourceLine" id="cb5-10" data-line-number="10"></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co"># ggplot map of world_outline</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="kw">ggplot</span>(world_outline_gg, <span class="kw">aes</span>(long, lat)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_polygon</span>(<span class="kw">aes</span>(<span class="dt">group =</span> group), <span class="dt">color =</span> <span class="st">&quot;gray50&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="st">  </span><span class="kw">coord_quickmap</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="highdim_files/figure-html/unnamed-chunk-6-1.png" width="75%" height="75%" /></p>
</div>
<div id="plots" class="section level2">
<h2><span class="header-section-number">2.2</span> Plots</h2>
<p>Parallel coordinate plots can be made using the <code>ggparcoord()</code> function from the <code>GGally</code> package:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># parallel coordinate plot</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2">pngfile &lt;-<span class="st"> &quot;pcp01.png&quot;</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="kw">png</span>(pngfile, <span class="dt">width=</span><span class="dv">600</span>, <span class="dt">height=</span><span class="dv">600</span>) <span class="co"># open the file</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="kw">ggparcoord</span>(<span class="dt">data =</span> gf[<span class="dv">1</span><span class="op">:</span><span class="dv">16</span>],</a>
<a class="sourceLine" id="cb6-5" data-line-number="5">  <span class="dt">scale =</span> <span class="st">&quot;uniminmax&quot;</span>, <span class="dt">alphaLines =</span> <span class="fl">0.01</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;PCP of Global Fire Data&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">315</span>, <span class="dt">vjust=</span><span class="fl">1.0</span>, <span class="dt">hjust=</span><span class="fl">0.0</span>, <span class="dt">size=</span><span class="dv">14</span>),</a>
<a class="sourceLine" id="cb6-9" data-line-number="9">        <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(), </a>
<a class="sourceLine" id="cb6-10" data-line-number="10">        <span class="dt">axis.text.y =</span> <span class="kw">element_blank</span>(), <span class="dt">axis.ticks.y =</span> <span class="kw">element_blank</span>() )</a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co">#dev.off()</span></a></code></pre></div>
<p><img src="pcp01.png" /></p>
<p>Note the use of transparency, specified by the <code>alphaLines</code> argument. Individual observations (gridpoints) that have similar values for each variable trace out dense bands of lines, and several distinct bands, corresponding to different “pyromes” (like biomes) can be observed.</p>
<p>Parallel coordinate plots are most effective when paired with another display with points highlighted in one display similarly highlighted in the other. In the case of the global fire data set the logical other display is a map. There are (at least) two ways of doing the highlighting. Here, a particular megabiome (“BorF” – Boreal forest/Taiga) is used. First create a new variable that will be set to zero, except where <code>gf$megabiome == &quot;BorF&quot;</code>. Then, the data are sorted so that the non-“BorF” observations get plotted first.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co"># select those points with megabiome = &quot;BorF&quot;</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2">gf<span class="op">$</span>select_points &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, <span class="kw">dim</span>(gf)[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">gf<span class="op">$</span>select_points[gf<span class="op">$</span>megabiome <span class="op">==</span><span class="st"> &quot;BorF&quot;</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4">gf<span class="op">$</span>select_points &lt;-<span class="st"> </span><span class="kw">as.factor</span>(gf<span class="op">$</span>select_points)</a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="kw">table</span>(gf<span class="op">$</span>select_points)</a></code></pre></div>
<pre><code>## 
##     0     1 
## 43286 11356</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co"># pcp</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2">pngfile &lt;-<span class="st"> &quot;pcp02.png&quot;</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="kw">png</span>(pngfile, <span class="dt">width=</span><span class="dv">600</span>, <span class="dt">height=</span><span class="dv">600</span>) <span class="co"># open the file</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="kw">ggparcoord</span>(<span class="dt">data =</span> gf[<span class="kw">order</span>(gf<span class="op">$</span>select_points),],</a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="dt">columns =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">16</span>), <span class="dt">groupColumn =</span> <span class="st">&quot;select_points&quot;</span>,</a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="dt">scale =</span> <span class="st">&quot;uniminmax&quot;</span>, <span class="dt">alphaLines=</span><span class="fl">0.01</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>)  <span class="op">+</span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="kw">theme</span>(<span class="dt">axis.text.x  =</span> <span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">315</span>, <span class="dt">vjust=</span><span class="fl">1.0</span>, <span class="dt">hjust=</span><span class="fl">0.0</span>, <span class="dt">size=</span><span class="dv">14</span>),</a>
<a class="sourceLine" id="cb9-9" data-line-number="9">      <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb9-10" data-line-number="10">      <span class="dt">axis.text.y =</span> <span class="kw">element_blank</span>(), <span class="dt">axis.ticks.y =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb9-11" data-line-number="11">      <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-12" data-line-number="12"><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="kw">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.2</span>), <span class="st">&quot;red&quot;</span>))</a>
<a class="sourceLine" id="cb9-13" data-line-number="13"><span class="co">#dev.off()</span></a></code></pre></div>
<p><img src="pcp02.png" /></p>
<p>Plot the points.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co"># map</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2">pngfile &lt;-<span class="st"> &quot;map02.png&quot;</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="kw">png</span>(pngfile, <span class="dt">width=</span><span class="dv">600</span>, <span class="dt">height=</span><span class="dv">300</span>) <span class="co"># oppen the file</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="kw">ggplot</span>(gf, <span class="kw">aes</span>(lon, lat))  <span class="op">+</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="kw">geom_point</span>(<span class="kw">aes</span>(lon, lat, <span class="dt">color =</span> select_points), <span class="dt">size =</span> <span class="fl">0.8</span> ) <span class="op">+</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="kw">geom_polygon</span>(<span class="kw">aes</span>(long, lat, <span class="dt">group =</span> group), world_outline_gg, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="kw">coord_quickmap</span>() <span class="op">+</span><span class="st"> </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;gray80&quot;</span>, <span class="st">&quot;red&quot;</span>))</a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="co">#dev.off()</span></a></code></pre></div>
<p><img src="map02.png" /></p>
<p>Before moving on, delete the variable <code>select_points</code> from the <code>gf</code> dataframe:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">gf<span class="op">$</span>select_points &lt;-<span class="st"> </span><span class="ot">NULL</span></a></code></pre></div>
<hr>
</div>
</div>
<div id="high-density-plots-with-the-tabplot-package" class="section level1">
<h1><span class="header-section-number">3</span> High-density plots with the tabplot package</h1>
<p>The “tableplot” is an interesting visualization method that can be useful for discovering large-scale patterns in the covariations among a small (&lt; 15) set or subset of variables, which can be either continuous or categorical. The basic idea is to organize the rows of a data set along an axis of increasing or decreasing values of a continuous variable or the different “levels” of a categorical variable. A reduction in the density of the data is achieved by binning multiple rows of the data and plotting bin averages (or frequencies) of the variables. As in all compositing techniques, if there a consistent response in the other variables to the variable selected to organize the rows, then this will emerge, otherwise inconsistent reponses will wash each other out, and no apparent pattern will be evident in the plots of the other variables.</p>
<div id="north-american-modern-pollen-data" class="section level2">
<h2><span class="header-section-number">3.1</span> North American modern pollen data</h2>
<p>This example makes use of a data set of 4360 modern pollen samples for North America, from Whitmore et al. (2005, <em>Quaternary Science Reviews</em> <a href="https://doi.org/10.1016/j.quascirev.2005.03.005">https://doi.org/10.1016/j.quascirev.2005.03.005</a>. The variables include the location and elevation of each sample, the relative abundances of the 12 most-abundant pollen types (transformed by taking square roots), and two categorical variables, Federova et al. (1994) vegetation types and USGS land-cover types from satellite remote-sensing data (see Whitmore et al. 2005 for details). This data set provides an interesting example, inasmuch as the resulting tableplots are reminiscent of “downcore”-plotted pollen diagrams.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co"># read the North American modern pollen data</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2">csv_path &lt;-<span class="st"> &quot;/Users/bartlein/Projects/ESSD/data/csv_files/&quot;</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3">csv_name &lt;-<span class="st"> &quot;NAmodpol.csv&quot;</span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4">csv_file &lt;-<span class="st"> </span><span class="kw">paste</span>(csv_path, csv_name, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb12-5" data-line-number="5">napol &lt;-<span class="st"> </span><span class="kw">read.csv</span>(csv_file) <span class="co"># takes a while</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="kw">str</span>(napol)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    4630 obs. of  17 variables:
##  $ Lon    : num  -70 -79.2 -57 -85.5 -73.3 ...
##  $ Lat    : num  61 46 52.5 36 45.5 ...
##  $ Elev   : int  153 240 200 305 114 648 124 106 497 330 ...
##  $ Alnus  : num  0 0.162 0 0.388 0 0 0.281 0.271 0.061 0 ...
##  $ Artem  : num  0.109 0 0 0 0.051 0.041 0 0 0.061 0.047 ...
##  $ Aster  : num  0.044 0 0 0.097 0 0.041 0 0.059 0.115 0 ...
##  $ Betula : num  0.372 0.695 0.264 0.087 0.563 0.733 0.568 0.594 0.277 0.656 ...
##  $ ChenoAm: num  0 0 0 0.061 0 0 0.057 0 0.061 0.047 ...
##  $ Cupress: num  0 0 0 0.043 0.089 0.082 0.269 0.059 0 0.081 ...
##  $ Cyper  : num  0.377 0 0.105 0.115 0.103 0.041 0 0 0.061 0.066 ...
##  $ Picea  : num  0.118 0 0 0.097 0.051 0.058 0 0.059 0.13 0.047 ...
##  $ Pinus  : num  0.204 0.53 0.075 0.221 0.352 0.158 0.207 0.345 0.233 0.203 ...
##  $ Poaceae: num  0.109 0 0.091 0.184 0.073 0.187 0.275 0.196 0.241 0.197 ...
##  $ Quercus: num  0 0.132 0 0.423 0.192 0.058 0.269 0.177 0.274 0.123 ...
##  $ Salix  : num  0.166 0.094 0.075 0.061 0.051 0.058 0.081 0.084 0.075 0.047 ...
##  $ Fed    : Factor w/ 11 levels &quot;99&quot;,&quot;Arctic&quot;,..: 8 5 3 6 5 5 6 5 6 5 ...
##  $ USGS21 : Factor w/ 17 levels &quot;lc1&quot;,&quot;lc10&quot;,&quot;lc11&quot;,..: 10 5 5 14 13 5 3 4 3 3 ...</code></pre>
<p>Map the pollen site locations:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw">library</span>(maps)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="kw">plot</span>(napol<span class="op">$</span>Lat <span class="op">~</span><span class="st"> </span>napol<span class="op">$</span>Lon, <span class="dt">type=</span><span class="st">&quot;n&quot;</span>)</a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="kw">map</span>(<span class="st">&quot;world&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="st">&quot;gray&quot;</span>)</a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="kw">points</span>(napol<span class="op">$</span>Lat <span class="op">~</span><span class="st"> </span>napol<span class="op">$</span>Lon, <span class="dt">pch=</span><span class="dv">16</span>)</a></code></pre></div>
<p><img src="highdim_files/figure-html/hd31-1.png" width="75%" height="75%" /></p>
</div>
<div id="plots-1" class="section level2">
<h2><span class="header-section-number">3.2</span> Plots</h2>
<p>Load the <code>tabplot</code> package. Note that <code>tabplot</code> loads some other packages (<code>ffbase</code>, <code>ff</code>, <code>bit</code>, etc.) that allow for efficient processing of large data sets and replace some of the functions in the <code>base</code> package. It might be good to restart R after using the <code>tabplot</code> package.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw">library</span>(tabplot)</a></code></pre></div>
<p>Here’s a simple tableplot, with the observations arranged by latitude (<code>sortCol=&quot;Lat&quot;</code>) and linear scales specified for all continuous variables (<code>scales=&quot;lin&quot;</code>, the <code>tabplot()</code> function attempts to find a suitable scale for each variable, but here the pollen variables were all transformed prior to the analysis, and so we want to suppress further transformation here).</p>
<p>(Note that it just happens that the resulting plot looks like a standard pollen diagram–this isn’t designed in any way.)</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw">tableplot</span>(napol, <span class="dt">sortCol=</span><span class="st">&quot;Lat&quot;</span>, <span class="dt">scales=</span><span class="st">&quot;lin&quot;</span>, <span class="dt">fontsize =</span> <span class="dv">8</span>)</a></code></pre></div>
<p><img src="highdim_files/figure-html/hd34-1.png" width="90%" height="90%" /></p>
<p>It’s possible to see broad trends in all of the pollen types, as well as in the frequency of different vegetationtypes as a function of latitude.</p>
<p>Each bin the above plot represents a bin that, in this case, holds 46 observations, and what is plotted as bars in each column is the bin-average or frequency for those observations. Here’s a second plot like the first, using more bins:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw">tableplot</span>(napol, <span class="dt">sortCol=</span><span class="st">&quot;Lat&quot;</span>, <span class="dt">scales=</span><span class="st">&quot;lin&quot;</span>, <span class="dt">nBins=</span><span class="dv">200</span>, <span class="dt">fontsize =</span> <span class="dv">8</span>)</a></code></pre></div>
<p><img src="highdim_files/figure-html/hd36-1.png" width="90%" height="90%" /></p>
<p>The same broad-scale patterns are evident in this plot, suggesting that the approach is robust with respect to the number of bins. The next plot using the abundance of <em>Picea</em> (spruce to organize the data):</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw">tableplot</span>(napol, <span class="dt">sortCol=</span><span class="st">&quot;Picea&quot;</span>, <span class="dt">scales=</span><span class="st">&quot;lin&quot;</span>, <span class="dt">nBins=</span><span class="dv">100</span>, , <span class="dt">fontsize =</span> <span class="dv">8</span>)</a></code></pre></div>
<p><img src="highdim_files/figure-html/hd38-1.png" width="90%" height="90%" /></p>
<p>The plot shows that <em>Aremisia</em> (sagebrush) pollen has a similar profile to <em>Picea</em> and both tend to be high at high elevation and low (western) longitudes. The next plot using one of the categorical variables to organize the data.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw">tableplot</span>(napol, <span class="dt">sortCol=</span><span class="st">&quot;Fed&quot;</span>, <span class="dt">scales=</span><span class="st">&quot;lin&quot;</span>, <span class="dt">nBins=</span><span class="dv">100</span>, <span class="dt">fontsize =</span> <span class="dv">8</span>)</a></code></pre></div>
<p><img src="highdim_files/figure-html/hd40-1.png" width="90%" height="90%" /></p>
<p>The blockiness of the different profiles shows that the individual vegetation types have distinctive mixtures of the different pollen types.</p>
</div>
<div id="global-fire-data-1" class="section level2">
<h2><span class="header-section-number">3.3</span> Global fire data</h2>
<p>The global fire data set has roughly the same number of variables as the pollen data, but ten times the number of observations. The number of individual observations in each bin is therefore larger, increasing the likelihood that the contents of individual bins will be more heterogeneous, with an consequent loss of overall information.</p>
</div>
<div id="plots-2" class="section level2">
<h2><span class="header-section-number">3.4</span> Plots</h2>
<p>To start, produce a tableplot, arranged by mean-annual temperature (<code>mat</code>), an obvious first-order preditor of biomass burning, as well as overall climate (through the dependence of the water balance on temperature via the Clausius-Clapyron relationship):</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw">tableplot</span>(gf, <span class="dt">sortCol=</span><span class="st">&quot;mat&quot;</span>, <span class="dt">scales=</span><span class="st">&quot;lin&quot;</span>, <span class="dt">fontsize =</span> <span class="dv">8</span>, <span class="dt">pals=</span><span class="kw">list</span>(<span class="dt">megabiome=</span><span class="st">&quot;Set8&quot;</span>, <span class="dt">vegtype=</span><span class="st">&quot;Set8&quot;</span>))</a></code></pre></div>
<p><img src="highdim_files/figure-html/unnamed-chunk-10-1.png" width="90%" height="90%" /></p>
<p>Overall, the trends of individual variables are relatively smooth, and it’s easy to see distiguish the temperature and moisture variables (as well as the population variable <code>gpw</code>). The vegetation-type variables <code>megabiome</code> and <code>vegtype</code> are also well sorted out along a mean annual temperature gradient. Burned fraction (<code>gfed</code>) obviously displays a threshold-type relationshion, where values are small at low temperatures, and higher at high values of <code>mat</code>.</p>
<p>Next, the tableplot is sorted by precipitation minus evapotranspiration (<code>pme</code>, or P-E):</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="kw">tableplot</span>(gf, <span class="dt">sortCol=</span><span class="st">&quot;pme&quot;</span>, <span class="dt">scales=</span><span class="st">&quot;lin&quot;</span>, <span class="dt">fontsize =</span> <span class="dv">8</span>, <span class="dt">pals=</span><span class="kw">list</span>(<span class="dt">megabiome=</span><span class="st">&quot;Set8&quot;</span>, <span class="dt">vegtype=</span><span class="st">&quot;Set8&quot;</span>))</a></code></pre></div>
<p><img src="highdim_files/figure-html/unnamed-chunk-11-1.png" width="90%" height="90%" /></p>
<p>The relationship between burned fraction and P-E evident in univariate plots–the arch-shaped pattern, where burned fraction is highest at intermediate values of effective moisture–is also evident here: as P-E monotonically incrases, burned fraction (<code>gfed</code>) rises, then falls.</p>
<p>Finally, the tableplot can be sorted by burned fraction (<code>gfed</code>):</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="kw">tableplot</span>(gf, <span class="dt">sortCol=</span><span class="st">&quot;gfed&quot;</span>, <span class="dt">scales=</span><span class="st">&quot;lin&quot;</span>, <span class="dt">fontsize =</span> <span class="dv">8</span>, <span class="dt">pals=</span><span class="kw">list</span>(<span class="dt">megabiome=</span><span class="st">&quot;Set8&quot;</span>, <span class="dt">vegtype=</span><span class="st">&quot;Set8&quot;</span>))</a></code></pre></div>
<p><img src="highdim_files/figure-html/unnamed-chunk-12-1.png" width="90%" height="90%" /></p>
<p>This plot confirms the existing relationships, where burned fraction broadly tracks temperature and P-E. However the plots also reveal a distinct threshold that is apparently related to a distinct discontinuity in vegetation: the transition beteen desert and tundra vegetation types, and grassland, shubland and forested ones.</p>
<p><a href="highdim.html">[Back to top]</a></p>
</div>
</div>
<div id="plotting-multivariatemultiple-time-series" class="section level1">
<h1><span class="header-section-number">4</span> Plotting multivariate/multiple time series</h1>
<p>Although the tableplots of the North American pollen data above happened to look like conventional pollen diagrams, which were a comparatively early (over a century ago) attempt to visualize multivariate data, the data displayed by the <code>tableplot()</code> function does not necessarily need to be a series. The next example illustrates a display method in which the data <em>do</em> form a series, in this case pollen data again, only this time for a single site, which form a multivariate time series.</p>
<div id="carp-l.-pollen-data" class="section level2">
<h2><span class="header-section-number">4.1</span> Carp L. pollen data</h2>
<p>The data here come from a long pollen record from Carp L., in Washinton State. (Whitlock, C.L. et al., 2000, <em>Palaeogeography Palaeoclimatology Palaeoecology</em> 155(1-2):7-29 [<a href="https://doi.org/10.1016/S0031-0182(99)00092-9" class="uri">https://doi.org/10.1016/S0031-0182(99)00092-9</a>] (<a href="https://doi.org/10.1016/S0031-0182\(99\)00092-9" class="uri">https://doi.org/10.1016/S0031-0182\(99\)00092-9</a>) and Whitlock, C. and P.J. Bartlein, 1997, <em>Nature</em> 388:57-61 <a href="https://doi.org/10.1038/40380">https://doi.org/10.1038/40380</a>. Pollen data are “long-tailed” and so the data were transformed earlier by taking the square root of the pollen percentages.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="co"># read Carp L. pollen data (transformed to square-roots)</span></a>
<a class="sourceLine" id="cb23-2" data-line-number="2">csvpath &lt;-<span class="st"> &quot;/Users/bartlein/Projects/ESSD/data/csv_files/&quot;</span></a>
<a class="sourceLine" id="cb23-3" data-line-number="3">csvname &lt;-<span class="st"> &quot;carp96t.csv&quot;</span> <span class="co"># square-root transformed data</span></a>
<a class="sourceLine" id="cb23-4" data-line-number="4">carp &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="kw">paste</span>(csvpath, csvname, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</a>
<a class="sourceLine" id="cb23-5" data-line-number="5"><span class="kw">summary</span>(carp)</a></code></pre></div>
<pre><code>##      Depth            Age                 IS        Dippine         Happine          undpine     
##  Min.   : 1.30   Min.   :  0.3983   3      :47   Min.   :0.000   Min.   :0.0000   Min.   :1.629  
##  1st Qu.: 7.15   1st Qu.: 25.1045   1      :31   1st Qu.:1.220   1st Qu.:0.5585   1st Qu.:4.351  
##  Median :12.80   Median : 57.6462   2      :24   Median :2.033   Median :1.1830   Median :5.827  
##  Mean   :12.48   Mean   : 58.5209   4      :23   Mean   :2.048   Mean   :1.1933   Mean   :5.653  
##  3rd Qu.:17.65   3rd Qu.: 89.0536   5a     :18   3rd Qu.:2.813   3rd Qu.:1.7915   3rd Qu.:7.021  
##  Max.   :23.15   Max.   :124.9092   5c     :15   Max.   :5.247   Max.   :3.3850   Max.   :9.145  
##                                     (Other):41                                                   
##      Picea           Abies          Pseudotsug       Juniperus           Thet            Tmert       
##  Min.   :0.000   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  
##  1st Qu.:0.681   1st Qu.:0.5655   1st Qu.:0.0000   1st Qu.:0.2950   1st Qu.:0.0000   1st Qu.:0.0000  
##  Median :1.141   Median :0.8230   Median :0.5010   Median :0.5790   Median :0.4650   Median :0.0000  
##  Mean   :1.252   Mean   :0.8382   Mean   :0.5850   Mean   :0.7792   Mean   :0.5844   Mean   :0.2315  
##  3rd Qu.:1.802   3rd Qu.:1.0780   3rd Qu.:0.8375   3rd Qu.:1.0180   3rd Qu.:0.9345   3rd Qu.:0.4485  
##  Max.   :3.741   Max.   :2.1440   Max.   :2.7850   Max.   :3.7170   Max.   :2.6690   Max.   :1.0670  
##                                                                                                      
##    Taxusbrev           Alnus             Arubra          Corylus           Betula           Salix       
##  Min.   :0.00000   Min.   :0.00000   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  
##  1st Qu.:0.00000   1st Qu.:0.00000   1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:0.0000  
##  Median :0.00000   Median :0.00000   Median :0.4980   Median :0.0000   Median :0.0000   Median :0.3470  
##  Mean   :0.02918   Mean   :0.06538   Mean   :0.5741   Mean   :0.2122   Mean   :0.2167   Mean   :0.2940  
##  3rd Qu.:0.00000   3rd Qu.:0.00000   3rd Qu.:0.8970   3rd Qu.:0.4130   3rd Qu.:0.4745   3rd Qu.:0.5355  
##  Max.   :0.84100   Max.   :1.02100   Max.   :3.1130   Max.   :1.7150   Max.   :1.0210   Max.   :1.1700  
##                                                                                                         
##     Fraxinus         Quercus          Poaceae        Artemisia        Ambrosia         Ivaciliat       
##  Min.   :0.0000   Min.   :0.0000   Min.   :0.553   Min.   :0.000   Min.   :0.00000   Min.   :0.000000  
##  1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:1.862   1st Qu.:3.205   1st Qu.:0.00000   1st Qu.:0.000000  
##  Median :0.0000   Median :0.3550   Median :2.824   Median :4.605   Median :0.00000   Median :0.000000  
##  Mean   :0.0344   Mean   :0.6227   Mean   :2.954   Mean   :4.377   Mean   :0.07275   Mean   :0.002111  
##  3rd Qu.:0.0000   3rd Qu.:0.8030   3rd Qu.:4.071   3rd Qu.:5.891   3rd Qu.:0.00000   3rd Qu.:0.000000  
##  Max.   :0.7670   Max.   :3.5530   Max.   :5.951   Max.   :8.121   Max.   :0.81700   Max.   :0.420000  
##                                                                                                        
##    Chenopodii    
##  Min.   :0.0000  
##  1st Qu.:0.3665  
##  Median :0.5350  
##  Mean   :0.6872  
##  3rd Qu.:0.8965  
##  Max.   :3.9650  
## </code></pre>
<p>Pollen data (expressed as proportions or percentages of individual pollen types) vary over an order of magnitude in value, and also have long-tailed distributions. Consequently they should be tranformed, and a useful transformation is to simply take the square root of the proportions.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="co"># transform </span></a>
<a class="sourceLine" id="cb25-2" data-line-number="2">tcarp &lt;-<span class="st"> </span>carp</a>
<a class="sourceLine" id="cb25-3" data-line-number="3">tcarp[<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>] &lt;-<span class="st"> </span><span class="kw">sqrt</span>(tcarp[<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>])</a>
<a class="sourceLine" id="cb25-4" data-line-number="4"><span class="kw">names</span>(tcarp)</a></code></pre></div>
<pre><code>##  [1] &quot;Depth&quot;      &quot;Age&quot;        &quot;IS&quot;         &quot;Dippine&quot;    &quot;Happine&quot;    &quot;undpine&quot;    &quot;Picea&quot;     
##  [8] &quot;Abies&quot;      &quot;Pseudotsug&quot; &quot;Juniperus&quot;  &quot;Thet&quot;       &quot;Tmert&quot;      &quot;Taxusbrev&quot;  &quot;Alnus&quot;     
## [15] &quot;Arubra&quot;     &quot;Corylus&quot;    &quot;Betula&quot;     &quot;Salix&quot;      &quot;Fraxinus&quot;   &quot;Quercus&quot;    &quot;Poaceae&quot;   
## [22] &quot;Artemisia&quot;  &quot;Ambrosia&quot;   &quot;Ivaciliat&quot;  &quot;Chenopodii&quot;</code></pre>
<p>As it appears in the spreadsheet, the data are not particularly well organized, but instead the columns are arranged according to the traditional style of pollen diagrams. An alternative approach is to arrange the indiviual variables (pollen types) according to their affinities as they vary over the core, which can be accomplished by doing a cluster analysis on a dissimilary matrix among pollen types: taxa that vary in a similar (or inverse) fashion downcore appear adjacent to one another.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1"><span class="co"># cluster rearrangement</span></a>
<a class="sourceLine" id="cb27-2" data-line-number="2">carp_heat &lt;-<span class="st"> </span><span class="kw">heatmap</span>(<span class="kw">as.matrix</span>(tcarp[<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>]), <span class="dt">Rowv =</span> <span class="ot">NA</span>, <span class="dt">scale=</span><span class="st">&quot;none&quot;</span>)</a></code></pre></div>
<p><img src="highdim_files/figure-html/unnamed-chunk-14-1.png" width="75%" height="75%" /></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="kw">attributes</span>(carp_heat)</a></code></pre></div>
<pre><code>## $names
## [1] &quot;rowInd&quot; &quot;colInd&quot; &quot;Rowv&quot;   &quot;Colv&quot;</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1">carp_heat<span class="op">$</span>colInd</a></code></pre></div>
<pre><code>##  [1]  3 18 19  4  2  1 13 20 21 10 16 11 15 14  9  6 12 17  8  5 22  7</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1">sort_cols &lt;-<span class="st"> </span>carp_heat<span class="op">$</span>colInd <span class="op">+</span><span class="st"> </span><span class="dv">3</span></a></code></pre></div>
<p>The “heatmap” (which in itself provides an interesting way to look at the data), can be used to rearrange the columns of the dataframe to put similar (or inversely similar, when one type is high the other is low) next to one another:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1"><span class="co"># rearrange matrix</span></a>
<a class="sourceLine" id="cb33-2" data-line-number="2">stcarp &lt;-<span class="st"> </span>tcarp</a>
<a class="sourceLine" id="cb33-3" data-line-number="3"><span class="kw">names</span>(stcarp)</a></code></pre></div>
<pre><code>##  [1] &quot;Depth&quot;      &quot;Age&quot;        &quot;IS&quot;         &quot;Dippine&quot;    &quot;Happine&quot;    &quot;undpine&quot;    &quot;Picea&quot;     
##  [8] &quot;Abies&quot;      &quot;Pseudotsug&quot; &quot;Juniperus&quot;  &quot;Thet&quot;       &quot;Tmert&quot;      &quot;Taxusbrev&quot;  &quot;Alnus&quot;     
## [15] &quot;Arubra&quot;     &quot;Corylus&quot;    &quot;Betula&quot;     &quot;Salix&quot;      &quot;Fraxinus&quot;   &quot;Quercus&quot;    &quot;Poaceae&quot;   
## [22] &quot;Artemisia&quot;  &quot;Ambrosia&quot;   &quot;Ivaciliat&quot;  &quot;Chenopodii&quot;</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1">stcarp[<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>] &lt;-<span class="st"> </span>tcarp[sort_cols]</a>
<a class="sourceLine" id="cb35-2" data-line-number="2"><span class="kw">names</span>(stcarp) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Depth&quot;</span>, <span class="st">&quot;Age&quot;</span>, <span class="st">&quot;IS&quot;</span>, <span class="kw">names</span>(tcarp)[sort_cols])</a>
<a class="sourceLine" id="cb35-3" data-line-number="3"><span class="kw">names</span>(stcarp)</a></code></pre></div>
<pre><code>##  [1] &quot;Depth&quot;      &quot;Age&quot;        &quot;IS&quot;         &quot;undpine&quot;    &quot;Poaceae&quot;    &quot;Artemisia&quot;  &quot;Picea&quot;     
##  [8] &quot;Happine&quot;    &quot;Dippine&quot;    &quot;Corylus&quot;    &quot;Ambrosia&quot;   &quot;Ivaciliat&quot;  &quot;Taxusbrev&quot;  &quot;Fraxinus&quot;  
## [15] &quot;Alnus&quot;      &quot;Salix&quot;      &quot;Betula&quot;     &quot;Tmert&quot;      &quot;Pseudotsug&quot; &quot;Arubra&quot;     &quot;Quercus&quot;   
## [22] &quot;Thet&quot;       &quot;Abies&quot;      &quot;Chenopodii&quot; &quot;Juniperus&quot;</code></pre>
</div>
<div id="plots-3" class="section level2">
<h2><span class="header-section-number">4.2</span> Plots</h2>
<p>The idea behind the <code>mvtsplots()</code> package (and function) is to use color to reveal underlying patterns in the data. The first plot shows the “raw” data, simply coded for each pollen taxon independently from low (magenta) to high (green). The plots on the margins are of boxplots for the individual series (right), and a time series of the median values across all series (bottom), which attempt to summarize the overall level of the series.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1"><span class="kw">library</span>(mvtsplot)</a>
<a class="sourceLine" id="cb37-2" data-line-number="2"><span class="kw">mvtsplot</span>(stcarp[, <span class="dv">4</span><span class="op">:</span><span class="dv">25</span>], <span class="dt">xtime=</span>carp<span class="op">$</span>Age, <span class="dt">levels=</span><span class="dv">9</span>, <span class="dt">margin=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="highdim_files/figure-html/mvtsplots01-1.png" width="75%" height="75%" /></p>
<p>PLotted this way, one begins to get an idea of some organization to the data along the time axis. The plot is a little noisy, and can be simplified by smoothing the individual series.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="kw">mvtsplot</span>(stcarp[, <span class="dv">4</span><span class="op">:</span><span class="dv">25</span>], <span class="dt">xtime=</span>carp<span class="op">$</span>Age, <span class="dt">smooth.df=</span><span class="dv">25</span>, <span class="dt">levels=</span><span class="dv">9</span>, <span class="dt">margin=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="highdim_files/figure-html/mtvsplot02-1.png" width="75%" height="75%" /></p>
<p>Further simplification can be gotten by “normalizing” the data, transforming and assigning colors based on the range of values in each series individually.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1"><span class="kw">mvtsplot</span>(stcarp[, <span class="dv">4</span><span class="op">:</span><span class="dv">25</span>], <span class="dt">xtime=</span>carp<span class="op">$</span>Age, <span class="dt">smooth.df=</span><span class="dv">2</span>, <span class="dt">norm=</span><span class="st">&quot;internal&quot;</span>, <span class="dt">levels=</span><span class="dv">9</span>, <span class="dt">margin=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="highdim_files/figure-html/mtvsplot03-1.png" width="75%" height="75%" /></p>
<p>The color field now shows that the data are well organized in time, which can be verified by adding a plot of the variable <code>IS</code> i.e. the MIS (Marine Isotopic Stage) to the plot (on the last row). The progression of plots can also be seen to have proceeded from a fairly chaotic pattern to one with coherent patches:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="kw">mvtsplot</span>(stcarp[, <span class="dv">3</span><span class="op">:</span><span class="dv">25</span>], <span class="dt">xtime=</span>carp<span class="op">$</span>Age, <span class="dt">smooth.df=</span><span class="dv">2</span>, <span class="dt">norm=</span><span class="st">&quot;internal&quot;</span>, <span class="dt">levels=</span><span class="dv">9</span>, <span class="dt">margin=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="highdim_files/figure-html/mvtsplot04-1.png" width="75%" height="75%" /></p>
<p><a href="highdim.html">[Back to top]</a></p>
</div>
</div>
<div id="interactive-plots" class="section level1">
<h1><span class="header-section-number">5</span> Interactive plots</h1>
<p>R has a long history of attempts to develop interactive plots, usually consisting of the basic plots developed from low-dimensional data. RStudio’s <em>Shiny</em> package <a href="https://shiny.rstudio.com">https://shiny.rstudio.com</a> and the <em>Plotly R Open Source Graphics Library</em> <a href="https://plot.ly/r/">https://plot.ly/r/</a> are examples that are rapidly developing. An interesting plot for displaying high-dimensional data is the <em>cubeplot</em>, which is easiest to explain by looking at one. The data here come from the <em>TraCE-21k</em> transient climate simulation from 21,000 years ago to present (at monthly resolution) (Liu, Z., et al. 2009, Science 325(5938): 310-314). A data set of of decadal-average “anomaly” values (the difference between past and present) is examined here.</p>
<p>The data are read and plotted using the <code>raster</code> and <code>rasterVis</code> framework. First, load the packages:</p>
<p>Read the data:</p>
<p>Even though the data is decadal resolution, it’s still a lot of data, and so for this example, the data are (actually) decimated to produce century time-step decadal average values.</p>
<p>A levelplot of one slice of the the data can be used to become oriented to the geographic layout of the data:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1">mapTheme &lt;-<span class="st"> </span><span class="kw">rasterTheme</span>(<span class="dt">region=</span>(<span class="kw">rev</span>(<span class="kw">brewer.pal</span>(<span class="dv">10</span>,<span class="st">&quot;RdBu&quot;</span>))))</a>
<a class="sourceLine" id="cb41-2" data-line-number="2">cutpts &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">40</span>,<span class="op">-</span><span class="dv">10</span>,<span class="op">-</span><span class="dv">5</span>,<span class="op">-</span><span class="dv">2</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">20</span>)</a>
<a class="sourceLine" id="cb41-3" data-line-number="3">col &lt;-<span class="st"> </span><span class="kw">rev</span>(<span class="kw">brewer.pal</span>(<span class="dv">10</span>,<span class="st">&quot;RdBu&quot;</span>))</a>
<a class="sourceLine" id="cb41-4" data-line-number="4">plt &lt;-<span class="st"> </span><span class="kw">levelplot</span>(<span class="kw">subset</span>(tas2,<span class="dv">1</span>), <span class="dt">at=</span>cutpts, <span class="dt">margin=</span><span class="ot">FALSE</span>, <span class="dt">par.settings=</span>mapTheme)</a>
<a class="sourceLine" id="cb41-5" data-line-number="5">plt <span class="op">+</span><span class="st"> </span>latticeExtra<span class="op">::</span><span class="kw">layer</span>(<span class="kw">sp.lines</span>(world_outline, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">lwd=</span><span class="dv">1</span>))</a></code></pre></div>
<p><img src="highdim_files/figure-html/plot%20setup-1.png" width="75%" height="75%" /></p>
<p>Then, the cubeplot can be produced using the <code>cubeview()</code> function from the <code>cubeview</code> package. The plot is interactively controlled as follows (from the <code>cubeview()</code> help file:</p>
<p>The location of the slices can be controlled by keys:</p>
<ul>
<li>x-axis: LEFT / RIGHT arrow key</li>
<li>y-axis: DOWN / UP arrow key</li>
<li>z-axis: PAGE_DOWN / PAGE_UP key</li>
</ul>
<p>Other controls:</p>
<ul>
<li>Press and hold left mouse-button to rotate the cube</li>
<li>Press and hold right mouse-button to move the cube</li>
<li>Spin mouse-wheel or press and hold middle mouse-button and move mouse down/up to zoom the cube</li>
<li>Press space bar to show/hide slice position guides</li>
</ul>
<p>The cubeplot, as rendered here, displays a map on the “front (or rear) face” of the brick, and Hovmöller plots on the top (or bottom) and sides.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1"><span class="kw">cubeView</span>(tas2, <span class="dt">at=</span>cutpts, <span class="dt">col.regions=</span>col)</a></code></pre></div>
<p><img src="tr21cube.png" /></p>
<p>Here is a link to the plot on the server: <a href="https://pjbartlein.github.io/REarthSysSci/tr21cube.html">https://pjbartlein.github.io/REarthSysSci/tr21cube.html</a></p>
<p><a href="highdim.html">[Back to top]</a></p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
